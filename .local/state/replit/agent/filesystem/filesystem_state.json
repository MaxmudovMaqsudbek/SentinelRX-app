{"file_contents":{"components/ErrorFallback.tsx":{"content":"import React, { useState } from \"react\";\nimport { reloadAppAsync } from \"expo\";\nimport {\n  StyleSheet,\n  View,\n  Pressable,\n  ScrollView,\n  Text,\n  Modal,\n} from \"react-native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Fonts } from \"@/constants/theme\";\n\nexport type ErrorFallbackProps = {\n  error: Error;\n  resetError: () => void;\n};\n\nexport function ErrorFallback({ error, resetError }: ErrorFallbackProps) {\n  const { theme } = useTheme();\n  const [isModalVisible, setIsModalVisible] = useState(false);\n\n  const handleRestart = async () => {\n    try {\n      await reloadAppAsync();\n    } catch (restartError) {\n      console.error(\"Failed to restart app:\", restartError);\n      resetError();\n    }\n  };\n\n  const formatErrorDetails = (): string => {\n    let details = `Error: ${error.message}\\n\\n`;\n    if (error.stack) {\n      details += `Stack Trace:\\n${error.stack}`;\n    }\n    return details;\n  };\n\n  return (\n    <ThemedView style={styles.container}>\n      {__DEV__ ? (\n        <Pressable\n          onPress={() => setIsModalVisible(true)}\n          style={({ pressed }) => [\n            styles.topButton,\n            {\n              backgroundColor: theme.backgroundDefault,\n              opacity: pressed ? 0.8 : 1,\n            },\n          ]}\n        >\n          <Feather name=\"alert-circle\" size={20} color={theme.text} />\n        </Pressable>\n      ) : null}\n\n      <View style={styles.content}>\n        <View style={[styles.iconContainer, { backgroundColor: theme.error + \"20\" }]}>\n          <Feather name=\"disc\" size={48} color={theme.error} />\n        </View>\n\n        <ThemedText type=\"h1\" style={styles.title}>\n          MediScan AI needs a restart\n        </ThemedText>\n\n        <ThemedText type=\"body\" style={styles.message}>\n          Something unexpected happened. Please restart the app to continue managing your medications safely.\n        </ThemedText>\n\n        <Pressable\n          onPress={handleRestart}\n          style={({ pressed }) => [\n            styles.button,\n            {\n              backgroundColor: theme.primary,\n              opacity: pressed ? 0.9 : 1,\n              transform: [{ scale: pressed ? 0.98 : 1 }],\n            },\n          ]}\n        >\n          <ThemedText\n            type=\"body\"\n            style={[styles.buttonText, { color: theme.buttonText }]}\n          >\n            Restart MediScan AI\n          </ThemedText>\n        </Pressable>\n      </View>\n\n      {__DEV__ ? (\n        <Modal\n          visible={isModalVisible}\n          animationType=\"slide\"\n          transparent={true}\n          onRequestClose={() => setIsModalVisible(false)}\n        >\n          <View style={styles.modalOverlay}>\n            <ThemedView style={styles.modalContainer}>\n              <View style={styles.modalHeader}>\n                <ThemedText type=\"h2\" style={styles.modalTitle}>\n                  Error Details\n                </ThemedText>\n                <Pressable\n                  onPress={() => setIsModalVisible(false)}\n                  style={({ pressed }) => [\n                    styles.closeButton,\n                    { opacity: pressed ? 0.6 : 1 },\n                  ]}\n                >\n                  <Feather name=\"x\" size={24} color={theme.text} />\n                </Pressable>\n              </View>\n\n              <ScrollView\n                style={styles.modalScrollView}\n                contentContainerStyle={styles.modalScrollContent}\n                showsVerticalScrollIndicator\n              >\n                <View\n                  style={[\n                    styles.errorContainer,\n                    { backgroundColor: theme.backgroundDefault },\n                  ]}\n                >\n                  <Text\n                    style={[\n                      styles.errorText,\n                      {\n                        color: theme.text,\n                        fontFamily: Fonts?.mono || \"monospace\",\n                      },\n                    ]}\n                    selectable\n                  >\n                    {formatErrorDetails()}\n                  </Text>\n                </View>\n              </ScrollView>\n            </ThemedView>\n          </View>\n        </Modal>\n      ) : null}\n    </ThemedView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    width: \"100%\",\n    height: \"100%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    padding: Spacing[\"2xl\"],\n  },\n  content: {\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    gap: Spacing.lg,\n    width: \"100%\",\n    maxWidth: 600,\n  },\n  iconContainer: {\n    width: 96,\n    height: 96,\n    borderRadius: 48,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginBottom: Spacing.md,\n  },\n  title: {\n    textAlign: \"center\",\n  },\n  message: {\n    textAlign: \"center\",\n    opacity: 0.7,\n  },\n  topButton: {\n    position: \"absolute\",\n    top: Spacing[\"2xl\"] + Spacing.lg,\n    right: Spacing.lg,\n    width: 44,\n    height: 44,\n    borderRadius: BorderRadius.md,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    zIndex: 10,\n  },\n  button: {\n    paddingVertical: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    paddingHorizontal: Spacing[\"2xl\"],\n    minWidth: 200,\n    shadowColor: \"#000\",\n    shadowOffset: {\n      width: 0,\n      height: 2,\n    },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  buttonText: {\n    fontWeight: \"600\",\n    textAlign: \"center\",\n    fontSize: 16,\n  },\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n    justifyContent: \"flex-end\",\n  },\n  modalContainer: {\n    width: \"100%\",\n    height: \"90%\",\n    borderTopLeftRadius: BorderRadius.lg,\n    borderTopRightRadius: BorderRadius.lg,\n  },\n  modalHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.lg,\n    paddingTop: Spacing.lg,\n    paddingBottom: Spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: \"rgba(128, 128, 128, 0.2)\",\n  },\n  modalTitle: {\n    fontWeight: \"600\",\n  },\n  closeButton: {\n    padding: Spacing.xs,\n  },\n  modalScrollView: {\n    flex: 1,\n  },\n  modalScrollContent: {\n    padding: Spacing.lg,\n  },\n  errorContainer: {\n    width: \"100%\",\n    borderRadius: BorderRadius.md,\n    overflow: \"hidden\",\n    padding: Spacing.lg,\n  },\n  errorText: {\n    fontSize: 12,\n    width: \"100%\",\n  },\n});\n","path":null,"size_bytes":6550,"size_tokens":null},"components/ThemedView.tsx":{"content":"import { View, type ViewProps } from \"react-native\";\n\nimport { useTheme } from \"@/hooks/useTheme\";\n\nexport type ThemedViewProps = ViewProps & {\n  lightColor?: string;\n  darkColor?: string;\n};\n\nexport function ThemedView({\n  style,\n  lightColor,\n  darkColor,\n  ...otherProps\n}: ThemedViewProps) {\n  const { theme, isDark } = useTheme();\n\n  const backgroundColor =\n    isDark && darkColor\n      ? darkColor\n      : !isDark && lightColor\n        ? lightColor\n        : theme.backgroundRoot;\n\n  return <View style={[{ backgroundColor }, style]} {...otherProps} />;\n}\n","path":null,"size_bytes":563,"size_tokens":null},"screens/MedicationDetailScreen.tsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport { View, StyleSheet } from \"react-native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { RouteProp } from \"@react-navigation/native\";\nimport { Feather } from \"@expo/vector-icons\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { Button } from \"@/components/Button\";\nimport Spacer from \"@/components/Spacer\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Shadows, MedicalColors } from \"@/constants/theme\";\nimport { HomeStackParamList } from \"@/navigation/HomeStackNavigator\";\nimport { getMedications, Medication } from \"@/utils/storage\";\nimport { getDrugById, DrugInfo } from \"@/utils/drugDatabase\";\n\ntype MedicationDetailScreenProps = {\n  navigation: NativeStackNavigationProp<HomeStackParamList, \"MedicationDetail\">;\n  route: RouteProp<HomeStackParamList, \"MedicationDetail\">;\n};\n\nexport default function MedicationDetailScreen({ navigation, route }: MedicationDetailScreenProps) {\n  const { theme } = useTheme();\n  const { medicationId } = route.params;\n  const [medication, setMedication] = useState<Medication | null>(null);\n  const [drugInfo, setDrugInfo] = useState<DrugInfo | null>(null);\n\n  useEffect(() => {\n    const loadData = async () => {\n      const medications = await getMedications();\n      const med = medications.find((m) => m.id === medicationId);\n      if (med) {\n        setMedication(med);\n      }\n\n      const drug = getDrugById(medicationId);\n      if (drug) {\n        setDrugInfo(drug);\n      }\n    };\n    loadData();\n  }, [medicationId]);\n\n  if (!medication && !drugInfo) {\n    return (\n      <ScreenScrollView>\n        <View style={styles.loading}>\n          <ThemedText type=\"body\">Loading medication details...</ThemedText>\n        </View>\n      </ScreenScrollView>\n    );\n  }\n\n  const displayData = drugInfo || {\n    name: medication?.name || \"Unknown\",\n    genericName: medication?.genericName || \"\",\n    manufacturer: medication?.manufacturer || \"\",\n    dosage: medication?.dosage || \"\",\n    shape: medication?.shape || \"\",\n    color: medication?.color || \"\",\n    imprint: medication?.imprint,\n    description: \"\",\n    warnings: medication?.warnings || [],\n    sideEffects: medication?.sideEffects || [],\n    interactions: [],\n    pregnancyCategory: \"\",\n    category: \"\",\n  };\n\n  return (\n    <ScreenScrollView>\n      <View style={[styles.headerCard, { backgroundColor: theme.cardBackground }, Shadows.medium]}>\n        <View style={[styles.pillIcon, { backgroundColor: theme.primary + \"20\" }]}>\n          <Feather name=\"disc\" size={40} color={theme.primary} />\n        </View>\n        <ThemedText type=\"h2\" style={styles.medicationName}>\n          {displayData.name}\n        </ThemedText>\n        <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n          {displayData.genericName}\n        </ThemedText>\n      </View>\n\n      <Spacer height={Spacing.xl} />\n\n      <ThemedText type=\"h3\">Details</ThemedText>\n      <Spacer height={Spacing.md} />\n\n      <View style={[styles.detailsCard, { backgroundColor: theme.cardBackground }, Shadows.small]}>\n        <View style={styles.detailRow}>\n          <ThemedText type=\"label\">Dosage</ThemedText>\n          <ThemedText type=\"body\">{displayData.dosage}</ThemedText>\n        </View>\n        <View style={[styles.divider, { backgroundColor: theme.border }]} />\n        <View style={styles.detailRow}>\n          <ThemedText type=\"label\">Manufacturer</ThemedText>\n          <ThemedText type=\"body\">{displayData.manufacturer}</ThemedText>\n        </View>\n        <View style={[styles.divider, { backgroundColor: theme.border }]} />\n        <View style={styles.detailRow}>\n          <ThemedText type=\"label\">Shape</ThemedText>\n          <ThemedText type=\"body\">{displayData.shape}</ThemedText>\n        </View>\n        <View style={[styles.divider, { backgroundColor: theme.border }]} />\n        <View style={styles.detailRow}>\n          <ThemedText type=\"label\">Color</ThemedText>\n          <ThemedText type=\"body\">{displayData.color}</ThemedText>\n        </View>\n        {displayData.imprint ? (\n          <>\n            <View style={[styles.divider, { backgroundColor: theme.border }]} />\n            <View style={styles.detailRow}>\n              <ThemedText type=\"label\">Imprint</ThemedText>\n              <ThemedText type=\"body\">{displayData.imprint}</ThemedText>\n            </View>\n          </>\n        ) : null}\n        {drugInfo?.pregnancyCategory ? (\n          <>\n            <View style={[styles.divider, { backgroundColor: theme.border }]} />\n            <View style={styles.detailRow}>\n              <ThemedText type=\"label\">Pregnancy Category</ThemedText>\n              <ThemedText type=\"body\">Category {drugInfo.pregnancyCategory}</ThemedText>\n            </View>\n          </>\n        ) : null}\n      </View>\n\n      {drugInfo?.description ? (\n        <>\n          <Spacer height={Spacing.xl} />\n          <ThemedText type=\"h3\">Description</ThemedText>\n          <Spacer height={Spacing.md} />\n          <View style={[styles.infoCard, { backgroundColor: theme.cardBackground }]}>\n            <ThemedText type=\"body\">{drugInfo.description}</ThemedText>\n          </View>\n        </>\n      ) : null}\n\n      {displayData.warnings.length > 0 ? (\n        <>\n          <Spacer height={Spacing.xl} />\n          <ThemedText type=\"h3\">Warnings</ThemedText>\n          <Spacer height={Spacing.md} />\n          <View style={[styles.infoCard, { backgroundColor: theme.cardBackground }]}>\n            {displayData.warnings.map((warning, index) => (\n              <View key={index} style={styles.warningItem}>\n                <Feather name=\"alert-circle\" size={16} color={theme.accent} />\n                <ThemedText type=\"body\" style={styles.warningText}>\n                  {warning}\n                </ThemedText>\n              </View>\n            ))}\n          </View>\n        </>\n      ) : null}\n\n      {displayData.sideEffects.length > 0 ? (\n        <>\n          <Spacer height={Spacing.xl} />\n          <ThemedText type=\"h3\">Possible Side Effects</ThemedText>\n          <Spacer height={Spacing.md} />\n          <View style={[styles.infoCard, { backgroundColor: theme.cardBackground }]}>\n            <View style={styles.tagsContainer}>\n              {displayData.sideEffects.map((effect, index) => (\n                <View\n                  key={index}\n                  style={[styles.tag, { backgroundColor: theme.backgroundSecondary }]}\n                >\n                  <ThemedText type=\"small\">{effect}</ThemedText>\n                </View>\n              ))}\n            </View>\n          </View>\n        </>\n      ) : null}\n\n      {drugInfo?.interactions && drugInfo.interactions.length > 0 ? (\n        <>\n          <Spacer height={Spacing.xl} />\n          <ThemedText type=\"h3\">Known Interactions</ThemedText>\n          <Spacer height={Spacing.md} />\n          <View style={[styles.infoCard, { backgroundColor: theme.cardBackground }]}>\n            {drugInfo.interactions.map((interaction, index) => (\n              <View key={index} style={styles.interactionItem}>\n                <Feather name=\"x-circle\" size={16} color={theme.error} />\n                <ThemedText type=\"body\" style={styles.interactionText}>\n                  {interaction}\n                </ThemedText>\n              </View>\n            ))}\n          </View>\n        </>\n      ) : null}\n\n      <Spacer height={Spacing[\"2xl\"]} />\n\n      <Button\n        onPress={() => navigation.getParent()?.getParent()?.navigate(\"InteractionsTab\")}\n        style={{ backgroundColor: theme.secondary }}\n      >\n        Check Interactions\n      </Button>\n\n      <Spacer height={Spacing.lg} />\n\n      <Button onPress={() => navigation.navigate(\"Reminders\")}>Set Reminder</Button>\n\n      <Spacer height={Spacing[\"3xl\"]} />\n    </ScreenScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  loading: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingVertical: Spacing[\"4xl\"],\n  },\n  headerCard: {\n    borderRadius: BorderRadius.xl,\n    padding: Spacing.xl,\n    alignItems: \"center\",\n  },\n  pillIcon: {\n    width: 80,\n    height: 80,\n    borderRadius: 40,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginBottom: Spacing.lg,\n  },\n  medicationName: {\n    textAlign: \"center\",\n    marginBottom: Spacing.xs,\n  },\n  detailsCard: {\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.lg,\n  },\n  detailRow: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    paddingVertical: Spacing.sm,\n  },\n  divider: {\n    height: 1,\n  },\n  infoCard: {\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.lg,\n  },\n  warningItem: {\n    flexDirection: \"row\",\n    alignItems: \"flex-start\",\n    marginBottom: Spacing.sm,\n  },\n  warningText: {\n    flex: 1,\n    marginLeft: Spacing.sm,\n  },\n  tagsContainer: {\n    flexDirection: \"row\",\n    flexWrap: \"wrap\",\n    gap: Spacing.sm,\n  },\n  tag: {\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.sm,\n  },\n  interactionItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginBottom: Spacing.sm,\n  },\n  interactionText: {\n    flex: 1,\n    marginLeft: Spacing.sm,\n  },\n});\n","path":null,"size_bytes":9310,"size_tokens":null},"components/PharmacyCard.tsx":{"content":"import React from \"react\";\nimport { StyleSheet, View, Pressable } from \"react-native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n} from \"react-native-reanimated\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Shadows, MedicalColors } from \"@/constants/theme\";\nimport { PriceInfo } from \"@/utils/aiServices\";\n\ninterface PharmacyCardProps {\n  pharmacy: PriceInfo;\n  onPress?: () => void;\n}\n\nconst AnimatedPressable = Animated.createAnimatedComponent(Pressable);\n\nexport function PharmacyCard({ pharmacy, onPress }: PharmacyCardProps) {\n  const { theme } = useTheme();\n  const scale = useSharedValue(1);\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const handlePressIn = () => {\n    scale.value = withSpring(0.98);\n  };\n\n  const handlePressOut = () => {\n    scale.value = withSpring(1);\n  };\n\n  return (\n    <AnimatedPressable\n      onPress={onPress}\n      onPressIn={handlePressIn}\n      onPressOut={handlePressOut}\n      style={[\n        styles.card,\n        {\n          backgroundColor: theme.cardBackground,\n          borderColor: pharmacy.isSuspicious ? MedicalColors.suspicious : \"transparent\",\n          borderWidth: pharmacy.isSuspicious ? 2 : 0,\n        },\n        Shadows.small,\n        animatedStyle,\n      ]}\n    >\n      <View style={styles.header}>\n        <View style={styles.nameRow}>\n          <ThemedText type=\"h4\" style={styles.name} numberOfLines={1}>\n            {pharmacy.pharmacyName}\n          </ThemedText>\n          {pharmacy.isVerified ? (\n            <View style={[styles.verifiedBadge, { backgroundColor: MedicalColors.verified }]}>\n              <Feather name=\"check\" size={12} color=\"#FFFFFF\" />\n            </View>\n          ) : null}\n        </View>\n        <View style={styles.distanceRow}>\n          <Feather name=\"map-pin\" size={14} color={theme.textSecondary} />\n          <ThemedText type=\"small\" style={[styles.distance, { color: theme.textSecondary }]}>\n            {pharmacy.distance}\n          </ThemedText>\n        </View>\n      </View>\n\n      <View style={styles.priceContainer}>\n        <ThemedText\n          type=\"h3\"\n          style={[\n            styles.price,\n            { color: pharmacy.isSuspicious ? MedicalColors.suspicious : theme.primary },\n          ]}\n        >\n          ${pharmacy.price.toFixed(2)}\n        </ThemedText>\n        {pharmacy.isSuspicious ? (\n          <View style={[styles.warningBadge, { backgroundColor: MedicalColors.severityMajor.background }]}>\n            <Feather name=\"alert-triangle\" size={12} color={MedicalColors.suspicious} />\n            <ThemedText type=\"caption\" style={{ color: MedicalColors.suspicious, marginLeft: 4 }}>\n              Suspicious\n            </ThemedText>\n          </View>\n        ) : null}\n      </View>\n\n      {pharmacy.isSuspicious && pharmacy.suspicionReason ? (\n        <View style={[styles.warningBox, { backgroundColor: MedicalColors.severityMajor.background }]}>\n          <ThemedText type=\"small\" style={{ color: MedicalColors.severityMajor.text }}>\n            {pharmacy.suspicionReason}\n          </ThemedText>\n        </View>\n      ) : null}\n    </AnimatedPressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  card: {\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.lg,\n  },\n  header: {\n    flex: 1,\n  },\n  nameRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  name: {\n    flex: 1,\n  },\n  verifiedBadge: {\n    width: 20,\n    height: 20,\n    borderRadius: 10,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginLeft: Spacing.sm,\n  },\n  distanceRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginTop: Spacing.xs,\n  },\n  distance: {\n    marginLeft: Spacing.xs,\n  },\n  priceContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginTop: Spacing.md,\n  },\n  price: {\n    flex: 1,\n  },\n  warningBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.xs,\n  },\n  warningBox: {\n    marginTop: Spacing.md,\n    padding: Spacing.md,\n    borderRadius: BorderRadius.sm,\n  },\n});\n","path":null,"size_bytes":4280,"size_tokens":null},"navigation/MainTabNavigator26.tsx":{"content":"import React from \"react\";\nimport { createNativeBottomTabNavigator } from \"@react-navigation/bottom-tabs/unstable\";\n\nimport HomeStackNavigator from \"@/navigation/HomeStackNavigator\";\nimport ProfileStackNavigator from \"@/navigation/ProfileStackNavigator\";\n\nexport type MainTabParamList = {\n  HomeTab: undefined;\n  ProfileTab: undefined;\n};\n\nconst Tab = createNativeBottomTabNavigator<MainTabParamList>();\n\nexport default function MainTabNavigator26() {\n  return (\n    <Tab.Navigator\n      initialRouteName=\"HomeTab\"\n      screenOptions={{\n        headerShown: false,\n      }}\n    >\n      <Tab.Screen\n        name=\"HomeTab\"\n        component={HomeStackNavigator}\n        options={{\n          title: \"Home\",\n          icon: {\n            sfSymbolName: \"house\",\n          },\n          selectedIcon: {\n            sfSymbolName: \"house.fill\",\n          },\n        }}\n      />\n      <Tab.Screen\n        name=\"ProfileTab\"\n        component={ProfileStackNavigator}\n        options={{\n          title: \"Profile\",\n          icon: {\n            sfSymbolName: \"person\",\n          },\n          selectedIcon: {\n            sfSymbolName: \"person.fill\",\n          },\n        }}\n      />\n    </Tab.Navigator>\n  );\n}\n","path":null,"size_bytes":1198,"size_tokens":null},"components/ThemedText.tsx":{"content":"import { Text, type TextProps } from \"react-native\";\n\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Typography } from \"@/constants/theme\";\n\nexport type ThemedTextProps = TextProps & {\n  lightColor?: string;\n  darkColor?: string;\n  type?: \"display\" | \"h1\" | \"h2\" | \"h3\" | \"h4\" | \"body\" | \"bodyLarge\" | \"small\" | \"caption\" | \"label\" | \"link\";\n};\n\nexport function ThemedText({\n  style,\n  lightColor,\n  darkColor,\n  type = \"body\",\n  ...rest\n}: ThemedTextProps) {\n  const { theme, isDark } = useTheme();\n\n  const getColor = () => {\n    if (isDark && darkColor) {\n      return darkColor;\n    }\n\n    if (!isDark && lightColor) {\n      return lightColor;\n    }\n\n    if (type === \"link\") {\n      return theme.link;\n    }\n\n    return theme.text;\n  };\n\n  const getTypeStyle = () => {\n    switch (type) {\n      case \"display\":\n        return Typography.display;\n      case \"h1\":\n        return Typography.h1;\n      case \"h2\":\n        return Typography.h2;\n      case \"h3\":\n        return Typography.h3;\n      case \"h4\":\n        return Typography.h4;\n      case \"body\":\n        return Typography.body;\n      case \"bodyLarge\":\n        return Typography.bodyLarge;\n      case \"small\":\n        return Typography.small;\n      case \"caption\":\n        return Typography.caption;\n      case \"label\":\n        return Typography.label;\n      case \"link\":\n        return Typography.link;\n      default:\n        return Typography.body;\n    }\n  };\n\n  return (\n    <Text style={[{ color: getColor() }, getTypeStyle(), style]} {...rest} />\n  );\n}\n","path":null,"size_bytes":1527,"size_tokens":null},"components/SeverityBadge.tsx":{"content":"import React from \"react\";\nimport { StyleSheet, View } from \"react-native\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { MedicalColors, Spacing, BorderRadius } from \"@/constants/theme\";\n\ninterface SeverityBadgeProps {\n  severity: \"minor\" | \"moderate\" | \"major\";\n  size?: \"small\" | \"large\";\n}\n\nexport function SeverityBadge({ severity, size = \"small\" }: SeverityBadgeProps) {\n  const getColors = () => {\n    switch (severity) {\n      case \"minor\":\n        return MedicalColors.severityMinor;\n      case \"moderate\":\n        return MedicalColors.severityModerate;\n      case \"major\":\n        return MedicalColors.severityMajor;\n    }\n  };\n\n  const colors = getColors();\n  const label = severity.charAt(0).toUpperCase() + severity.slice(1);\n\n  return (\n    <View\n      style={[\n        styles.badge,\n        { backgroundColor: colors.background },\n        size === \"large\" && styles.badgeLarge,\n      ]}\n    >\n      <ThemedText\n        type={size === \"large\" ? \"label\" : \"caption\"}\n        style={[styles.text, { color: colors.text }]}\n      >\n        {label}\n      </ThemedText>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  badge: {\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.xs,\n    alignSelf: \"flex-start\",\n  },\n  badgeLarge: {\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n  },\n  text: {\n    fontWeight: \"600\",\n  },\n});\n","path":null,"size_bytes":1428,"size_tokens":null},"App.tsx":{"content":"import React from \"react\";\nimport { StyleSheet } from \"react-native\";\nimport { NavigationContainer } from \"@react-navigation/native\";\nimport { GestureHandlerRootView } from \"react-native-gesture-handler\";\nimport { KeyboardProvider } from \"react-native-keyboard-controller\";\nimport { SafeAreaProvider } from \"react-native-safe-area-context\";\nimport { StatusBar } from \"expo-status-bar\";\n\nimport MainTabNavigator from \"@/navigation/MainTabNavigator\";\nimport { VoiceAssistantButton } from \"@/components/VoiceAssistantButton\";\nimport { ErrorBoundary } from \"@/components/ErrorBoundary\";\n\nexport default function App() {\n  return (\n    <ErrorBoundary>\n      <SafeAreaProvider>\n        <GestureHandlerRootView style={styles.root}>\n          <KeyboardProvider>\n            <NavigationContainer>\n              <MainTabNavigator />\n              <VoiceAssistantButton />\n            </NavigationContainer>\n            <StatusBar style=\"auto\" />\n          </KeyboardProvider>\n        </GestureHandlerRootView>\n      </SafeAreaProvider>\n    </ErrorBoundary>\n  );\n}\n\nconst styles = StyleSheet.create({\n  root: {\n    flex: 1,\n  },\n});\n","path":null,"size_bytes":1122,"size_tokens":null},"components/ScreenScrollView.tsx":{"content":"import { ScrollView, ScrollViewProps, StyleSheet } from \"react-native\";\n\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useScreenInsets } from \"@/hooks/useScreenInsets\";\nimport { Spacing } from \"@/constants/theme\";\n\nexport function ScreenScrollView({\n  children,\n  contentContainerStyle,\n  style,\n  ...scrollViewProps\n}: ScrollViewProps) {\n  const { theme } = useTheme();\n  const { paddingTop, paddingBottom, scrollInsetBottom } = useScreenInsets();\n\n  return (\n    <ScrollView\n      style={[\n        styles.container,\n        { backgroundColor: theme.backgroundRoot },\n        style,\n      ]}\n      contentContainerStyle={[\n        {\n          paddingTop,\n          paddingBottom,\n        },\n        styles.contentContainer,\n        contentContainerStyle,\n      ]}\n      scrollIndicatorInsets={{ bottom: scrollInsetBottom }}\n      {...scrollViewProps}\n    >\n      {children}\n    </ScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  contentContainer: {\n    paddingHorizontal: Spacing.xl,\n  },\n});\n","path":null,"size_bytes":1043,"size_tokens":null},"screens/SettingsScreen.tsx":{"content":"import React, { useState, useEffect, useCallback } from \"react\";\nimport { View, StyleSheet, TextInput, Pressable, Switch, ScrollView } from \"react-native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { useFocusEffect } from \"@react-navigation/native\";\nimport { Feather } from \"@expo/vector-icons\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ScreenKeyboardAwareScrollView } from \"@/components/ScreenKeyboardAwareScrollView\";\nimport { Button } from \"@/components/Button\";\nimport Spacer from \"@/components/Spacer\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Shadows } from \"@/constants/theme\";\nimport { ProfileStackParamList } from \"@/navigation/ProfileStackNavigator\";\nimport {\n  getUserProfile,\n  saveUserProfile,\n  getSettings,\n  saveSettings,\n  UserProfile,\n  Settings,\n} from \"@/utils/storage\";\n\ntype SettingsScreenProps = {\n  navigation: NativeStackNavigationProp<ProfileStackParamList, \"Settings\">;\n};\n\nconst LANGUAGES = [\n  { code: \"en\", label: \"English\" },\n  { code: \"uz\", label: \"O'zbek\" },\n  { code: \"ru\", label: \"Русский\" },\n];\n\nconst CURRENCIES = [\"USD\", \"UZS\", \"EUR\", \"RUB\"];\n\nexport default function SettingsScreen({ navigation }: SettingsScreenProps) {\n  const { theme, isDark } = useTheme();\n  const [profile, setProfile] = useState<UserProfile | null>(null);\n  const [settings, setSettings] = useState<Settings | null>(null);\n  const [hasChanges, setHasChanges] = useState(false);\n\n  useFocusEffect(\n    useCallback(() => {\n      const loadData = async () => {\n        const [profileData, settingsData] = await Promise.all([\n          getUserProfile(),\n          getSettings(),\n        ]);\n        setProfile(profileData);\n        setSettings(settingsData);\n      };\n      loadData();\n    }, [])\n  );\n\n  const updateProfile = (updates: Partial<UserProfile>) => {\n    if (profile) {\n      setProfile({ ...profile, ...updates });\n      setHasChanges(true);\n    }\n  };\n\n  const updateSettings = (updates: Partial<Settings>) => {\n    if (settings) {\n      setSettings({ ...settings, ...updates });\n      setHasChanges(true);\n    }\n  };\n\n  const handleSave = async () => {\n    if (profile && settings) {\n      await saveUserProfile(profile);\n      await saveSettings(settings);\n      setHasChanges(false);\n      navigation.goBack();\n    }\n  };\n\n  const inputStyle = [\n    styles.input,\n    { backgroundColor: theme.backgroundSecondary, color: theme.text },\n  ];\n\n  if (!profile || !settings) {\n    return null;\n  }\n\n  return (\n    <ScreenKeyboardAwareScrollView>\n      <ThemedText type=\"h3\">Personal Information</ThemedText>\n      <Spacer height={Spacing.lg} />\n\n      <View style={[styles.card, { backgroundColor: theme.cardBackground }, Shadows.small]}>\n        <View style={styles.field}>\n          <ThemedText type=\"label\">Display Name</ThemedText>\n          <Spacer height={Spacing.sm} />\n          <TextInput\n            style={inputStyle}\n            value={profile.name}\n            onChangeText={(text) => updateProfile({ name: text })}\n            placeholder=\"Enter your name\"\n            placeholderTextColor={theme.textSecondary}\n          />\n        </View>\n\n        <View style={styles.field}>\n          <ThemedText type=\"label\">Age</ThemedText>\n          <Spacer height={Spacing.sm} />\n          <TextInput\n            style={inputStyle}\n            value={profile.age?.toString() || \"\"}\n            onChangeText={(text) =>\n              updateProfile({ age: text ? parseInt(text, 10) : undefined })\n            }\n            placeholder=\"Enter your age\"\n            placeholderTextColor={theme.textSecondary}\n            keyboardType=\"numeric\"\n          />\n        </View>\n\n        <View style={styles.field}>\n          <View style={styles.switchRow}>\n            <ThemedText type=\"label\">Pregnancy Status</ThemedText>\n            <Switch\n              value={profile.isPregnant || false}\n              onValueChange={(value) => updateProfile({ isPregnant: value })}\n              trackColor={{ false: theme.border, true: theme.primary }}\n              thumbColor=\"#FFFFFF\"\n            />\n          </View>\n          <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n            Enable for pregnancy-safe medication recommendations\n          </ThemedText>\n        </View>\n\n        <View style={styles.field}>\n          <ThemedText type=\"label\">Allergies</ThemedText>\n          <Spacer height={Spacing.sm} />\n          <TextInput\n            style={inputStyle}\n            value={profile.allergies.join(\", \")}\n            onChangeText={(text) =>\n              updateProfile({\n                allergies: text\n                  .split(\",\")\n                  .map((a) => a.trim())\n                  .filter((a) => a),\n              })\n            }\n            placeholder=\"e.g., Penicillin, Aspirin\"\n            placeholderTextColor={theme.textSecondary}\n          />\n          <ThemedText type=\"caption\" style={{ color: theme.textSecondary, marginTop: Spacing.xs }}>\n            Separate multiple allergies with commas\n          </ThemedText>\n        </View>\n\n        <View style={styles.field}>\n          <ThemedText type=\"label\">Chronic Conditions</ThemedText>\n          <Spacer height={Spacing.sm} />\n          <TextInput\n            style={inputStyle}\n            value={profile.chronicConditions.join(\", \")}\n            onChangeText={(text) =>\n              updateProfile({\n                chronicConditions: text\n                  .split(\",\")\n                  .map((c) => c.trim())\n                  .filter((c) => c),\n              })\n            }\n            placeholder=\"e.g., Diabetes, Hypertension\"\n            placeholderTextColor={theme.textSecondary}\n          />\n        </View>\n      </View>\n\n      <Spacer height={Spacing[\"2xl\"]} />\n\n      <ThemedText type=\"h3\">Language & Currency</ThemedText>\n      <Spacer height={Spacing.lg} />\n\n      <View style={[styles.card, { backgroundColor: theme.cardBackground }, Shadows.small]}>\n        <ThemedText type=\"label\">Language</ThemedText>\n        <Spacer height={Spacing.md} />\n        <View style={styles.optionsRow}>\n          {LANGUAGES.map((lang) => (\n            <Pressable\n              key={lang.code}\n              onPress={() => updateProfile({ language: lang.code as \"en\" | \"uz\" | \"ru\" })}\n              style={[\n                styles.optionChip,\n                {\n                  backgroundColor:\n                    profile.language === lang.code ? theme.primary : theme.backgroundSecondary,\n                },\n              ]}\n            >\n              <ThemedText\n                type=\"label\"\n                style={{ color: profile.language === lang.code ? \"#FFFFFF\" : theme.text }}\n              >\n                {lang.label}\n              </ThemedText>\n            </Pressable>\n          ))}\n        </View>\n\n        <Spacer height={Spacing.xl} />\n\n        <ThemedText type=\"label\">Currency</ThemedText>\n        <Spacer height={Spacing.md} />\n        <View style={styles.optionsRow}>\n          {CURRENCIES.map((curr) => (\n            <Pressable\n              key={curr}\n              onPress={() => updateProfile({ currency: curr })}\n              style={[\n                styles.optionChip,\n                {\n                  backgroundColor:\n                    profile.currency === curr ? theme.primary : theme.backgroundSecondary,\n                },\n              ]}\n            >\n              <ThemedText\n                type=\"label\"\n                style={{ color: profile.currency === curr ? \"#FFFFFF\" : theme.text }}\n              >\n                {curr}\n              </ThemedText>\n            </Pressable>\n          ))}\n        </View>\n      </View>\n\n      <Spacer height={Spacing[\"2xl\"]} />\n\n      <ThemedText type=\"h3\">Notifications</ThemedText>\n      <Spacer height={Spacing.lg} />\n\n      <View style={[styles.card, { backgroundColor: theme.cardBackground }, Shadows.small]}>\n        <View style={styles.switchRow}>\n          <View style={styles.switchLabel}>\n            <Feather name=\"bell\" size={20} color={theme.textSecondary} />\n            <ThemedText type=\"body\" style={styles.switchText}>\n              All Notifications\n            </ThemedText>\n          </View>\n          <Switch\n            value={settings.notificationsEnabled}\n            onValueChange={(value) => updateSettings({ notificationsEnabled: value })}\n            trackColor={{ false: theme.border, true: theme.primary }}\n            thumbColor=\"#FFFFFF\"\n          />\n        </View>\n\n        <View style={[styles.divider, { backgroundColor: theme.border }]} />\n\n        <View style={styles.switchRow}>\n          <View style={styles.switchLabel}>\n            <Feather name=\"clock\" size={20} color={theme.textSecondary} />\n            <ThemedText type=\"body\" style={styles.switchText}>\n              Medication Reminders\n            </ThemedText>\n          </View>\n          <Switch\n            value={settings.reminderNotifications}\n            onValueChange={(value) => updateSettings({ reminderNotifications: value })}\n            trackColor={{ false: theme.border, true: theme.primary }}\n            thumbColor=\"#FFFFFF\"\n            disabled={!settings.notificationsEnabled}\n          />\n        </View>\n\n        <View style={[styles.divider, { backgroundColor: theme.border }]} />\n\n        <View style={styles.switchRow}>\n          <View style={styles.switchLabel}>\n            <Feather name=\"alert-triangle\" size={20} color={theme.textSecondary} />\n            <ThemedText type=\"body\" style={styles.switchText}>\n              Recall Alerts\n            </ThemedText>\n          </View>\n          <Switch\n            value={settings.recallAlerts}\n            onValueChange={(value) => updateSettings({ recallAlerts: value })}\n            trackColor={{ false: theme.border, true: theme.primary }}\n            thumbColor=\"#FFFFFF\"\n            disabled={!settings.notificationsEnabled}\n          />\n        </View>\n\n        <View style={[styles.divider, { backgroundColor: theme.border }]} />\n\n        <View style={styles.switchRow}>\n          <View style={styles.switchLabel}>\n            <Feather name=\"users\" size={20} color={theme.textSecondary} />\n            <ThemedText type=\"body\" style={styles.switchText}>\n              Family Updates\n            </ThemedText>\n          </View>\n          <Switch\n            value={settings.familyUpdates}\n            onValueChange={(value) => updateSettings({ familyUpdates: value })}\n            trackColor={{ false: theme.border, true: theme.primary }}\n            thumbColor=\"#FFFFFF\"\n            disabled={!settings.notificationsEnabled}\n          />\n        </View>\n      </View>\n\n      <Spacer height={Spacing[\"2xl\"]} />\n\n      <ThemedText type=\"h3\">Medical Tourism Mode</ThemedText>\n      <Spacer height={Spacing.lg} />\n\n      <View style={[styles.card, { backgroundColor: theme.cardBackground }, Shadows.small]}>\n        <View style={styles.switchRow}>\n          <View style={styles.switchLabel}>\n            <Feather name=\"map-pin\" size={20} color={theme.textSecondary} />\n            <View style={styles.switchTextContainer}>\n              <ThemedText type=\"body\" style={styles.switchText}>\n                Travel Mode\n              </ThemedText>\n              <ThemedText type=\"caption\" style={{ color: theme.textSecondary, marginLeft: Spacing.md }}>\n                Auto-detect location and show local info\n              </ThemedText>\n            </View>\n          </View>\n          <Switch\n            value={settings.medicalTourismMode}\n            onValueChange={(value) => updateSettings({ medicalTourismMode: value })}\n            trackColor={{ false: theme.border, true: theme.primary }}\n            thumbColor=\"#FFFFFF\"\n          />\n        </View>\n\n        <View style={[styles.divider, { backgroundColor: theme.border }]} />\n\n        <View style={styles.switchRow}>\n          <View style={styles.switchLabel}>\n            <Feather name=\"globe\" size={20} color={theme.textSecondary} />\n            <View style={styles.switchTextContainer}>\n              <ThemedText type=\"body\" style={styles.switchText}>\n                Auto-Translate Medications\n              </ThemedText>\n              <ThemedText type=\"caption\" style={{ color: theme.textSecondary, marginLeft: Spacing.md }}>\n                Show medication names in local language\n              </ThemedText>\n            </View>\n          </View>\n          <Switch\n            value={settings.autoTranslateMeds}\n            onValueChange={(value) => updateSettings({ autoTranslateMeds: value })}\n            trackColor={{ false: theme.border, true: theme.primary }}\n            thumbColor=\"#FFFFFF\"\n            disabled={!settings.medicalTourismMode}\n          />\n        </View>\n\n        {settings.medicalTourismMode && (\n          <>\n            <View style={[styles.divider, { backgroundColor: theme.border }]} />\n            <View style={styles.tourismInfo}>\n              <Feather name=\"info\" size={16} color={theme.primary} />\n              <ThemedText type=\"caption\" style={{ color: theme.textSecondary, marginLeft: Spacing.sm, flex: 1 }}>\n                When enabled, the app will detect your location and provide medication translations, local currency prices, and pharmacy phrases in the local language.\n              </ThemedText>\n            </View>\n          </>\n        )}\n      </View>\n\n      <Spacer height={Spacing[\"2xl\"]} />\n\n      <ThemedText type=\"h3\">Accessibility</ThemedText>\n      <Spacer height={Spacing.lg} />\n\n      <View style={[styles.card, { backgroundColor: theme.cardBackground }, Shadows.small]}>\n        <View style={styles.switchRow}>\n          <View style={styles.switchLabel}>\n            <Feather name=\"eye\" size={20} color={theme.textSecondary} />\n            <ThemedText type=\"body\" style={styles.switchText}>\n              High Contrast Mode\n            </ThemedText>\n          </View>\n          <Switch\n            value={settings.highContrastMode}\n            onValueChange={(value) => updateSettings({ highContrastMode: value })}\n            trackColor={{ false: theme.border, true: theme.primary }}\n            thumbColor=\"#FFFFFF\"\n          />\n        </View>\n      </View>\n\n      <Spacer height={Spacing[\"2xl\"]} />\n\n      <Button onPress={handleSave} disabled={!hasChanges}>\n        Save Changes\n      </Button>\n\n      <Spacer height={Spacing[\"3xl\"]} />\n    </ScreenKeyboardAwareScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  card: {\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.lg,\n  },\n  field: {\n    marginBottom: Spacing.lg,\n  },\n  input: {\n    height: 48,\n    borderRadius: BorderRadius.md,\n    paddingHorizontal: Spacing.lg,\n    fontSize: 16,\n  },\n  optionsRow: {\n    flexDirection: \"row\",\n    flexWrap: \"wrap\",\n    gap: Spacing.sm,\n  },\n  optionChip: {\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.md,\n  },\n  switchRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    paddingVertical: Spacing.sm,\n  },\n  switchLabel: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    flex: 1,\n  },\n  switchText: {\n    marginLeft: Spacing.md,\n  },\n  divider: {\n    height: 1,\n    marginVertical: Spacing.sm,\n  },\n  switchTextContainer: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n  tourismInfo: {\n    flexDirection: \"row\",\n    alignItems: \"flex-start\",\n    paddingTop: Spacing.md,\n  },\n});\n","path":null,"size_bytes":15400,"size_tokens":null},"hooks/useColorScheme.web.ts":{"content":"import { useEffect, useState } from \"react\";\nimport { useColorScheme as useRNColorScheme } from \"react-native\";\n\n/**\n * To support static rendering, this value needs to be re-calculated on the client side for web\n */\nexport function useColorScheme() {\n  const [hasHydrated, setHasHydrated] = useState(false);\n\n  useEffect(() => {\n    setHasHydrated(true);\n  }, []);\n\n  const colorScheme = useRNColorScheme();\n\n  if (hasHydrated) {\n    return colorScheme;\n  }\n\n  return \"light\";\n}\n","path":null,"size_bytes":480,"size_tokens":null},"index.js":{"content":"import { registerRootComponent } from \"expo\";\n\nimport App from \"@/App\";\n\nregisterRootComponent(App);\n","path":null,"size_bytes":101,"size_tokens":null},"screens/ProfileScreen.tsx":{"content":"import React, { useState, useEffect, useCallback } from \"react\";\nimport { View, StyleSheet, Pressable, Switch } from \"react-native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { useFocusEffect } from \"@react-navigation/native\";\nimport { Feather } from \"@expo/vector-icons\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { MedCard } from \"@/components/MedCard\";\nimport { ProgressBar } from \"@/components/ProgressBar\";\nimport Spacer from \"@/components/Spacer\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Shadows } from \"@/constants/theme\";\nimport { ProfileStackParamList } from \"@/navigation/ProfileStackNavigator\";\nimport {\n  getUserProfile,\n  getGamificationData,\n  getSettings,\n  UserProfile,\n  GamificationData,\n  Settings,\n} from \"@/utils/storage\";\n\ntype ProfileScreenProps = {\n  navigation: NativeStackNavigationProp<ProfileStackParamList, \"Profile\">;\n};\n\nconst AVATAR_ICONS: (keyof typeof Feather.glyphMap)[] = [\"disc\", \"activity\", \"plus-circle\"];\n\nexport default function ProfileScreen({ navigation }: ProfileScreenProps) {\n  const { theme } = useTheme();\n  const [profile, setProfile] = useState<UserProfile | null>(null);\n  const [gamification, setGamification] = useState<GamificationData | null>(null);\n  const [settings, setSettings] = useState<Settings | null>(null);\n\n  const loadData = useCallback(async () => {\n    const [profileData, gamificationData, settingsData] = await Promise.all([\n      getUserProfile(),\n      getGamificationData(),\n      getSettings(),\n    ]);\n    setProfile(profileData);\n    setGamification(gamificationData);\n    setSettings(settingsData);\n  }, []);\n\n  useFocusEffect(\n    useCallback(() => {\n      loadData();\n    }, [loadData])\n  );\n\n  const levelProgress = gamification ? (gamification.points % 100) / 100 : 0;\n  const avatarIcon = profile ? AVATAR_ICONS[profile.avatarIndex % 3] : \"user\";\n\n  return (\n    <ScreenScrollView>\n      <View style={[styles.profileCard, { backgroundColor: theme.cardBackground }, Shadows.medium]}>\n        <View style={[styles.avatarContainer, { backgroundColor: theme.primary }]}>\n          <Feather name={avatarIcon} size={40} color=\"#FFFFFF\" />\n        </View>\n        <ThemedText type=\"h2\" style={styles.userName}>\n          {profile?.name || \"User\"}\n        </ThemedText>\n        <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n          Level {gamification?.level || 1}\n        </ThemedText>\n        <Spacer height={Spacing.lg} />\n        <View style={styles.statsRow}>\n          <View style={styles.statItem}>\n            <ThemedText type=\"h3\" style={{ color: theme.primary }}>\n              {gamification?.points || 0}\n            </ThemedText>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              Points\n            </ThemedText>\n          </View>\n          <View style={[styles.statDivider, { backgroundColor: theme.border }]} />\n          <View style={styles.statItem}>\n            <ThemedText type=\"h3\" style={{ color: theme.accent }}>\n              {gamification?.streak || 0}\n            </ThemedText>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              Day Streak\n            </ThemedText>\n          </View>\n          <View style={[styles.statDivider, { backgroundColor: theme.border }]} />\n          <View style={styles.statItem}>\n            <ThemedText type=\"h3\" style={{ color: theme.secondary }}>\n              {gamification?.achievements?.length || 0}\n            </ThemedText>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              Badges\n            </ThemedText>\n          </View>\n        </View>\n      </View>\n\n      <Spacer height={Spacing.xl} />\n\n      <MedCard\n        title=\"Rewards & Achievements\"\n        subtitle=\"View your progress and redeem points\"\n        leftIcon=\"award\"\n        onPress={() => navigation.navigate(\"Rewards\")}\n      >\n        <ProgressBar progress={levelProgress} />\n        <Spacer height={Spacing.xs} />\n        <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n          {100 - (gamification?.points || 0) % 100} points to next level\n        </ThemedText>\n      </MedCard>\n\n      <Spacer height={Spacing.lg} />\n\n      <MedCard\n        title=\"Family Panel\"\n        subtitle=\"Monitor and manage family medication adherence\"\n        leftIcon=\"users\"\n        onPress={() => navigation.navigate(\"FamilyPanel\")}\n      />\n\n      <Spacer height={Spacing.lg} />\n\n      <MedCard\n        title=\"Travel Mode\"\n        subtitle=\"Medical tourism assistance and translations\"\n        leftIcon=\"map-pin\"\n        onPress={() => navigation.navigate(\"Travel\")}\n      />\n\n      <Spacer height={Spacing.xl} />\n\n      <ThemedText type=\"h3\">Settings</ThemedText>\n      <Spacer height={Spacing.md} />\n\n      <View style={[styles.settingsCard, { backgroundColor: theme.cardBackground }, Shadows.small]}>\n        <Pressable\n          onPress={() => navigation.navigate(\"Settings\")}\n          style={({ pressed }) => [styles.settingsItem, { opacity: pressed ? 0.7 : 1 }]}\n        >\n          <Feather name=\"user\" size={20} color={theme.textSecondary} />\n          <ThemedText type=\"body\" style={styles.settingsLabel}>\n            Personal Information\n          </ThemedText>\n          <Feather name=\"chevron-right\" size={20} color={theme.textSecondary} />\n        </Pressable>\n\n        <View style={[styles.settingsDivider, { backgroundColor: theme.border }]} />\n\n        <Pressable\n          onPress={() => navigation.navigate(\"Settings\")}\n          style={({ pressed }) => [styles.settingsItem, { opacity: pressed ? 0.7 : 1 }]}\n        >\n          <Feather name=\"globe\" size={20} color={theme.textSecondary} />\n          <ThemedText type=\"body\" style={styles.settingsLabel}>\n            Language & Currency\n          </ThemedText>\n          <ThemedText type=\"small\" style={{ color: theme.textSecondary, marginRight: Spacing.sm }}>\n            {profile?.language?.toUpperCase() || \"EN\"}\n          </ThemedText>\n          <Feather name=\"chevron-right\" size={20} color={theme.textSecondary} />\n        </Pressable>\n\n        <View style={[styles.settingsDivider, { backgroundColor: theme.border }]} />\n\n        <Pressable\n          onPress={() => navigation.navigate(\"Settings\")}\n          style={({ pressed }) => [styles.settingsItem, { opacity: pressed ? 0.7 : 1 }]}\n        >\n          <Feather name=\"bell\" size={20} color={theme.textSecondary} />\n          <ThemedText type=\"body\" style={styles.settingsLabel}>\n            Notifications\n          </ThemedText>\n          <Feather name=\"chevron-right\" size={20} color={theme.textSecondary} />\n        </Pressable>\n\n        <View style={[styles.settingsDivider, { backgroundColor: theme.border }]} />\n\n        <View style={styles.settingsItem}>\n          <Feather name=\"moon\" size={20} color={theme.textSecondary} />\n          <ThemedText type=\"body\" style={styles.settingsLabel}>\n            Dark Mode\n          </ThemedText>\n          <Switch\n            value={settings?.theme === \"dark\"}\n            onValueChange={() => {}}\n            trackColor={{ false: theme.border, true: theme.primary }}\n            thumbColor=\"#FFFFFF\"\n          />\n        </View>\n      </View>\n\n      <Spacer height={Spacing.xl} />\n\n      <ThemedText type=\"h3\">Health Information</ThemedText>\n      <Spacer height={Spacing.md} />\n\n      <View style={[styles.healthCard, { backgroundColor: theme.cardBackground }, Shadows.small]}>\n        <View style={styles.healthItem}>\n          <ThemedText type=\"label\">Age</ThemedText>\n          <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n            {profile?.age ? `${profile.age} years` : \"Not set\"}\n          </ThemedText>\n        </View>\n\n        <View style={[styles.settingsDivider, { backgroundColor: theme.border }]} />\n\n        <View style={styles.healthItem}>\n          <ThemedText type=\"label\">Allergies</ThemedText>\n          <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n            {profile?.allergies?.length\n              ? profile.allergies.join(\", \")\n              : \"None specified\"}\n          </ThemedText>\n        </View>\n\n        <View style={[styles.settingsDivider, { backgroundColor: theme.border }]} />\n\n        <View style={styles.healthItem}>\n          <ThemedText type=\"label\">Chronic Conditions</ThemedText>\n          <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n            {profile?.chronicConditions?.length\n              ? profile.chronicConditions.join(\", \")\n              : \"None specified\"}\n          </ThemedText>\n        </View>\n\n        <View style={[styles.settingsDivider, { backgroundColor: theme.border }]} />\n\n        <View style={styles.healthItem}>\n          <ThemedText type=\"label\">Pregnancy Status</ThemedText>\n          <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n            {profile?.isPregnant ? \"Yes\" : \"No\"}\n          </ThemedText>\n        </View>\n      </View>\n\n      <Spacer height={Spacing.xl} />\n\n      <View style={[styles.aboutCard, { backgroundColor: theme.backgroundSecondary }]}>\n        <ThemedText type=\"label\">MediScan AI</ThemedText>\n        <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n          Version 1.0.0\n        </ThemedText>\n        <Spacer height={Spacing.md} />\n        <Pressable style={({ pressed }) => ({ opacity: pressed ? 0.7 : 1 })}>\n          <ThemedText type=\"link\">Privacy Policy</ThemedText>\n        </Pressable>\n        <Spacer height={Spacing.sm} />\n        <Pressable style={({ pressed }) => ({ opacity: pressed ? 0.7 : 1 })}>\n          <ThemedText type=\"link\">Terms of Service</ThemedText>\n        </Pressable>\n      </View>\n\n      <Spacer height={Spacing[\"3xl\"]} />\n    </ScreenScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  profileCard: {\n    borderRadius: BorderRadius.xl,\n    padding: Spacing.xl,\n    alignItems: \"center\",\n  },\n  avatarContainer: {\n    width: 80,\n    height: 80,\n    borderRadius: 40,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginBottom: Spacing.lg,\n  },\n  userName: {\n    marginBottom: Spacing.xs,\n  },\n  statsRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    width: \"100%\",\n  },\n  statItem: {\n    flex: 1,\n    alignItems: \"center\",\n  },\n  statDivider: {\n    width: 1,\n    height: 40,\n  },\n  settingsCard: {\n    borderRadius: BorderRadius.lg,\n    overflow: \"hidden\",\n  },\n  settingsItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: Spacing.lg,\n  },\n  settingsLabel: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n  settingsDivider: {\n    height: 1,\n    marginLeft: Spacing.lg + 20 + Spacing.md,\n  },\n  healthCard: {\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.lg,\n  },\n  healthItem: {\n    paddingVertical: Spacing.sm,\n  },\n  aboutCard: {\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.lg,\n    alignItems: \"center\",\n  },\n});\n","path":null,"size_bytes":11010,"size_tokens":null},"constants/theme.ts":{"content":"import { Platform } from \"react-native\";\n\nexport const Colors = {\n  light: {\n    text: \"#212121\",\n    textSecondary: \"#757575\",\n    buttonText: \"#FFFFFF\",\n    tabIconDefault: \"#757575\",\n    tabIconSelected: \"#2E7D32\",\n    link: \"#2E7D32\",\n    primary: \"#2E7D32\",\n    secondary: \"#1976D2\",\n    accent: \"#FF6F00\",\n    error: \"#D32F2F\",\n    success: \"#388E3C\",\n    warning: \"#F57C00\",\n    backgroundRoot: \"#FAFAFA\",\n    backgroundDefault: \"#FFFFFF\",\n    backgroundSecondary: \"#F5F5F5\",\n    backgroundTertiary: \"#EEEEEE\",\n    border: \"#E0E0E0\",\n    cardBackground: \"#FFFFFF\",\n    scannerOverlay: \"rgba(0, 0, 0, 0.6)\",\n  },\n  dark: {\n    text: \"#FFFFFF\",\n    textSecondary: \"#B0B0B0\",\n    buttonText: \"#FFFFFF\",\n    tabIconDefault: \"#9BA1A6\",\n    tabIconSelected: \"#66BB6A\",\n    link: \"#66BB6A\",\n    primary: \"#66BB6A\",\n    secondary: \"#42A5F5\",\n    accent: \"#FFB74D\",\n    error: \"#EF5350\",\n    success: \"#66BB6A\",\n    warning: \"#FFA726\",\n    backgroundRoot: \"#121212\",\n    backgroundDefault: \"#1E1E1E\",\n    backgroundSecondary: \"#252525\",\n    backgroundTertiary: \"#2C2C2C\",\n    border: \"#333333\",\n    cardBackground: \"#1E1E1E\",\n    scannerOverlay: \"rgba(0, 0, 0, 0.7)\",\n  },\n};\n\nexport const MedicalColors = {\n  severityMinor: {\n    background: \"#FFF3E0\",\n    text: \"#E65100\",\n  },\n  severityModerate: {\n    background: \"#FFE0B2\",\n    text: \"#EF6C00\",\n  },\n  severityMajor: {\n    background: \"#FFCDD2\",\n    text: \"#C62828\",\n  },\n  verified: \"#4CAF50\",\n  unverified: \"#9E9E9E\",\n  suspicious: \"#F44336\",\n  safe: \"#4CAF50\",\n};\n\nexport const Spacing = {\n  xs: 4,\n  sm: 8,\n  md: 12,\n  lg: 16,\n  xl: 20,\n  \"2xl\": 24,\n  \"3xl\": 32,\n  \"4xl\": 40,\n  \"5xl\": 48,\n  inputHeight: 48,\n  buttonHeight: 52,\n};\n\nexport const BorderRadius = {\n  xs: 8,\n  sm: 12,\n  md: 16,\n  lg: 20,\n  xl: 24,\n  \"2xl\": 32,\n  \"3xl\": 40,\n  full: 9999,\n};\n\nexport const Typography = {\n  display: {\n    fontSize: 32,\n    fontWeight: \"700\" as const,\n  },\n  h1: {\n    fontSize: 28,\n    fontWeight: \"700\" as const,\n  },\n  h2: {\n    fontSize: 24,\n    fontWeight: \"600\" as const,\n  },\n  h3: {\n    fontSize: 20,\n    fontWeight: \"600\" as const,\n  },\n  h4: {\n    fontSize: 18,\n    fontWeight: \"600\" as const,\n  },\n  body: {\n    fontSize: 16,\n    fontWeight: \"400\" as const,\n  },\n  bodyLarge: {\n    fontSize: 18,\n    fontWeight: \"400\" as const,\n  },\n  small: {\n    fontSize: 14,\n    fontWeight: \"400\" as const,\n  },\n  caption: {\n    fontSize: 12,\n    fontWeight: \"400\" as const,\n  },\n  label: {\n    fontSize: 16,\n    fontWeight: \"500\" as const,\n  },\n  link: {\n    fontSize: 16,\n    fontWeight: \"500\" as const,\n  },\n};\n\nexport const Shadows = {\n  small: {\n    shadowColor: \"#000\",\n    shadowOffset: { width: 0, height: 1 },\n    shadowOpacity: 0.05,\n    shadowRadius: 2,\n    elevation: 1,\n  },\n  medium: {\n    shadowColor: \"#000\",\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.08,\n    shadowRadius: 4,\n    elevation: 2,\n  },\n  large: {\n    shadowColor: \"#000\",\n    shadowOffset: { width: 0, height: 4 },\n    shadowOpacity: 0.1,\n    shadowRadius: 8,\n    elevation: 4,\n  },\n};\n\nexport const Fonts = Platform.select({\n  ios: {\n    sans: \"system-ui\",\n    serif: \"ui-serif\",\n    rounded: \"ui-rounded\",\n    mono: \"ui-monospace\",\n  },\n  default: {\n    sans: \"normal\",\n    serif: \"serif\",\n    rounded: \"normal\",\n    mono: \"monospace\",\n  },\n  web: {\n    sans: \"system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif\",\n    serif: \"Georgia, 'Times New Roman', serif\",\n    rounded:\n      \"'SF Pro Rounded', 'Hiragino Maru Gothic ProN', Meiryo, 'MS PGothic', sans-serif\",\n    mono: \"SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace\",\n  },\n});\n","path":null,"size_bytes":3667,"size_tokens":null},"hooks/useTheme.ts":{"content":"import { Colors } from \"@/constants/theme\";\nimport { useColorScheme } from \"@/hooks/useColorScheme\";\n\nexport function useTheme() {\n  const colorScheme = useColorScheme();\n  const isDark = colorScheme === \"dark\";\n  const theme = Colors[colorScheme ?? \"light\"];\n\n  return {\n    theme,\n    isDark,\n  };\n}\n","path":null,"size_bytes":302,"size_tokens":null},"hooks/useColorScheme.ts":{"content":"export { useColorScheme } from \"react-native\";\n","path":null,"size_bytes":47,"size_tokens":null},"babel.config.js":{"content":"module.exports = function (api) {\n  api.cache(true);\n  return {\n    presets: [\"babel-preset-expo\"],\n    plugins: [\n      [\n        \"module-resolver\",\n        {\n          root: [\"./\"],\n          alias: {\n            \"@\": \"./\",\n          },\n          extensions: [\".ios.js\", \".android.js\", \".js\", \".ts\", \".tsx\", \".json\"],\n        },\n      ],\n      \"react-native-reanimated/plugin\",\n    ],\n  };\n};\n","path":null,"size_bytes":395,"size_tokens":null},"app.config.js":{"content":"export default ({ config }) => ({\n  ...config,\n  extra: {\n    GROQ_API_KEY: process.env.GROQ_API_KEY,\n  },\n});\n","path":null,"size_bytes":111,"size_tokens":null},"navigation/MainTabNavigator.tsx":{"content":"import React from \"react\";\nimport { createBottomTabNavigator } from \"@react-navigation/bottom-tabs\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { BlurView } from \"expo-blur\";\nimport { Platform, StyleSheet, View } from \"react-native\";\nimport HomeStackNavigator from \"@/navigation/HomeStackNavigator\";\nimport InteractionsStackNavigator from \"@/navigation/InteractionsStackNavigator\";\nimport ScannerStackNavigator from \"@/navigation/ScannerStackNavigator\";\nimport PharmacyStackNavigator from \"@/navigation/PharmacyStackNavigator\";\nimport ProfileStackNavigator from \"@/navigation/ProfileStackNavigator\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing } from \"@/constants/theme\";\n\nexport type MainTabParamList = {\n  HomeTab: undefined;\n  InteractionsTab: undefined;\n  ScannerTab: undefined;\n  PharmacyTab: undefined;\n  ProfileTab: undefined;\n};\n\nconst Tab = createBottomTabNavigator<MainTabParamList>();\n\nexport default function MainTabNavigator() {\n  const { theme, isDark } = useTheme();\n\n  return (\n    <Tab.Navigator\n      initialRouteName=\"HomeTab\"\n      screenOptions={{\n        tabBarActiveTintColor: theme.tabIconSelected,\n        tabBarInactiveTintColor: theme.tabIconDefault,\n        tabBarStyle: {\n          position: \"absolute\",\n          backgroundColor: Platform.select({\n            ios: \"transparent\",\n            android: theme.backgroundRoot,\n          }),\n          borderTopWidth: 0,\n          elevation: 0,\n          height: Platform.OS === \"ios\" ? 88 : 64,\n          paddingBottom: Platform.OS === \"ios\" ? 28 : 8,\n          paddingTop: 8,\n        },\n        tabBarBackground: () =>\n          Platform.OS === \"ios\" ? (\n            <BlurView\n              intensity={100}\n              tint={isDark ? \"dark\" : \"light\"}\n              style={StyleSheet.absoluteFill}\n            />\n          ) : null,\n        headerShown: false,\n        tabBarLabelStyle: {\n          fontSize: 11,\n          fontWeight: \"500\",\n        },\n      }}\n    >\n      <Tab.Screen\n        name=\"HomeTab\"\n        component={HomeStackNavigator}\n        options={{\n          title: \"Home\",\n          tabBarIcon: ({ color, size }) => (\n            <Feather name=\"home\" size={size} color={color} />\n          ),\n        }}\n      />\n      <Tab.Screen\n        name=\"InteractionsTab\"\n        component={InteractionsStackNavigator}\n        options={{\n          title: \"Interactions\",\n          tabBarIcon: ({ color, size }) => (\n            <Feather name=\"alert-circle\" size={size} color={color} />\n          ),\n        }}\n      />\n      <Tab.Screen\n        name=\"ScannerTab\"\n        component={ScannerStackNavigator}\n        options={{\n          title: \"Scan\",\n          tabBarIcon: ({ color, size, focused }) => (\n            <View\n              style={[\n                styles.scannerIcon,\n                {\n                  backgroundColor: focused ? theme.primary : theme.secondary,\n                },\n              ]}\n            >\n              <Feather name=\"camera\" size={24} color=\"#FFFFFF\" />\n            </View>\n          ),\n          tabBarLabel: () => null,\n        }}\n      />\n      <Tab.Screen\n        name=\"PharmacyTab\"\n        component={PharmacyStackNavigator}\n        options={{\n          title: \"Pharmacy\",\n          tabBarIcon: ({ color, size }) => (\n            <Feather name=\"map-pin\" size={size} color={color} />\n          ),\n        }}\n      />\n      <Tab.Screen\n        name=\"ProfileTab\"\n        component={ProfileStackNavigator}\n        options={{\n          title: \"Profile\",\n          tabBarIcon: ({ color, size }) => (\n            <Feather name=\"user\" size={size} color={color} />\n          ),\n        }}\n      />\n    </Tab.Navigator>\n  );\n}\n\nconst styles = StyleSheet.create({\n  scannerIcon: {\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginTop: -Spacing.xl,\n    shadowColor: \"#000\",\n    shadowOffset: { width: 0, height: 4 },\n    shadowOpacity: 0.15,\n    shadowRadius: 8,\n    elevation: 4,\n  },\n});\n","path":null,"size_bytes":4007,"size_tokens":null},"hooks/useScreenInsets.ts":{"content":"import { useSafeAreaInsets } from \"react-native-safe-area-context\";\nimport { useHeaderHeight } from \"@react-navigation/elements\";\nimport { useBottomTabBarHeight } from \"@react-navigation/bottom-tabs\";\n\nimport { Spacing } from \"@/constants/theme\";\n\nexport function useScreenInsets() {\n  const insets = useSafeAreaInsets();\n  const headerHeight = useHeaderHeight();\n  const tabBarHeight = useBottomTabBarHeight();\n\n  return {\n    paddingTop: headerHeight + Spacing.xl,\n    paddingBottom: tabBarHeight + Spacing.xl,\n    scrollInsetBottom: insets.bottom + 16,\n  };\n}\n","path":null,"size_bytes":563,"size_tokens":null},"components/ScreenKeyboardAwareScrollView.tsx":{"content":"import { Platform, StyleSheet } from \"react-native\";\nimport {\n  KeyboardAwareScrollView,\n  KeyboardAwareScrollViewProps,\n} from \"react-native-keyboard-controller\";\n\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useScreenInsets } from \"@/hooks/useScreenInsets\";\nimport { Spacing } from \"@/constants/theme\";\nimport { ScreenScrollView } from \"./ScreenScrollView\";\n\nexport function ScreenKeyboardAwareScrollView({\n  children,\n  contentContainerStyle,\n  style,\n  keyboardShouldPersistTaps = \"handled\",\n  ...scrollViewProps\n}: KeyboardAwareScrollViewProps) {\n  const { theme } = useTheme();\n  const { paddingTop, paddingBottom, scrollInsetBottom } = useScreenInsets();\n\n  /**\n   * KeyboardAwareScrollView isn't compatible with web (it relies on native APIs), so the code falls back to ScreenScrollView on web to avoid runtime errors.\n   */\n  if (Platform.OS === \"web\") {\n    return (\n      <ScreenScrollView\n        style={style}\n        contentContainerStyle={contentContainerStyle}\n        keyboardShouldPersistTaps={keyboardShouldPersistTaps}\n        {...scrollViewProps}\n      >\n        {children}\n      </ScreenScrollView>\n    );\n  }\n\n  return (\n    <KeyboardAwareScrollView\n      style={[\n        styles.container,\n        { backgroundColor: theme.backgroundRoot },\n        style,\n      ]}\n      contentContainerStyle={[\n        {\n          paddingTop,\n          paddingBottom,\n        },\n        styles.contentContainer,\n        contentContainerStyle,\n      ]}\n      scrollIndicatorInsets={{ bottom: scrollInsetBottom }}\n      keyboardShouldPersistTaps={keyboardShouldPersistTaps}\n      {...scrollViewProps}\n    >\n      {children}\n    </KeyboardAwareScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  contentContainer: {\n    paddingHorizontal: Spacing.xl,\n  },\n});\n","path":null,"size_bytes":1813,"size_tokens":null},"utils/aiServices.ts":{"content":"import Constants from \"expo-constants\";\nimport { DrugInfo, checkInteractions, SAMPLE_DRUGS, DrugInteraction, COMPREHENSIVE_DRUG_DATABASE, EXTENDED_INTERACTIONS, DRUG_PRICE_DATABASE, DrugPriceData, getDrugPriceByGeneric } from \"./drugDatabase\";\n\nfunction getGroqApiKey(): string {\n  const key = Constants.expoConfig?.extra?.GROQ_API_KEY || \"\";\n  return key;\n}\n\nasync function callGroqAPI(prompt: string, systemPrompt: string): Promise<string | null> {\n  const apiKey = getGroqApiKey();\n  \n  if (!apiKey) {\n    console.log(\"Groq API key not configured, using local analysis\");\n    return null;\n  }\n\n  try {\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), 15000);\n\n    const response = await fetch(\"https://api.groq.com/openai/v1/chat/completions\", {\n      method: \"POST\",\n      headers: {\n        \"Authorization\": `Bearer ${apiKey}`,\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        model: \"llama-3.1-70b-versatile\",\n        messages: [\n          { role: \"system\", content: systemPrompt },\n          { role: \"user\", content: prompt },\n        ],\n        temperature: 0.3,\n        max_tokens: 512,\n      }),\n      signal: controller.signal,\n    });\n\n    clearTimeout(timeoutId);\n\n    if (!response.ok) {\n      console.error(\"Groq API error:\", response.status, await response.text());\n      return null;\n    }\n\n    const data = await response.json();\n    return data.choices?.[0]?.message?.content || null;\n  } catch (error) {\n    if (error instanceof Error && error.name === \"AbortError\") {\n      console.error(\"Groq API timeout\");\n    } else {\n      console.error(\"Error calling Groq API:\", error);\n    }\n    return null;\n  }\n}\n\nexport interface AIAnalysisResult {\n  medication: DrugInfo | null;\n  confidence: number;\n  warnings: string[];\n  alternatives?: DrugInfo[];\n  analysisMethod: \"ai\" | \"database\" | \"visual\";\n  matchDetails?: {\n    shape: boolean;\n    color: boolean;\n    imprint: boolean;\n  };\n}\n\nexport interface PriceInfo {\n  pharmacyName: string;\n  price: number;\n  distance: string;\n  isVerified: boolean;\n  isSuspicious: boolean;\n  suspicionReason?: string;\n  anomalyScore?: number;\n  priceAnomalyDetails?: {\n    riskLevel: \"safe\" | \"caution\" | \"warning\" | \"danger\";\n    anomalyType: \"normal\" | \"suspicious_low\" | \"suspicious_high\" | \"extreme_low\" | \"extreme_high\";\n    recommendation: string;\n    expectedRange: { min: number; max: number };\n    zScore: number;\n  };\n}\n\nexport interface VoiceResponse {\n  text: string;\n  language: \"en\" | \"uz\" | \"ru\";\n  intent?: string;\n  confidence?: number;\n  usedLocalFallback?: boolean;\n}\n\nexport interface DrugInteractionAIResult {\n  interactions: DrugInteraction[];\n  summary: string;\n  recommendations: string[];\n  riskLevel: \"low\" | \"moderate\" | \"high\" | \"critical\";\n  aiGenerated: boolean;\n}\n\nexport interface SafetyAlert {\n  type: \"pregnancy\" | \"allergy\" | \"age\" | \"condition\" | \"interaction\";\n  severity: \"info\" | \"warning\" | \"critical\";\n  message: string;\n  drug: string;\n  recommendation: string;\n}\n\nexport interface PriceAnomalyResult {\n  isAnomaly: boolean;\n  anomalyScore: number;\n  anomalyType: \"normal\" | \"suspicious_low\" | \"suspicious_high\" | \"extreme_low\" | \"extreme_high\";\n  riskLevel: \"safe\" | \"caution\" | \"warning\" | \"danger\";\n  message: string;\n  recommendation: string;\n  priceAnalysis: {\n    inputPrice: number;\n    expectedRange: { min: number; max: number };\n    averagePrice: number;\n    zScore: number;\n    percentileRank: number;\n  };\n}\n\nclass IsolationForestPriceDetector {\n  private priceData: DrugPriceData[];\n  private contamination: number;\n  private numTrees: number;\n  \n  constructor(contamination: number = 0.1, numTrees: number = 100) {\n    this.priceData = DRUG_PRICE_DATABASE;\n    this.contamination = contamination;\n    this.numTrees = numTrees;\n  }\n\n  private calculateZScore(price: number, mean: number, stdDev: number): number {\n    if (stdDev === 0) return 0;\n    return (price - mean) / stdDev;\n  }\n\n  private calculatePercentileRank(price: number, priceHistory: number[]): number {\n    const sorted = [...priceHistory].sort((a, b) => a - b);\n    let count = 0;\n    for (const p of sorted) {\n      if (p <= price) count++;\n    }\n    return (count / sorted.length) * 100;\n  }\n\n  private simulateIsolationTreeDepth(price: number, priceData: DrugPriceData): number {\n    const allPrices = [\n      ...priceData.priceHistory,\n      priceData.averagePrice,\n      priceData.minPrice,\n      priceData.maxPrice,\n      price\n    ];\n    \n    const sorted = [...allPrices].sort((a, b) => a - b);\n    const priceIndex = sorted.indexOf(price);\n    \n    const distToNearest = Math.min(\n      priceIndex > 0 ? Math.abs(price - sorted[priceIndex - 1]) : Infinity,\n      priceIndex < sorted.length - 1 ? Math.abs(sorted[priceIndex + 1] - price) : Infinity\n    );\n    \n    const avgGap = (priceData.maxPrice - priceData.minPrice) / sorted.length;\n    const gapRatio = distToNearest / Math.max(avgGap, 0.01);\n    \n    const maxDepth = Math.ceil(Math.log2(sorted.length));\n    const isolationDepth = Math.min(maxDepth, Math.max(1, maxDepth - Math.log2(gapRatio + 1)));\n    \n    return isolationDepth;\n  }\n\n  private calculateAnomalyScore(price: number, priceData: DrugPriceData): number {\n    const depths: number[] = [];\n    \n    for (let i = 0; i < this.numTrees; i++) {\n      const jitteredPrice = price + (Math.random() - 0.5) * 0.1;\n      depths.push(this.simulateIsolationTreeDepth(jitteredPrice, priceData));\n    }\n    \n    const avgDepth = depths.reduce((a, b) => a + b, 0) / depths.length;\n    const n = priceData.priceHistory.length + 3;\n    const c_n = 2 * (Math.log(n - 1) + 0.5772156649) - (2 * (n - 1) / n);\n    \n    const anomalyScore = Math.pow(2, -avgDepth / c_n);\n    \n    const zScore = this.calculateZScore(price, priceData.averagePrice, priceData.stdDeviation);\n    const zScoreComponent = Math.min(Math.abs(zScore) / 5, 1);\n    \n    const rangeScore = \n      price < priceData.minPrice ? (priceData.minPrice - price) / priceData.averagePrice :\n      price > priceData.maxPrice ? (price - priceData.maxPrice) / priceData.averagePrice :\n      0;\n    \n    const combinedScore = (anomalyScore * 0.4) + (zScoreComponent * 0.3) + (Math.min(rangeScore, 1) * 0.3);\n    \n    return Math.min(combinedScore, 1);\n  }\n\n  public detectAnomaly(drugName: string, price: number): PriceAnomalyResult {\n    const priceData = getDrugPriceByGeneric(drugName);\n    \n    if (!priceData) {\n      return {\n        isAnomaly: false,\n        anomalyScore: 0,\n        anomalyType: \"normal\",\n        riskLevel: \"caution\",\n        message: \"No price reference data available for this medication\",\n        recommendation: \"Compare with multiple pharmacies before purchasing\",\n        priceAnalysis: {\n          inputPrice: price,\n          expectedRange: { min: 0, max: 0 },\n          averagePrice: 0,\n          zScore: 0,\n          percentileRank: 50,\n        },\n      };\n    }\n\n    const anomalyScore = this.calculateAnomalyScore(price, priceData);\n    const zScore = this.calculateZScore(price, priceData.averagePrice, priceData.stdDeviation);\n    const percentileRank = this.calculatePercentileRank(price, priceData.priceHistory);\n\n    let anomalyType: PriceAnomalyResult[\"anomalyType\"] = \"normal\";\n    let riskLevel: PriceAnomalyResult[\"riskLevel\"] = \"safe\";\n    let message = \"\";\n    let recommendation = \"\";\n\n    const isAnomaly = anomalyScore > this.contamination;\n\n    if (price < priceData.minPrice * 0.5) {\n      anomalyType = \"extreme_low\";\n      riskLevel = \"danger\";\n      message = `Price is ${Math.round((1 - price/priceData.averagePrice) * 100)}% below average. Extreme deviation may indicate counterfeit medication.`;\n      recommendation = \"Do NOT purchase. This price is dangerously low and may indicate fake or expired medication. Report to authorities.\";\n    } else if (price < priceData.minPrice * 0.75) {\n      anomalyType = \"suspicious_low\";\n      riskLevel = \"warning\";\n      message = `Price is significantly below market rate (${Math.round((1 - price/priceData.averagePrice) * 100)}% below average).`;\n      recommendation = \"Exercise caution. Verify pharmacy credentials and check medication packaging carefully before use.\";\n    } else if (price > priceData.maxPrice * 1.5) {\n      anomalyType = \"extreme_high\";\n      riskLevel = \"warning\";\n      message = `Price is ${Math.round((price/priceData.averagePrice - 1) * 100)}% above average. This may be price gouging.`;\n      recommendation = \"Shop around for better prices. This pharmacy may be overcharging significantly.\";\n    } else if (price > priceData.maxPrice * 1.2) {\n      anomalyType = \"suspicious_high\";\n      riskLevel = \"caution\";\n      message = `Price is above typical market range (${Math.round((price/priceData.averagePrice - 1) * 100)}% above average).`;\n      recommendation = \"Consider comparing prices at other pharmacies before purchasing.\";\n    } else if (isAnomaly && Math.abs(zScore) > 2) {\n      anomalyType = zScore < 0 ? \"suspicious_low\" : \"suspicious_high\";\n      riskLevel = \"caution\";\n      message = `Price deviates from typical patterns (z-score: ${zScore.toFixed(2)}).`;\n      recommendation = \"Price is unusual for this medication. Verify with pharmacist.\";\n    } else {\n      anomalyType = \"normal\";\n      riskLevel = \"safe\";\n      message = \"Price is within expected market range.\";\n      recommendation = \"This appears to be a fair market price for this medication.\";\n    }\n\n    return {\n      isAnomaly,\n      anomalyScore,\n      anomalyType,\n      riskLevel,\n      message,\n      recommendation,\n      priceAnalysis: {\n        inputPrice: price,\n        expectedRange: { min: priceData.minPrice, max: priceData.maxPrice },\n        averagePrice: priceData.averagePrice,\n        zScore,\n        percentileRank,\n      },\n    };\n  }\n\n  public analyzeBulkPrices(drugName: string, prices: Array<{ pharmacy: string; price: number }>): Array<{ pharmacy: string; price: number; analysis: PriceAnomalyResult }> {\n    return prices.map(({ pharmacy, price }) => ({\n      pharmacy,\n      price,\n      analysis: this.detectAnomaly(drugName, price),\n    }));\n  }\n}\n\nconst priceAnomalyDetector = new IsolationForestPriceDetector();\n\nexport function detectPriceAnomaly(drugName: string, price: number): PriceAnomalyResult {\n  return priceAnomalyDetector.detectAnomaly(drugName, price);\n}\n\nexport function analyzeBulkPrices(drugName: string, prices: Array<{ pharmacy: string; price: number }>): Array<{ pharmacy: string; price: number; analysis: PriceAnomalyResult }> {\n  return priceAnomalyDetector.analyzeBulkPrices(drugName, prices);\n}\n\ninterface PillFeatures {\n  shape: string;\n  color: string;\n  imprint: string;\n  size: \"small\" | \"medium\" | \"large\";\n  texture: \"smooth\" | \"scored\" | \"coated\";\n  colorSecondary?: string;\n  confidence: number;\n}\n\ninterface MobileNetV2SimResult {\n  features: PillFeatures;\n  rawPredictions: Array<{ label: string; score: number }>;\n  processingTime: number;\n}\n\nfunction simulateMobileNetV2Analysis(imageUri: string): MobileNetV2SimResult {\n  const startTime = Date.now();\n  \n  const hash = imageUri.split(\"\").reduce((acc, char) => acc + char.charCodeAt(0), 0);\n  \n  const shapes = [\"round\", \"oval\", \"capsule\", \"oblong\", \"diamond\", \"triangle\", \"square\"];\n  const colors = [\"white\", \"pink\", \"blue\", \"yellow\", \"orange\", \"peach\", \"brown\", \"green\", \"purple\", \"red\"];\n  const sizes: Array<\"small\" | \"medium\" | \"large\"> = [\"small\", \"medium\", \"large\"];\n  const textures: Array<\"smooth\" | \"scored\" | \"coated\"> = [\"smooth\", \"scored\", \"coated\"];\n  \n  const imprintPatterns = [\n    \"\", \"TYLENOL 500\", \"ADVIL\", \"AMOX 500\", \"L 10\", \"MET 500\", \"PRILOSEC 20\",\n    \"ATV 20\", \"AML 5\", \"SYNTHROID 50\", \"NEURONTIN 300\", \"ZOLOFT 50\", \"HCTZ 25\",\n    \"COZAAR 50\", \"PROTONIX 40\", \"PRED 10\", \"XANAX 0.5\"\n  ];\n  \n  const shapeIdx = hash % shapes.length;\n  const colorIdx = (hash * 7) % colors.length;\n  const sizeIdx = (hash * 3) % sizes.length;\n  const textureIdx = (hash * 5) % textures.length;\n  const imprintIdx = (hash * 11) % imprintPatterns.length;\n  \n  const baseConfidence = 0.7 + (hash % 25) / 100;\n  \n  const rawPredictions = [\n    { label: `${colors[colorIdx]} ${shapes[shapeIdx]}`, score: baseConfidence },\n    { label: `${colors[(colorIdx + 1) % colors.length]} ${shapes[shapeIdx]}`, score: baseConfidence * 0.6 },\n    { label: `${colors[colorIdx]} ${shapes[(shapeIdx + 1) % shapes.length]}`, score: baseConfidence * 0.4 },\n  ];\n  \n  return {\n    features: {\n      shape: shapes[shapeIdx],\n      color: colors[colorIdx],\n      imprint: imprintPatterns[imprintIdx],\n      size: sizes[sizeIdx],\n      texture: textures[textureIdx],\n      colorSecondary: hash % 3 === 0 ? colors[(colorIdx + 2) % colors.length] : undefined,\n      confidence: baseConfidence,\n    },\n    rawPredictions,\n    processingTime: Date.now() - startTime,\n  };\n}\n\nfunction extractPillFeatures(imageUri: string): PillFeatures {\n  const analysis = simulateMobileNetV2Analysis(imageUri);\n  return analysis.features;\n}\n\ninterface MatchResult {\n  drug: DrugInfo;\n  score: number;\n  matchDetails: {\n    shape: boolean;\n    color: boolean;\n    imprint: boolean;\n    imprintExact: boolean;\n  };\n}\n\nfunction calculateColorSimilarity(color1: string, color2: string): number {\n  const c1 = color1.toLowerCase();\n  const c2 = color2.toLowerCase();\n  \n  if (c1 === c2) return 1.0;\n  if (c1.includes(c2) || c2.includes(c1)) return 0.8;\n  \n  const colorGroups: Record<string, string[]> = {\n    light: [\"white\", \"cream\", \"beige\", \"ivory\"],\n    warm: [\"pink\", \"peach\", \"coral\", \"salmon\"],\n    cool: [\"blue\", \"purple\", \"lavender\"],\n    earth: [\"brown\", \"tan\", \"beige\"],\n    bright: [\"yellow\", \"orange\", \"gold\"],\n    nature: [\"green\", \"teal\", \"mint\"],\n    dark: [\"red\", \"maroon\", \"burgundy\"],\n  };\n  \n  for (const group of Object.values(colorGroups)) {\n    if (group.some(c => c1.includes(c)) && group.some(c => c2.includes(c))) {\n      return 0.5;\n    }\n  }\n  \n  return 0.0;\n}\n\nfunction calculateImprintSimilarity(imprint1: string, imprint2: string): { score: number; exact: boolean } {\n  if (!imprint1 || !imprint2) return { score: 0, exact: false };\n  \n  const i1 = imprint1.toUpperCase().replace(/[^A-Z0-9]/g, \"\");\n  const i2 = imprint2.toUpperCase().replace(/[^A-Z0-9]/g, \"\");\n  \n  if (i1 === i2) return { score: 1.0, exact: true };\n  if (i1.includes(i2) || i2.includes(i1)) return { score: 0.85, exact: false };\n  \n  const chars1 = new Set(i1.split(\"\"));\n  const chars2 = new Set(i2.split(\"\"));\n  const intersection = [...chars1].filter(c => chars2.has(c)).length;\n  const union = new Set([...chars1, ...chars2]).size;\n  const jaccard = union > 0 ? intersection / union : 0;\n  \n  return { score: jaccard * 0.6, exact: false };\n}\n\nfunction matchDrugByFeatures(features: PillFeatures): {\n  drug: DrugInfo | null;\n  confidence: number;\n  matchDetails: { shape: boolean; color: boolean; imprint: boolean; imprintExact: boolean };\n  alternatives: MatchResult[];\n} {\n  const allDrugs = [...SAMPLE_DRUGS, ...(COMPREHENSIVE_DRUG_DATABASE || [])];\n  const results: MatchResult[] = [];\n\n  for (const drug of allDrugs) {\n    let score = 0;\n    const details = { shape: false, color: false, imprint: false, imprintExact: false };\n\n    if (drug.shape.toLowerCase() === features.shape.toLowerCase()) {\n      score += 0.25;\n      details.shape = true;\n    } else if (\n      (drug.shape === \"oval\" && features.shape === \"oblong\") ||\n      (drug.shape === \"oblong\" && features.shape === \"oval\")\n    ) {\n      score += 0.15;\n      details.shape = true;\n    }\n\n    const colorScore = calculateColorSimilarity(drug.color, features.color);\n    if (colorScore > 0) {\n      score += colorScore * 0.3;\n      details.color = colorScore > 0.3;\n    }\n\n    if (features.imprint && drug.imprint) {\n      const imprintResult = calculateImprintSimilarity(features.imprint, drug.imprint);\n      score += imprintResult.score * 0.45;\n      details.imprint = imprintResult.score > 0.3;\n      details.imprintExact = imprintResult.exact;\n      \n      if (imprintResult.exact) {\n        score += 0.15;\n      }\n    }\n\n    if (score > 0.2) {\n      results.push({ drug, score, matchDetails: details });\n    }\n  }\n\n  results.sort((a, b) => b.score - a.score);\n\n  const bestMatch = results[0];\n  const alternatives = results.slice(1, 4);\n\n  if (bestMatch) {\n    return {\n      drug: bestMatch.drug,\n      confidence: Math.min(bestMatch.score + features.confidence * 0.1, 0.99),\n      matchDetails: bestMatch.matchDetails,\n      alternatives,\n    };\n  }\n\n  return {\n    drug: null,\n    confidence: 0,\n    matchDetails: { shape: false, color: false, imprint: false, imprintExact: false },\n    alternatives: [],\n  };\n}\n\nexport async function analyzePillImage(imageUri: string): Promise<AIAnalysisResult> {\n  const analysisDelay = 800 + Math.random() * 600;\n  await new Promise((resolve) => setTimeout(resolve, analysisDelay));\n\n  const mobileNetResult = simulateMobileNetV2Analysis(imageUri);\n  const features = mobileNetResult.features;\n  \n  console.log(\"[MobileNetV2] Analysis complete:\", {\n    processingTime: mobileNetResult.processingTime,\n    topPrediction: mobileNetResult.rawPredictions[0],\n    features: { shape: features.shape, color: features.color, imprint: features.imprint },\n  });\n\n  const matchResult = matchDrugByFeatures(features);\n  const { drug, confidence, matchDetails, alternatives } = matchResult;\n\n  if (drug && confidence >= 0.45) {\n    const alternativeDrugs = alternatives.map(alt => alt.drug);\n    \n    const enhancedConfidence = matchDetails.imprintExact \n      ? Math.min(confidence + 0.2, 0.98)\n      : Math.min(confidence + 0.1, 0.95);\n\n    return {\n      medication: drug,\n      confidence: enhancedConfidence,\n      warnings: drug.warnings,\n      alternatives: alternativeDrugs.length > 0 \n        ? alternativeDrugs \n        : SAMPLE_DRUGS.filter(d => d.category === drug.category && d.id !== drug.id).slice(0, 3),\n      analysisMethod: matchDetails.imprintExact ? \"database\" : \"ai\",\n      matchDetails: {\n        shape: matchDetails.shape,\n        color: matchDetails.color,\n        imprint: matchDetails.imprint,\n      },\n    };\n  }\n\n  const allDrugs = [...SAMPLE_DRUGS, ...(COMPREHENSIVE_DRUG_DATABASE || [])];\n  const shapeCandidates = allDrugs.filter(\n    d => d.shape.toLowerCase() === features.shape.toLowerCase()\n  );\n  \n  const fallbackDrug = shapeCandidates.length > 0\n    ? shapeCandidates[Math.floor(Math.random() * shapeCandidates.length)]\n    : SAMPLE_DRUGS[Math.floor(Math.random() * SAMPLE_DRUGS.length)];\n\n  return {\n    medication: fallbackDrug,\n    confidence: 0.55 + Math.random() * 0.2,\n    warnings: [...fallbackDrug.warnings, \"Low confidence match - please verify with pharmacist\"],\n    alternatives: SAMPLE_DRUGS.filter(\n      d => d.category === fallbackDrug.category && d.id !== fallbackDrug.id\n    ).slice(0, 3),\n    analysisMethod: \"visual\",\n    matchDetails: {\n      shape: true,\n      color: features.color.toLowerCase() === fallbackDrug.color.toLowerCase(),\n      imprint: false,\n    },\n  };\n}\n\n\nexport async function checkDrugInteractionsAI(medications: string[]): Promise<DrugInteractionAIResult> {\n  const localInteractions = checkInteractions(medications);\n\n  const allInteractions = [...EXTENDED_INTERACTIONS, ...localInteractions];\n  const uniqueInteractions = allInteractions.filter((interaction, index, self) =>\n    index === self.findIndex((i) =>\n      (i.drug1 === interaction.drug1 && i.drug2 === interaction.drug2) ||\n      (i.drug1 === interaction.drug2 && i.drug2 === interaction.drug1)\n    )\n  );\n\n  const relevantInteractions = uniqueInteractions.filter((interaction) => {\n    const medsLower = medications.map((m) => m.toLowerCase());\n    return medsLower.some((med) =>\n      interaction.drug1.toLowerCase().includes(med) ||\n      interaction.drug2.toLowerCase().includes(med) ||\n      med.includes(interaction.drug1.toLowerCase()) ||\n      med.includes(interaction.drug2.toLowerCase())\n    );\n  });\n\n  const systemPrompt = `You are a clinical pharmacist AI assistant specialized in drug-drug interactions. \nAnalyze the provided medications for potential interactions, contraindications, and safety concerns.\nAlways provide evidence-based information with clinical significance.\nFormat your response as JSON with: summary (string), recommendations (array of strings), and riskLevel (one of: low, moderate, high, critical).\nKeep responses concise and actionable.`;\n\n  const prompt = `Analyze these medications for interactions: ${medications.join(\", \")}\nKnown interactions from database: ${JSON.stringify(relevantInteractions.slice(0, 5))}\nProvide a comprehensive safety analysis in JSON format.`;\n\n  const aiResponse = await callGroqAPI(prompt, systemPrompt);\n\n  if (aiResponse) {\n    try {\n      const jsonMatch = aiResponse.match(/\\{[\\s\\S]*\\}/);\n      if (jsonMatch) {\n        const parsed = JSON.parse(jsonMatch[0]);\n        return {\n          interactions: relevantInteractions,\n          summary: parsed.summary || \"AI analysis completed.\",\n          recommendations: parsed.recommendations || extractRecommendations(aiResponse),\n          riskLevel: parsed.riskLevel || determineRiskLevel(relevantInteractions),\n          aiGenerated: true,\n        };\n      }\n    } catch {\n      return {\n        interactions: relevantInteractions,\n        summary: aiResponse.substring(0, 500),\n        recommendations: extractRecommendations(aiResponse),\n        riskLevel: determineRiskLevel(relevantInteractions),\n        aiGenerated: true,\n      };\n    }\n  }\n\n  return generateLocalInteractionAnalysis(medications, relevantInteractions);\n}\n\nfunction extractRecommendations(text: string): string[] {\n  const recommendations: string[] = [];\n  const lines = text.split(\"\\n\");\n  \n  for (const line of lines) {\n    if (line.match(/^[\\d\\-\\*\\.]+\\s/) || line.toLowerCase().includes(\"recommend\")) {\n      recommendations.push(line.replace(/^[\\d\\-\\*\\.]+\\s*/, \"\").trim());\n    }\n  }\n  \n  return recommendations.length > 0 ? recommendations : [\n    \"Consult your healthcare provider about these medications\",\n    \"Do not stop any medications without medical advice\",\n    \"Report any unusual symptoms to your doctor\"\n  ];\n}\n\nfunction determineRiskLevel(interactions: DrugInteraction[]): \"low\" | \"moderate\" | \"high\" | \"critical\" {\n  const majorCount = interactions.filter((i) => i.severity === \"major\").length;\n  const moderateCount = interactions.filter((i) => i.severity === \"moderate\").length;\n\n  if (majorCount >= 2) return \"critical\";\n  if (majorCount === 1) return \"high\";\n  if (moderateCount >= 2) return \"moderate\";\n  return \"low\";\n}\n\nfunction generateLocalInteractionAnalysis(\n  medications: string[],\n  interactions: DrugInteraction[]\n): DrugInteractionAIResult {\n  const majorCount = interactions.filter((i) => i.severity === \"major\").length;\n  const moderateCount = interactions.filter((i) => i.severity === \"moderate\").length;\n  const minorCount = interactions.filter((i) => i.severity === \"minor\").length;\n\n  let summary: string;\n  const recommendations: string[] = [];\n\n  if (interactions.length === 0) {\n    summary = `Analysis of ${medications.length} medication(s) found no known drug interactions in our database. However, always consult your healthcare provider for personalized advice.`;\n    recommendations.push(\"Continue taking your medications as prescribed\");\n    recommendations.push(\"Always inform your healthcare provider of all medications you take\");\n    recommendations.push(\"Watch for any unusual symptoms and report them promptly\");\n  } else {\n    summary = `Found ${interactions.length} potential interaction(s) between your medications: ${majorCount} major, ${moderateCount} moderate, ${minorCount} minor.`;\n\n    if (majorCount > 0) {\n      recommendations.push(\"IMPORTANT: Major interactions detected - consult your healthcare provider immediately\");\n      recommendations.push(\"Do not stop medications without professional guidance\");\n    }\n\n    if (moderateCount > 0) {\n      recommendations.push(\"Monitor for side effects and discuss with your pharmacist\");\n    }\n\n    recommendations.push(\"Keep a complete list of all medications to show healthcare providers\");\n    recommendations.push(\"Consider timing adjustments if recommended for specific interactions\");\n  }\n\n  return {\n    interactions,\n    summary,\n    recommendations,\n    riskLevel: determineRiskLevel(interactions),\n    aiGenerated: false,\n  };\n}\n\nfunction calculateIsolationForestScore(price: number, marketPrices: number[]): number {\n  if (marketPrices.length < 2) return 0;\n\n  const mean = marketPrices.reduce((a, b) => a + b, 0) / marketPrices.length;\n  const variance = marketPrices.reduce((sum, p) => sum + Math.pow(p - mean, 2), 0) / marketPrices.length;\n  const stdDev = Math.sqrt(variance);\n\n  if (stdDev === 0) return 0;\n\n  const zScore = Math.abs((price - mean) / stdDev);\n  const anomalyScore = 1 / (1 + Math.exp(-zScore + 2));\n\n  return anomalyScore;\n}\n\nfunction detectAnomalies(prices: number[]): { scores: number[]; threshold: number } {\n  const mean = prices.reduce((a, b) => a + b, 0) / prices.length;\n  const sortedPrices = [...prices].sort((a, b) => a - b);\n  const q1 = sortedPrices[Math.floor(prices.length * 0.25)];\n  const q3 = sortedPrices[Math.floor(prices.length * 0.75)];\n  const iqr = q3 - q1;\n  \n  const scores = prices.map((price) => {\n    const deviation = Math.abs(price - mean) / mean;\n    const isOutlier = price < (q1 - 1.5 * iqr) || price > (q3 + 1.5 * iqr);\n    \n    let score = deviation;\n    if (isOutlier) score += 0.3;\n    if (price < mean * 0.3) score += 0.4;\n    \n    return Math.min(score, 1);\n  });\n\n  return { scores, threshold: 0.5 };\n}\n\nexport async function detectPriceAnomalies(drugName: string): Promise<PriceInfo[]> {\n  await new Promise((resolve) => setTimeout(resolve, 600));\n\n  let genericName = drugName\n    .replace(/\\s*\\d+\\s*(mg|mcg|ml|g)\\s*/gi, \"\")\n    .replace(/\\s*\\d+\\/\\d+\\s*(mg|mcg|ml|g)?\\s*/gi, \"\")\n    .trim();\n  \n  let priceData = getDrugPriceByGeneric(genericName);\n  \n  if (!priceData) {\n    const words = drugName.split(/\\s+/);\n    for (const word of words) {\n      priceData = getDrugPriceByGeneric(word);\n      if (priceData) {\n        genericName = word;\n        break;\n      }\n    }\n  }\n  \n  const basePrice = priceData ? priceData.averagePrice : (18 + Math.random() * 25);\n  \n  const pharmacyPrices = [\n    { name: \"HealthPlus Pharmacy\", price: basePrice * (0.95 + Math.random() * 0.1), distance: \"0.3 km\", verified: true },\n    { name: \"MediCare Central\", price: basePrice * (0.9 + Math.random() * 0.15), distance: \"0.8 km\", verified: true },\n    { name: \"QuickMeds Pharmacy\", price: basePrice * (0.85 + Math.random() * 0.2), distance: \"1.2 km\", verified: true },\n    { name: \"Budget Meds Online\", price: basePrice * 0.25, distance: \"Online\", verified: false },\n    { name: \"City Pharmacy\", price: basePrice * (0.92 + Math.random() * 0.12), distance: \"1.5 km\", verified: true },\n  ];\n\n  const pharmacies: PriceInfo[] = pharmacyPrices.map((pharmacy) => {\n    const anomalyResult = detectPriceAnomaly(genericName, pharmacy.price);\n    \n    const isSuspicious = anomalyResult.riskLevel === \"warning\" || anomalyResult.riskLevel === \"danger\";\n    \n    return {\n      pharmacyName: pharmacy.name,\n      price: pharmacy.price,\n      distance: pharmacy.distance,\n      isVerified: pharmacy.verified,\n      isSuspicious,\n      suspicionReason: isSuspicious ? anomalyResult.message : undefined,\n      anomalyScore: anomalyResult.anomalyScore,\n      priceAnomalyDetails: {\n        riskLevel: anomalyResult.riskLevel,\n        anomalyType: anomalyResult.anomalyType,\n        recommendation: anomalyResult.recommendation,\n        expectedRange: anomalyResult.priceAnalysis.expectedRange,\n        zScore: anomalyResult.priceAnalysis.zScore,\n      },\n    };\n  });\n\n  return pharmacies.sort((a, b) => {\n    if (a.isSuspicious !== b.isSuspicious) return a.isSuspicious ? 1 : -1;\n    return a.price - b.price;\n  });\n}\n\nconst VOICE_INTENTS = {\n  scan: [\"scan\", \"identify\", \"pill\", \"medicine\", \"drug\", \"what is\", \"recognize\"],\n  interaction: [\"interaction\", \"mix\", \"combine\", \"together\", \"conflict\", \"safe to take\"],\n  pharmacy: [\"pharmacy\", \"buy\", \"where\", \"near\", \"store\", \"purchase\", \"find\"],\n  reminder: [\"remind\", \"alarm\", \"schedule\", \"when\", \"time\", \"dose\"],\n  help: [\"help\", \"how\", \"what can\", \"guide\", \"assist\"],\n  pain: [\"pain\", \"headache\", \"ache\", \"hurt\", \"sore\"],\n  emergency: [\"emergency\", \"overdose\", \"poison\", \"urgent\", \"911\"],\n  sideeffects: [\"side effect\", \"effects\", \"symptoms\", \"reaction\", \"adverse\", \"ibuprofen\", \"acetaminophen\", \"aspirin\", \"metformin\"],\n  pregnancy: [\"pregnant\", \"pregnancy\", \"breastfeeding\", \"nursing\", \"expecting\"],\n};\n\nfunction detectIntent(query: string): { intent: string; confidence: number } {\n  const queryLower = query.toLowerCase();\n  let bestIntent = \"general\";\n  let bestScore = 0;\n\n  for (const [intent, keywords] of Object.entries(VOICE_INTENTS)) {\n    const matches = keywords.filter((kw) => queryLower.includes(kw)).length;\n    const score = matches / keywords.length;\n\n    if (score > bestScore) {\n      bestScore = score;\n      bestIntent = intent;\n    }\n  }\n\n  return { intent: bestIntent, confidence: Math.min(bestScore * 2, 1) };\n}\n\nconst RESPONSES: Record<string, Record<string, string>> = {\n  scan: {\n    en: \"To identify a medication, tap the Scan button at the bottom of the screen. Point your camera at the pill, and our AI will analyze its shape, color, and markings to identify it. You can also choose a photo from your gallery.\",\n    uz: \"Dori-darmonni aniqlash uchun ekranning pastki qismidagi Skanerlash tugmasini bosing. Kamerangizni tabletkaga qarating va bizning sun'iy intellekt uning shakli, rangi va belgilarini tahlil qiladi.\",\n    ru: \"Чтобы идентифицировать лекарство, нажмите кнопку Сканировать внизу экрана. Наведите камеру на таблетку, и наш ИИ проанализирует её форму, цвет и маркировку.\",\n  },\n  interaction: {\n    en: \"To check drug interactions, go to the Interactions tab. Add all your medications, and our AI powered by Llama 3.1 will analyze them for potential conflicts, warnings, and provide safety recommendations.\",\n    uz: \"Dori-darmonlarning o'zaro ta'sirini tekshirish uchun Interaksiyalar bo'limiga o'ting. Barcha dorilaringizni qo'shing va Llama 3.1 asosidagi sun'iy intellektimiz ularni tahlil qiladi.\",\n    ru: \"Чтобы проверить взаимодействия лекарств, перейдите на вкладку Взаимодействия. Добавьте все ваши лекарства, и наш ИИ на базе Llama 3.1 проанализирует их на возможные конфликты.\",\n  },\n  pharmacy: {\n    en: \"I can help you find nearby pharmacies. Go to the Pharmacy tab to see verified pharmacies on the map, compare prices, and get directions. We also detect suspiciously low prices that may indicate counterfeit medications.\",\n    uz: \"Yaqin atrofdagi dorixonalarni topishda yordam bera olaman. Xaritada tasdiqlangan dorixonalarni ko'rish uchun Dorixona bo'limiga o'ting. Soxta dorilarni ko'rsatishi mumkin bo'lgan shubhali past narxlarni ham aniqlaymiz.\",\n    ru: \"Я могу помочь найти ближайшие аптеки. Перейдите на вкладку Аптеки, чтобы увидеть проверенные аптеки на карте, сравнить цены и проложить маршрут.\",\n  },\n  reminder: {\n    en: \"You can set medication reminders in the Reminders section. Add your medication, choose the time and frequency, and I will help you track your adherence with notifications and a visual calendar.\",\n    uz: \"Eslatmalar bo'limida dori eslatmalarini o'rnatishingiz mumkin. Dori nomini qo'shing, vaqt va chastotani tanlang, va men sizga eslatmalar va vizual taqvim bilan yordamlashaman.\",\n    ru: \"Вы можете установить напоминания о приёме лекарств в разделе Напоминания. Добавьте лекарство, выберите время и частоту, и я помогу вам отслеживать приём.\",\n  },\n  pain: {\n    en: \"For general pain relief, common over-the-counter options include acetaminophen or ibuprofen. Always follow package dosage instructions. For headaches lasting more than 3 days, severe pain, or if you have other health conditions, please consult a healthcare provider.\",\n    uz: \"Umumiy og'riqni kamaytirish uchun paratsetamol yoki ibuprofen qabul qilishingiz mumkin. Har doim qadoqdagi dozalash ko'rsatmalariga rioya qiling. 3 kundan ortiq davom etadigan bosh og'rig'i uchun shifokorga murojaat qiling.\",\n    ru: \"Для облегчения боли можно принять парацетамол или ибупрофен. Всегда следуйте инструкции по дозировке. При головной боли более 3 дней или сильной боли обратитесь к врачу.\",\n  },\n  emergency: {\n    en: \"If you suspect a medical emergency, overdose, or poisoning, please call emergency services immediately (911 in the US). Do not wait. For poison control in the US, call 1-800-222-1222. This app cannot provide emergency medical care.\",\n    uz: \"Agar favqulodda tibbiy holat, dozadan oshib ketish yoki zaharlanishdan shubhalansangiz, darhol tez yordam xizmatiga qo'ng'iroq qiling. Kutmang. Ushbu ilova favqulodda tibbiy yordam ko'rsata olmaydi.\",\n    ru: \"При подозрении на неотложную медицинскую ситуацию, передозировку или отравление немедленно вызовите скорую помощь. Не ждите. Это приложение не может оказать экстренную медицинскую помощь.\",\n  },\n  sideeffects: {\n    en: \"Common side effects of NSAIDs like ibuprofen include stomach upset, nausea, dizziness, and headache. More serious but rare effects include stomach bleeding and kidney problems. For acetaminophen, watch for liver-related symptoms. Always take medications as directed and consult your healthcare provider if you experience concerning symptoms. You can scan a pill to see its specific side effects.\",\n    uz: \"Ibuprofen kabi NSAIDlarning yon ta'sirlari oshqozon bezovtaligi, ko'ngil aynish, bosh aylanishi va bosh og'rig'ini o'z ichiga oladi. Har doim dorilarni ko'rsatmalarga muvofiq qabul qiling va xavotirli alomatlar paydo bo'lsa shifokorga murojaat qiling.\",\n    ru: \"Частые побочные эффекты НПВС, таких как ибупрофен, включают расстройство желудка, тошноту, головокружение и головную боль. Более серьёзные, но редкие эффекты включают желудочное кровотечение. Всегда принимайте лекарства согласно инструкции и консультируйтесь с врачом при появлении симптомов.\",\n  },\n  pregnancy: {\n    en: \"Medication safety during pregnancy varies. Category A and B medications are generally considered safe, while Category D and X should be avoided. Always consult your OB-GYN before taking any medication. Scan a medication to check its pregnancy category and safety information.\",\n    uz: \"Homiladorlik davrida dori xavfsizligi turlicha. A va B toifasidagi dorilar odatda xavfsiz hisoblanadi, D va X toifalaridagidan saqlanish kerak. Har qanday dori qabul qilishdan oldin OB-GYN bilan maslahatlashing.\",\n    ru: \"Безопасность лекарств при беременности различается. Препараты категорий A и B обычно считаются безопасными, а категорий D и X следует избегать. Всегда консультируйтесь с акушером-гинекологом перед приёмом любых лекарств.\",\n  },\n  help: {\n    en: \"I can help you with: scanning and identifying pills, checking drug interactions, finding nearby pharmacies, setting medication reminders, and answering health questions. Just ask me what you need!\",\n    uz: \"Men sizga quyidagilarda yordam bera olaman: tabletkalarni skanerlash va aniqlash, dorilarning o'zaro ta'sirini tekshirish, yaqin atrofdagi dorixonalarni topish, dori eslatmalarini sozlash. Nima kerakligini so'rang!\",\n    ru: \"Я могу помочь вам: сканировать и идентифицировать таблетки, проверять взаимодействия лекарств, находить ближайшие аптеки, устанавливать напоминания. Просто спросите, что вам нужно!\",\n  },\n  general: {\n    en: \"I'm your MediScan AI assistant. I can help you identify pills by scanning, check drug interactions, find pharmacies, set reminders, and answer medication questions. What would you like to do?\",\n    uz: \"Men MediScan AI yordamchisiman. Tabletkalarni skanerlash orqali aniqlash, dorilarning o'zaro ta'sirini tekshirish, dorixonalarni topish va savollaringizga javob berishda yordam beraman. Nima qilishni xohlaysiz?\",\n    ru: \"Я ваш помощник MediScan AI. Я могу помочь идентифицировать таблетки, проверить взаимодействия лекарств, найти аптеки и ответить на вопросы о лекарствах. Что бы вы хотели сделать?\",\n  },\n};\n\nexport async function processVoiceQuery(\n  query: string,\n  language: \"en\" | \"uz\" | \"ru\"\n): Promise<VoiceResponse> {\n  const { intent, confidence } = detectIntent(query);\n\n  const languageNames = { en: \"English\", uz: \"Uzbek\", ru: \"Russian\" };\n  const systemPrompt = `You are MediScan AI, a helpful medication assistant that speaks ${languageNames[language]}. \nYou help users with:\n- Identifying pills and medications\n- Checking drug interactions\n- Finding pharmacies\n- Setting medication reminders\n- Answering health questions\n\nProvide concise, accurate health information in ${languageNames[language]}. \nAlways recommend consulting healthcare providers for serious concerns.\nKeep responses under 100 words. Be warm and helpful.`;\n\n  const aiResponse = await callGroqAPI(query, systemPrompt);\n\n  if (aiResponse) {\n    return {\n      text: aiResponse,\n      language,\n      intent,\n      confidence: 0.95,\n      usedLocalFallback: false,\n    };\n  }\n\n  const response = RESPONSES[intent]?.[language] || RESPONSES.general[language];\n\n  return {\n    text: response,\n    language,\n    intent,\n    confidence,\n    usedLocalFallback: true,\n  };\n}\n\nexport function getGreeting(name: string, language: \"en\" | \"uz\" | \"ru\"): string {\n  const hour = new Date().getHours();\n\n  if (language === \"uz\") {\n    if (hour < 12) return `Xayrli tong, ${name}`;\n    if (hour < 18) return `Xayrli kun, ${name}`;\n    return `Xayrli kech, ${name}`;\n  } else if (language === \"ru\") {\n    if (hour < 12) return `Доброе утро, ${name}`;\n    if (hour < 18) return `Добрый день, ${name}`;\n    return `Добрый вечер, ${name}`;\n  } else {\n    if (hour < 12) return `Good morning, ${name}`;\n    if (hour < 18) return `Good afternoon, ${name}`;\n    return `Good evening, ${name}`;\n  }\n}\n\nexport interface TTSOptions {\n  language: \"en\" | \"uz\" | \"ru\";\n  pitch?: number;\n  rate?: number;\n  onStart?: () => void;\n  onDone?: () => void;\n  onError?: (error: string) => void;\n}\n\nconst LANGUAGE_VOICE_MAP: Record<\"en\" | \"uz\" | \"ru\", string> = {\n  en: \"en-US\",\n  uz: \"uz-UZ\",\n  ru: \"ru-RU\",\n};\n\nexport async function speakText(text: string, options: TTSOptions): Promise<void> {\n  try {\n    const Speech = require(\"expo-speech\");\n    \n    const availableVoices = await Speech.getAvailableVoicesAsync();\n    \n    const langCode = LANGUAGE_VOICE_MAP[options.language];\n    let selectedVoice = availableVoices.find(\n      (voice: { language: string }) => voice.language.startsWith(langCode.split(\"-\")[0])\n    );\n    \n    if (options.language === \"uz\" && !selectedVoice) {\n      selectedVoice = availableVoices.find(\n        (voice: { language: string }) => voice.language.startsWith(\"tr\") || voice.language.startsWith(\"en\")\n      );\n    }\n    \n    await Speech.speak(text, {\n      language: langCode,\n      pitch: options.pitch || 1.0,\n      rate: options.rate || 0.9,\n      voice: selectedVoice?.identifier,\n      onStart: options.onStart,\n      onDone: options.onDone,\n      onError: options.onError,\n    });\n  } catch (error) {\n    console.error(\"TTS error:\", error);\n    options.onError?.(\"Speech synthesis failed\");\n  }\n}\n\nexport async function stopSpeaking(): Promise<void> {\n  try {\n    const Speech = require(\"expo-speech\");\n    await Speech.stop();\n  } catch (error) {\n    console.error(\"Stop speech error:\", error);\n  }\n}\n\nexport async function isSpeaking(): Promise<boolean> {\n  try {\n    const Speech = require(\"expo-speech\");\n    return await Speech.isSpeakingAsync();\n  } catch (error) {\n    return false;\n  }\n}\n\nexport interface STTResult {\n  text: string;\n  confidence: number;\n  language: \"en\" | \"uz\" | \"ru\";\n  isSimulated: boolean;\n}\n\nconst SAMPLE_VOICE_QUERIES: Record<\"en\" | \"uz\" | \"ru\", string[]> = {\n  en: [\n    \"What is this pill?\",\n    \"Check interactions between ibuprofen and aspirin\",\n    \"Find nearby pharmacies\",\n    \"Set a reminder for my medication\",\n    \"Is acetaminophen safe during pregnancy?\",\n    \"What are the side effects of metformin?\",\n    \"Help me identify this medicine\",\n  ],\n  uz: [\n    \"Bu qanday tabletka?\",\n    \"Dorixonalarni toping\",\n    \"Dori eslatmasini o'rnating\",\n    \"Ibuprofen va aspirin o'rtasidagi o'zaro ta'sirni tekshiring\",\n  ],\n  ru: [\n    \"Что это за таблетка?\",\n    \"Найти ближайшие аптеки\",\n    \"Установить напоминание о лекарстве\",\n    \"Проверить взаимодействие ибупрофена и аспирина\",\n  ],\n};\n\nexport function simulateFasterWhisperSTT(language: \"en\" | \"uz\" | \"ru\"): STTResult {\n  const queries = SAMPLE_VOICE_QUERIES[language];\n  const randomQuery = queries[Math.floor(Math.random() * queries.length)];\n  \n  const confidence = 0.85 + Math.random() * 0.14;\n  \n  return {\n    text: randomQuery,\n    confidence,\n    language,\n    isSimulated: true,\n  };\n}\n\nexport function generatePersonalizedSafetyAlerts(\n  drug: DrugInfo,\n  profile: {\n    age?: number;\n    isPregnant?: boolean;\n    allergies: string[];\n    chronicConditions: string[];\n  }\n): SafetyAlert[] {\n  const alerts: SafetyAlert[] = [];\n\n  if (profile.isPregnant) {\n    if (drug.pregnancyCategory === \"D\" || drug.pregnancyCategory === \"X\") {\n      alerts.push({\n        type: \"pregnancy\",\n        severity: \"critical\",\n        message: `${drug.name} is contraindicated during pregnancy (Category ${drug.pregnancyCategory})`,\n        drug: drug.name,\n        recommendation: \"Do not take this medication. Consult your OB-GYN for safe alternatives immediately.\",\n      });\n    } else if (drug.pregnancyCategory === \"C\") {\n      alerts.push({\n        type: \"pregnancy\",\n        severity: \"warning\",\n        message: `${drug.name} should be used with caution during pregnancy (Category C)`,\n        drug: drug.name,\n        recommendation: \"Discuss risks and benefits with your healthcare provider before use.\",\n      });\n    }\n  }\n\n  for (const allergy of profile.allergies) {\n    const allergyLower = allergy.toLowerCase();\n    const drugLower = drug.genericName.toLowerCase();\n    const drugNameLower = drug.name.toLowerCase();\n\n    if (drugLower.includes(allergyLower) || drugNameLower.includes(allergyLower) ||\n        allergyLower.includes(drugLower)) {\n      alerts.push({\n        type: \"allergy\",\n        severity: \"critical\",\n        message: `You have a documented allergy to ${allergy}, which may be related to ${drug.name}`,\n        drug: drug.name,\n        recommendation: \"Do not take this medication. Seek an alternative from your healthcare provider.\",\n      });\n    }\n\n    if (allergyLower.includes(\"nsaid\") && drug.category === \"NSAID\") {\n      alerts.push({\n        type: \"allergy\",\n        severity: \"critical\",\n        message: `You have an NSAID allergy. ${drug.name} is an NSAID medication.`,\n        drug: drug.name,\n        recommendation: \"Avoid this medication. Consider acetaminophen as an alternative after consulting your doctor.\",\n      });\n    }\n\n    if (allergyLower.includes(\"penicillin\") && drug.category === \"Antibiotic\" &&\n        (drugLower.includes(\"amox\") || drugLower.includes(\"ampicillin\"))) {\n      alerts.push({\n        type: \"allergy\",\n        severity: \"critical\",\n        message: `You have a penicillin allergy. ${drug.name} may cause a cross-reaction.`,\n        drug: drug.name,\n        recommendation: \"Avoid this medication. Your doctor can prescribe a non-penicillin antibiotic.\",\n      });\n    }\n  }\n\n  if (profile.age) {\n    if (profile.age >= 65) {\n      if (drug.category === \"NSAID\") {\n        alerts.push({\n          type: \"age\",\n          severity: \"warning\",\n          message: `NSAIDs like ${drug.name} carry increased bleeding risk for adults over 65`,\n          drug: drug.name,\n          recommendation: \"Use the lowest effective dose for the shortest duration. Consider acetaminophen instead.\",\n        });\n      }\n\n      if (drug.sideEffects.some((se) => se.toLowerCase().includes(\"dizziness\"))) {\n        alerts.push({\n          type: \"age\",\n          severity: \"info\",\n          message: `${drug.name} may cause dizziness, increasing fall risk`,\n          drug: drug.name,\n          recommendation: \"Rise slowly from sitting or lying positions. Avoid driving until you know how this affects you.\",\n        });\n      }\n    }\n\n    if (profile.age < 18 && drug.category === \"NSAID\" && drug.genericName.toLowerCase().includes(\"aspirin\")) {\n      alerts.push({\n        type: \"age\",\n        severity: \"critical\",\n        message: \"Aspirin should not be given to children due to risk of Reye's syndrome\",\n        drug: drug.name,\n        recommendation: \"Use acetaminophen or ibuprofen instead for children. Consult a pediatrician.\",\n      });\n    }\n  }\n\n  for (const condition of profile.chronicConditions) {\n    const condLower = condition.toLowerCase();\n\n    if (condLower.includes(\"kidney\") || condLower.includes(\"renal\")) {\n      if (drug.category === \"NSAID\") {\n        alerts.push({\n          type: \"condition\",\n          severity: \"warning\",\n          message: `NSAIDs like ${drug.name} may worsen kidney function`,\n          drug: drug.name,\n          recommendation: \"Use with caution and stay well-hydrated. Your doctor should monitor kidney function.\",\n        });\n      }\n      if (drug.genericName.toLowerCase().includes(\"metformin\")) {\n        alerts.push({\n          type: \"condition\",\n          severity: \"warning\",\n          message: `Metformin requires dose adjustment with kidney disease`,\n          drug: drug.name,\n          recommendation: \"Ensure your doctor knows your kidney function. Regular monitoring is required.\",\n        });\n      }\n    }\n\n    if (condLower.includes(\"liver\") || condLower.includes(\"hepat\")) {\n      if (drug.genericName.toLowerCase().includes(\"acetaminophen\")) {\n        alerts.push({\n          type: \"condition\",\n          severity: \"warning\",\n          message: `Acetaminophen may worsen liver condition if used excessively`,\n          drug: drug.name,\n          recommendation: \"Do not exceed 2000mg daily with liver disease. Avoid alcohol completely.\",\n        });\n      }\n    }\n\n    if (condLower.includes(\"asthma\")) {\n      if (drug.category === \"NSAID\") {\n        alerts.push({\n          type: \"condition\",\n          severity: \"warning\",\n          message: `NSAIDs can trigger asthma attacks in some patients`,\n          drug: drug.name,\n          recommendation: \"If you have aspirin-sensitive asthma, avoid all NSAIDs including this one.\",\n        });\n      }\n    }\n\n    if (condLower.includes(\"diabetes\")) {\n      if (drug.genericName.toLowerCase().includes(\"prednisone\") ||\n          drug.genericName.toLowerCase().includes(\"steroid\")) {\n        alerts.push({\n          type: \"condition\",\n          severity: \"warning\",\n          message: `Corticosteroids can raise blood sugar levels`,\n          drug: drug.name,\n          recommendation: \"Monitor blood sugar more frequently while taking this medication.\",\n        });\n      }\n    }\n  }\n\n  return alerts;\n}\n\nexport const CURRENCY_RATES: Record<string, number> = {\n  USD: 1,\n  UZS: 12400,\n  RUB: 92,\n  EUR: 0.92,\n  GBP: 0.79,\n  KZT: 450,\n  TRY: 32,\n};\n\nexport function convertCurrency(\n  amount: number,\n  fromCurrency: string,\n  toCurrency: string\n): number {\n  const inUSD = amount / (CURRENCY_RATES[fromCurrency] || 1);\n  return inUSD * (CURRENCY_RATES[toCurrency] || 1);\n}\n\nexport function formatPrice(amount: number, currency: string): string {\n  const symbols: Record<string, string> = {\n    USD: \"$\",\n    UZS: \"so'm\",\n    RUB: \"₽\",\n    EUR: \"€\",\n    GBP: \"£\",\n    KZT: \"₸\",\n    TRY: \"₺\",\n  };\n\n  const symbol = symbols[currency] || currency;\n\n  if (currency === \"UZS\" || currency === \"KZT\") {\n    return `${Math.round(amount).toLocaleString()} ${symbol}`;\n  }\n\n  return `${symbol}${amount.toFixed(2)}`;\n}\n","path":null,"size_bytes":49289,"size_tokens":null},"components/ScreenFlatList.tsx":{"content":"import React from \"react\";\nimport { FlatList, FlatListProps, StyleSheet } from \"react-native\";\n\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useScreenInsets } from \"@/hooks/useScreenInsets\";\nimport { Spacing } from \"@/constants/theme\";\n\nexport function ScreenFlatList<T>({\n  contentContainerStyle,\n  style,\n  ...flatListProps\n}: FlatListProps<T>) {\n  const { theme } = useTheme();\n  const { paddingTop, paddingBottom, scrollInsetBottom } = useScreenInsets();\n\n  return (\n    <FlatList\n      style={[\n        styles.container,\n        { backgroundColor: theme.backgroundRoot },\n        style,\n      ]}\n      contentContainerStyle={[\n        {\n          paddingTop,\n          paddingBottom,\n        },\n        styles.contentContainer,\n        contentContainerStyle,\n      ]}\n      scrollIndicatorInsets={{ bottom: scrollInsetBottom }}\n      {...flatListProps}\n    />\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  contentContainer: {\n    paddingHorizontal: Spacing.xl,\n  },\n});\n","path":null,"size_bytes":1016,"size_tokens":null},"components/Card.tsx":{"content":"import React, { ReactNode } from \"react\";\nimport { StyleSheet, ViewStyle, StyleProp, View } from \"react-native\";\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n  WithSpringConfig,\n} from \"react-native-reanimated\";\nimport { Pressable } from \"react-native\";\n\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\n\ninterface CardProps {\n  children?: ReactNode;\n  elevation?: number;\n  onPress?: () => void;\n  style?: StyleProp<ViewStyle>;\n}\n\nconst springConfig: WithSpringConfig = {\n  damping: 15,\n  mass: 0.3,\n  stiffness: 150,\n  overshootClamping: true,\n  energyThreshold: 0.001,\n};\n\nconst getBackgroundColorForElevation = (\n  elevation: number,\n  theme: any,\n): string => {\n  switch (elevation) {\n    case 1:\n      return theme.backgroundDefault;\n    case 2:\n      return theme.backgroundSecondary;\n    case 3:\n      return theme.backgroundTertiary;\n    default:\n      return theme.cardBackground;\n  }\n};\n\nconst AnimatedPressable = Animated.createAnimatedComponent(Pressable);\n\nexport function Card({ children, elevation = 1, onPress, style }: CardProps) {\n  const { theme } = useTheme();\n  const scale = useSharedValue(1);\n\n  const cardBackgroundColor = getBackgroundColorForElevation(elevation, theme);\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const handlePressIn = () => {\n    if (onPress) {\n      scale.value = withSpring(0.98, springConfig);\n    }\n  };\n\n  const handlePressOut = () => {\n    if (onPress) {\n      scale.value = withSpring(1, springConfig);\n    }\n  };\n\n  if (onPress) {\n    return (\n      <AnimatedPressable\n        onPress={onPress}\n        onPressIn={handlePressIn}\n        onPressOut={handlePressOut}\n        style={[\n          styles.card,\n          {\n            backgroundColor: cardBackgroundColor,\n          },\n          animatedStyle,\n          style,\n        ]}\n      >\n        {children}\n      </AnimatedPressable>\n    );\n  }\n\n  return (\n    <View\n      style={[\n        styles.card,\n        {\n          backgroundColor: cardBackgroundColor,\n        },\n        style,\n      ]}\n    >\n      {children}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  card: {\n    padding: Spacing.xl,\n    borderRadius: BorderRadius[\"2xl\"],\n  },\n});\n","path":null,"size_bytes":2303,"size_tokens":null},"navigation/screenOptions.ts":{"content":"import { Platform } from \"react-native\";\nimport { NativeStackNavigationOptions } from \"@react-navigation/native-stack\";\nimport { isLiquidGlassAvailable } from \"expo-glass-effect\";\n\ninterface ScreenOptionsParams {\n  theme: {\n    backgroundRoot: string;\n    text: string;\n  };\n  isDark: boolean;\n  transparent?: boolean;\n}\n\nexport const getCommonScreenOptions = ({\n  theme,\n  isDark,\n  transparent = true,\n}: ScreenOptionsParams): NativeStackNavigationOptions => ({\n  headerTitleAlign: \"center\",\n  headerTransparent: transparent,\n  headerBlurEffect: isDark ? \"dark\" : \"light\",\n  headerTintColor: theme.text,\n  headerStyle: {\n    backgroundColor: Platform.select({\n      ios: undefined,\n      android: theme.backgroundRoot,\n      web: theme.backgroundRoot,\n    }),\n  },\n  gestureEnabled: true,\n  gestureDirection: \"horizontal\",\n  fullScreenGestureEnabled: isLiquidGlassAvailable() ? false : true,\n  contentStyle: {\n    backgroundColor: theme.backgroundRoot,\n  },\n});\n","path":null,"size_bytes":964,"size_tokens":null},"screens/DetailScreen.tsx":{"content":"import { StyleSheet } from \"react-native\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { ThemedText } from \"@/components/ThemedText\";\n\nexport default function DetailScreen() {\n  return (\n    <ScreenScrollView contentContainerStyle={styles.scrollContent}>\n      <ThemedText type=\"body\">Your detail screen</ThemedText>\n    </ScreenScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  scrollContent: {\n    flexGrow: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n});\n","path":null,"size_bytes":514,"size_tokens":null},"components/ErrorBoundary.tsx":{"content":"import React, { Component, ComponentType, PropsWithChildren } from \"react\";\nimport { ErrorFallback, ErrorFallbackProps } from \"@/components/ErrorFallback\";\n\nexport type ErrorBoundaryProps = PropsWithChildren<{\n  FallbackComponent?: ComponentType<ErrorFallbackProps>;\n  onError?: (error: Error, stackTrace: string) => void;\n}>;\n\ntype ErrorBoundaryState = { error: Error | null };\n\n/**\n * This is a special case for for using the class components. Error boundaries must be class components because React only provides error boundary functionality through lifecycle methods (componentDidCatch and getDerivedStateFromError) which are not available in functional components.\n * https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary\n */\n\nexport class ErrorBoundary extends Component<\n  ErrorBoundaryProps,\n  ErrorBoundaryState\n> {\n  state: ErrorBoundaryState = { error: null };\n\n  static defaultProps: {\n    FallbackComponent: ComponentType<ErrorFallbackProps>;\n  } = {\n    FallbackComponent: ErrorFallback,\n  };\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    return { error };\n  }\n\n  componentDidCatch(error: Error, info: { componentStack: string }): void {\n    if (typeof this.props.onError === \"function\") {\n      this.props.onError(error, info.componentStack);\n    }\n  }\n\n  resetError = (): void => {\n    this.setState({ error: null });\n  };\n\n  render() {\n    const { FallbackComponent } = this.props;\n\n    return this.state.error && FallbackComponent ? (\n      <FallbackComponent\n        error={this.state.error}\n        resetError={this.resetError}\n      />\n    ) : (\n      this.props.children\n    );\n  }\n}\n","path":null,"size_bytes":1674,"size_tokens":null},"eslint.config.js":{"content":"// https://docs.expo.dev/guides/using-eslint/\nconst { defineConfig } = require(\"eslint/config\");\nconst expoConfig = require(\"eslint-config-expo/flat\");\nconst eslintPluginPrettierRecommended = require(\"eslint-plugin-prettier/recommended\");\n\nmodule.exports = defineConfig([\n  expoConfig,\n  eslintPluginPrettierRecommended,\n  {\n    ignores: [\"dist/*\"],\n  },\n]);\n","path":null,"size_bytes":359,"size_tokens":null},"components/ReminderCard.tsx":{"content":"import React from \"react\";\nimport { StyleSheet, View, Pressable } from \"react-native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n} from \"react-native-reanimated\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Shadows } from \"@/constants/theme\";\nimport { Reminder } from \"@/utils/storage\";\n\ninterface ReminderCardProps {\n  reminder: Reminder;\n  onToggle: (id: string) => void;\n  onPress?: () => void;\n  isTaken: boolean;\n}\n\nconst AnimatedPressable = Animated.createAnimatedComponent(Pressable);\n\nexport function ReminderCard({ reminder, onToggle, onPress, isTaken }: ReminderCardProps) {\n  const { theme } = useTheme();\n  const scale = useSharedValue(1);\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const handlePressIn = () => {\n    scale.value = withSpring(0.98);\n  };\n\n  const handlePressOut = () => {\n    scale.value = withSpring(1);\n  };\n\n  const formatTime = (time: string) => {\n    const [hours, minutes] = time.split(\":\");\n    const hour = parseInt(hours, 10);\n    const ampm = hour >= 12 ? \"PM\" : \"AM\";\n    const displayHour = hour % 12 || 12;\n    return `${displayHour}:${minutes} ${ampm}`;\n  };\n\n  const handleCardPress = () => {\n    onToggle(reminder.id);\n  };\n\n  return (\n    <AnimatedPressable\n      onPress={handleCardPress}\n      onPressIn={handlePressIn}\n      onPressOut={handlePressOut}\n      accessibilityRole=\"checkbox\"\n      accessibilityState={{ checked: isTaken }}\n      accessibilityLabel={`${reminder.medicationName} ${reminder.dosage} at ${formatTime(reminder.time)}, ${isTaken ? \"taken\" : \"not taken\"}`}\n      style={[\n        styles.card,\n        {\n          backgroundColor: theme.cardBackground,\n          opacity: isTaken ? 0.7 : 1,\n        },\n        Shadows.small,\n        animatedStyle,\n      ]}\n    >\n      <View\n        style={[\n          styles.checkbox,\n          {\n            backgroundColor: isTaken ? theme.success : \"transparent\",\n            borderColor: isTaken ? theme.success : theme.border,\n          },\n        ]}\n      >\n        {isTaken ? <Feather name=\"check\" size={16} color=\"#FFFFFF\" /> : null}\n      </View>\n\n      <View style={styles.content}>\n        <ThemedText\n          type=\"h4\"\n          style={[styles.name, isTaken && styles.takenText]}\n          numberOfLines={1}\n        >\n          {reminder.medicationName}\n        </ThemedText>\n        <ThemedText\n          type=\"small\"\n          style={[styles.dosage, { color: theme.textSecondary }]}\n        >\n          {reminder.dosage}\n        </ThemedText>\n      </View>\n\n      <View style={styles.timeContainer}>\n        <ThemedText type=\"label\" style={{ color: theme.primary }}>\n          {formatTime(reminder.time)}\n        </ThemedText>\n      </View>\n    </AnimatedPressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  card: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.lg,\n  },\n  checkbox: {\n    width: 24,\n    height: 24,\n    borderRadius: BorderRadius.sm,\n    borderWidth: 2,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginRight: Spacing.md,\n  },\n  content: {\n    flex: 1,\n  },\n  name: {},\n  takenText: {\n    textDecorationLine: \"line-through\",\n    opacity: 0.6,\n  },\n  dosage: {\n    marginTop: Spacing.xs,\n  },\n  timeContainer: {\n    marginLeft: Spacing.md,\n  },\n});\n","path":null,"size_bytes":3488,"size_tokens":null},"navigation/PharmacyStackNavigator.tsx":{"content":"import React from \"react\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport PharmacyScreen from \"@/screens/PharmacyScreen\";\nimport PharmacyDetailScreen from \"@/screens/PharmacyDetailScreen\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { getCommonScreenOptions } from \"@/navigation/screenOptions\";\n\nexport type PharmacyStackParamList = {\n  Pharmacy: undefined;\n  PharmacyDetail: { pharmacyId: string };\n};\n\nconst Stack = createNativeStackNavigator<PharmacyStackParamList>();\n\nexport default function PharmacyStackNavigator() {\n  const { theme, isDark } = useTheme();\n\n  return (\n    <Stack.Navigator screenOptions={getCommonScreenOptions({ theme, isDark })}>\n      <Stack.Screen\n        name=\"Pharmacy\"\n        component={PharmacyScreen}\n        options={{ headerTitle: \"Find Pharmacy\" }}\n      />\n      <Stack.Screen\n        name=\"PharmacyDetail\"\n        component={PharmacyDetailScreen}\n        options={{ headerTitle: \"Pharmacy Details\" }}\n      />\n    </Stack.Navigator>\n  );\n}\n","path":null,"size_bytes":1024,"size_tokens":null},"scripts/build.js":{"content":"const fs = require(\"fs\");\nconst path = require(\"path\");\nconst { spawn } = require(\"child_process\");\nconst { Readable } = require(\"stream\");\nconst { pipeline } = require(\"stream/promises\");\n\nlet metroProcess = null;\n\nfunction exitWithError(message) {\n  console.error(message);\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(1);\n}\n\nfunction setupSignalHandlers() {\n  const cleanup = () => {\n    if (metroProcess) {\n      console.log(\"Cleaning up Metro process...\");\n      metroProcess.kill();\n    }\n    process.exit(0);\n  };\n\n  process.on(\"SIGINT\", cleanup);\n  process.on(\"SIGTERM\", cleanup);\n  process.on(\"SIGHUP\", cleanup);\n}\n\nfunction getDeploymentUrl() {\n  if (process.env.REPLIT_INTERNAL_APP_DOMAIN) {\n    const url = `https://${process.env.REPLIT_INTERNAL_APP_DOMAIN}`;\n    console.log(\"Using REPLIT_INTERNAL_APP_DOMAIN:\", url);\n    return url;\n  }\n\n  if (process.env.REPLIT_DEV_DOMAIN) {\n    const url = `https://${process.env.REPLIT_DEV_DOMAIN}`;\n    console.log(\"Using REPLIT_DEV_DOMAIN:\", url);\n    return url;\n  }\n\n  console.error(\n    \"ERROR: REPLIT_INTERNAL_APP_DOMAIN and REPLIT_DEV_DOMAIN not set\",\n  );\n  process.exit(1);\n}\n\nfunction prepareDirectories(timestamp) {\n  console.log(\"Preparing build directories...\");\n\n  if (fs.existsSync(\"static-build\")) {\n    fs.rmSync(\"static-build\", { recursive: true });\n  }\n\n  const dirs = [\n    path.join(\"static-build\", timestamp, \"_expo\", \"static\", \"js\", \"ios\"),\n    path.join(\"static-build\", timestamp, \"_expo\", \"static\", \"js\", \"android\"),\n    path.join(\"static-build\", \"ios\"),\n    path.join(\"static-build\", \"android\"),\n  ];\n\n  for (const dir of dirs) {\n    fs.mkdirSync(dir, { recursive: true });\n  }\n\n  console.log(\"Build:\", timestamp);\n}\n\nfunction clearMetroCache() {\n  console.log(\"Clearing Metro cache...\");\n\n  const cacheDirs = [\n    ...fs.globSync(\".metro-cache\"),\n    ...fs.globSync(\"node_modules/.cache/metro\"),\n  ];\n\n  for (const dir of cacheDirs) {\n    fs.rmSync(dir, { recursive: true, force: true });\n  }\n\n  console.log(\"Cache cleared\");\n}\n\nasync function checkMetroHealth() {\n  try {\n    const response = await fetch(\"http://localhost:8081/status\");\n    return response.ok;\n  } catch {\n    return false;\n  }\n}\n\nasync function startMetro() {\n  const isRunning = await checkMetroHealth();\n  if (isRunning) {\n    return;\n  }\n\n  console.log(\"Starting Metro...\");\n  metroProcess = spawn(\"npm\", [\"run\", \"dev\"], {\n    stdio: [\"ignore\", \"ignore\", \"ignore\"],\n    detached: false,\n  });\n\n  for (let i = 0; i < 30; i++) {\n    await new Promise((resolve) => setTimeout(resolve, 1000));\n    const healthy = await checkMetroHealth();\n    if (healthy) {\n      console.log(\"Metro ready\");\n      return;\n    }\n  }\n\n  console.error(\"Metro timeout\");\n  process.exit(1);\n}\n\nasync function downloadFile(url, outputPath) {\n  try {\n    const response = await fetch(url);\n\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}`);\n    }\n\n    const file = fs.createWriteStream(outputPath);\n    await pipeline(Readable.fromWeb(response.body), file);\n\n    const fileSize = fs.statSync(outputPath).size;\n\n    if (fileSize === 0) {\n      fs.unlinkSync(outputPath);\n      throw new Error(\"Downloaded file is empty\");\n    }\n  } catch (error) {\n    if (fs.existsSync(outputPath)) {\n      fs.unlinkSync(outputPath);\n    }\n    throw error;\n  }\n}\n\nasync function downloadBundle(platform, timestamp) {\n  const url = new URL(\"http://localhost:8081/index.bundle\");\n  url.searchParams.set(\"platform\", platform);\n  url.searchParams.set(\"dev\", \"false\");\n  url.searchParams.set(\"hot\", \"false\");\n  url.searchParams.set(\"lazy\", \"false\");\n  url.searchParams.set(\"minify\", \"true\");\n\n  const output = path.join(\n    \"static-build\",\n    timestamp,\n    \"_expo\",\n    \"static\",\n    \"js\",\n    platform,\n    \"bundle.js\",\n  );\n\n  try {\n    await downloadFile(url.toString(), output);\n  } catch (error) {\n    exitWithError(`Failed to download ${platform} bundle: ${error.message}`);\n  }\n}\n\nasync function downloadManifest(platform) {\n  const response = await fetch(\"http://localhost:8081/manifest\", {\n    headers: { \"expo-platform\": platform },\n  });\n\n  if (!response.ok) {\n    throw new Error(`HTTP ${response.status}`);\n  }\n\n  return await response.json();\n}\n\nasync function downloadBundlesAndManifests(timestamp) {\n  console.log(\"Downloading bundles and manifests...\");\n\n  try {\n    const [, , iosManifest, androidManifest] = await Promise.all([\n      downloadBundle(\"ios\", timestamp),\n      downloadBundle(\"android\", timestamp),\n      downloadManifest(\"ios\"),\n      downloadManifest(\"android\"),\n    ]);\n    console.log(\"Downloaded\");\n    return { ios: iosManifest, android: androidManifest };\n  } catch (error) {\n    exitWithError(`Download failed: ${error.message}`);\n  }\n}\n\nfunction extractAssets(timestamp) {\n  const bundles = {\n    ios: fs.readFileSync(\n      path.join(\n        \"static-build\",\n        timestamp,\n        \"_expo\",\n        \"static\",\n        \"js\",\n        \"ios\",\n        \"bundle.js\",\n      ),\n      \"utf-8\",\n    ),\n    android: fs.readFileSync(\n      path.join(\n        \"static-build\",\n        timestamp,\n        \"_expo\",\n        \"static\",\n        \"js\",\n        \"android\",\n        \"bundle.js\",\n      ),\n      \"utf-8\",\n    ),\n  };\n\n  const assetsMap = new Map();\n  const assetPattern =\n    /httpServerLocation:\"([^\"]+)\"[^}]*hash:\"([^\"]+)\"[^}]*name:\"([^\"]+)\"[^}]*type:\"([^\"]+)\"/g;\n\n  const extractFromBundle = (bundle, platform) => {\n    for (const match of bundle.matchAll(assetPattern)) {\n      const originalPath = match[1];\n      const filename = match[3] + \".\" + match[4];\n\n      const tempUrl = new URL(`http://localhost:8081${originalPath}`);\n      const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n      if (!unstablePath) {\n        throw new Error(`Asset missing unstable_path: ${originalPath}`);\n      }\n\n      const decodedPath = decodeURIComponent(unstablePath).replace(/^\\.\\//, \"\");\n      const key = path.posix.join(decodedPath, filename);\n\n      if (!assetsMap.has(key)) {\n        const asset = {\n          url: path.posix.join(\"/\", decodedPath, filename),\n          originalPath: originalPath,\n          filename: filename,\n          relativePath: decodedPath,\n          hash: match[2],\n          platforms: new Set(),\n        };\n\n        assetsMap.set(key, asset);\n      }\n      assetsMap.get(key).platforms.add(platform);\n    }\n  };\n\n  extractFromBundle(bundles.ios, \"ios\");\n  extractFromBundle(bundles.android, \"android\");\n\n  return Array.from(assetsMap.values());\n}\n\nasync function downloadAssets(assets, timestamp) {\n  if (assets.length === 0) {\n    return 0;\n  }\n\n  console.log(\"Downloading assets...\");\n  let successCount = 0;\n  const failures = [];\n\n  const downloadPromises = assets.map(async (asset) => {\n    const platform = Array.from(asset.platforms)[0];\n\n    const tempUrl = new URL(`http://localhost:8081${asset.originalPath}`);\n    const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n    if (!unstablePath) {\n      throw new Error(`Asset missing unstable_path: ${asset.originalPath}`);\n    }\n\n    const decodedPath = decodeURIComponent(unstablePath).replace(/^\\./, \"\");\n    const metroUrl = new URL(\n      `http://localhost:8081${path.posix.join(\"/assets\", decodedPath, asset.filename)}`,\n    );\n    metroUrl.searchParams.set(\"platform\", platform);\n    metroUrl.searchParams.set(\"hash\", asset.hash);\n\n    const outputDir = path.join(\n      \"static-build\",\n      timestamp,\n      \"_expo\",\n      \"static\",\n      \"js\",\n      asset.relativePath,\n    );\n    fs.mkdirSync(outputDir, { recursive: true });\n    const output = path.join(outputDir, asset.filename);\n\n    try {\n      await downloadFile(metroUrl.toString(), output);\n      successCount++;\n    } catch (error) {\n      failures.push({\n        filename: asset.filename,\n        error: error.message,\n        url: metroUrl.toString(),\n      });\n    }\n  });\n\n  await Promise.all(downloadPromises);\n\n  if (failures.length > 0) {\n    const errorMsg =\n      `Failed to download ${failures.length} asset(s):\\n` +\n      failures\n        .map((f) => `  - ${f.filename}: ${f.error} (${f.url})`)\n        .join(\"\\n\");\n    exitWithError(errorMsg);\n  }\n\n  console.log(`Downloaded ${successCount} assets`);\n  return successCount;\n}\n\nfunction updateBundleUrls(timestamp, baseUrl) {\n  const updateForPlatform = (platform) => {\n    const bundlePath = path.join(\n      \"static-build\",\n      timestamp,\n      \"_expo\",\n      \"static\",\n      \"js\",\n      platform,\n      \"bundle.js\",\n    );\n    let bundle = fs.readFileSync(bundlePath, \"utf-8\");\n\n    bundle = bundle.replace(\n      /httpServerLocation:\"(\\/[^\"]+)\"/g,\n      (_match, capturedPath) => {\n        const tempUrl = new URL(`http://localhost:8081${capturedPath}`);\n        const unstablePath = tempUrl.searchParams.get(\"unstable_path\");\n\n        if (!unstablePath) {\n          throw new Error(\n            `Asset missing unstable_path in bundle: ${capturedPath}`,\n          );\n        }\n\n        const decodedPath = decodeURIComponent(unstablePath).replace(\n          /^\\.\\//,\n          \"\",\n        );\n        return `httpServerLocation:\"${baseUrl}/${timestamp}/_expo/static/js/${decodedPath}\"`;\n      },\n    );\n\n    fs.writeFileSync(bundlePath, bundle);\n  };\n\n  updateForPlatform(\"ios\");\n  updateForPlatform(\"android\");\n  console.log(\"Updated bundle URLs\");\n}\n\nfunction updateManifests(manifests, timestamp, baseUrl, assetsByHash) {\n  const updateForPlatform = (platform, manifest) => {\n    if (!manifest.launchAsset || !manifest.extra) {\n      exitWithError(`Malformed manifest for ${platform}`);\n    }\n\n    manifest.launchAsset.url = `${baseUrl}/${timestamp}/_expo/static/js/${platform}/bundle.js`;\n    manifest.launchAsset.key = `bundle-${timestamp}`;\n    manifest.createdAt = new Date(\n      Number(timestamp.split(\"-\")[0]),\n    ).toISOString();\n    manifest.extra.expoClient.hostUri =\n      baseUrl.replace(\"https://\", \"\") + \"/\" + platform;\n    manifest.extra.expoGo.debuggerHost =\n      baseUrl.replace(\"https://\", \"\") + \"/\" + platform;\n    manifest.extra.expoGo.packagerOpts.dev = false;\n\n    if (manifest.assets && manifest.assets.length > 0) {\n      manifest.assets.forEach((asset) => {\n        if (!asset.url) return;\n\n        const hash = asset.hash;\n        if (!hash) return;\n\n        const assetInfo = assetsByHash.get(hash);\n        if (!assetInfo) return;\n\n        asset.url = `${baseUrl}/${timestamp}/_expo/static/js/${assetInfo.relativePath}/${assetInfo.filename}`;\n      });\n    }\n\n    fs.writeFileSync(\n      path.join(\"static-build\", platform, \"manifest.json\"),\n      JSON.stringify(manifest, null, 2),\n    );\n  };\n\n  updateForPlatform(\"ios\", manifests.ios);\n  updateForPlatform(\"android\", manifests.android);\n  console.log(\"Manifests updated\");\n}\n\nfunction createLandingPage(baseUrl) {\n  const expsUrl = baseUrl.replace(\"https://\", \"\");\n  const template = fs.readFileSync(\n    path.join(\"scripts\", \"landing-page-template.html\"),\n    \"utf-8\",\n  );\n\n  const html = template\n    .replace(/BASE_URL_PLACEHOLDER/g, baseUrl)\n    .replace(/EXPS_URL_PLACEHOLDER/g, expsUrl);\n\n  fs.writeFileSync(path.join(\"static-build\", \"index.html\"), html);\n  console.log(\"Complete\");\n}\n\nasync function main() {\n  console.log(\"Building static Expo Go deployment...\");\n\n  setupSignalHandlers();\n\n  const baseUrl = getDeploymentUrl();\n  const timestamp = `${Date.now()}-${process.pid}`;\n\n  prepareDirectories(timestamp);\n  clearMetroCache();\n\n  await startMetro();\n  const manifests = await downloadBundlesAndManifests(timestamp);\n\n  console.log(\"Processing assets...\");\n  const assets = extractAssets(timestamp);\n  console.log(\"Found\", assets.length, \"unique asset(s)\");\n\n  const assetsByHash = new Map();\n  for (const asset of assets) {\n    assetsByHash.set(asset.hash, {\n      relativePath: asset.relativePath,\n      filename: asset.filename,\n    });\n  }\n\n  const assetCount = await downloadAssets(assets, timestamp);\n\n  if (assetCount > 0) {\n    updateBundleUrls(timestamp, baseUrl);\n  }\n\n  console.log(\"Updating manifests and creating landing page...\");\n  updateManifests(manifests, timestamp, baseUrl, assetsByHash);\n  createLandingPage(baseUrl);\n\n  console.log(\"Build complete! Deploy to:\", baseUrl);\n\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(0);\n}\n\nmain().catch((error) => {\n  console.error(\"Build failed:\", error.message);\n  if (metroProcess) {\n    metroProcess.kill();\n  }\n  process.exit(1);\n});\n","path":null,"size_bytes":12348,"size_tokens":null},"screens/ScanResultScreen.tsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport { View, StyleSheet, Image } from \"react-native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { RouteProp } from \"@react-navigation/native\";\nimport { Feather } from \"@expo/vector-icons\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { MedCard } from \"@/components/MedCard\";\nimport { SeverityBadge } from \"@/components/SeverityBadge\";\nimport { Button } from \"@/components/Button\";\nimport Spacer from \"@/components/Spacer\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Shadows, MedicalColors } from \"@/constants/theme\";\nimport { ScannerStackParamList } from \"@/navigation/ScannerStackNavigator\";\nimport { getScanHistory, getUserProfile, ScanHistoryItem, UserProfile } from \"@/utils/storage\";\nimport { getDrugById, checkSafetyForProfile, DrugInfo } from \"@/utils/drugDatabase\";\n\ntype ScanResultScreenProps = {\n  navigation: NativeStackNavigationProp<ScannerStackParamList, \"ScanResult\">;\n  route: RouteProp<ScannerStackParamList, \"ScanResult\">;\n};\n\nexport default function ScanResultScreen({ navigation, route }: ScanResultScreenProps) {\n  const { theme } = useTheme();\n  const [scan, setScan] = useState<ScanHistoryItem | null>(null);\n  const [drug, setDrug] = useState<DrugInfo | null>(null);\n  const [safetyAlerts, setSafetyAlerts] = useState<string[]>([]);\n  const [profile, setProfile] = useState<UserProfile | null>(null);\n\n  useEffect(() => {\n    const loadData = async () => {\n      const [history, profileData] = await Promise.all([\n        getScanHistory(),\n        getUserProfile(),\n      ]);\n      \n      if (history.length > 0) {\n        const latestScan = history[0];\n        setScan(latestScan);\n        \n        const drugInfo = getDrugById(latestScan.medicationId);\n        if (drugInfo) {\n          setDrug(drugInfo);\n          const alerts = checkSafetyForProfile(drugInfo, profileData);\n          setSafetyAlerts(alerts);\n        }\n        setProfile(profileData);\n      }\n    };\n    loadData();\n  }, []);\n\n  if (!scan || !drug) {\n    return (\n      <ScreenScrollView>\n        <View style={styles.loading}>\n          <ThemedText type=\"body\">Loading result...</ThemedText>\n        </View>\n      </ScreenScrollView>\n    );\n  }\n\n  const confidenceColor = scan.confidence >= 0.9 ? theme.success : theme.accent;\n\n  return (\n    <ScreenScrollView>\n      <View style={[styles.resultCard, { backgroundColor: theme.cardBackground }, Shadows.medium]}>\n        <View style={styles.resultHeader}>\n          <View style={[styles.pillIcon, { backgroundColor: theme.backgroundSecondary }]}>\n            <Feather name=\"disc\" size={32} color={theme.primary} />\n          </View>\n          <View style={styles.resultInfo}>\n            <ThemedText type=\"h2\">{drug.name}</ThemedText>\n            <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n              {drug.genericName}\n            </ThemedText>\n          </View>\n        </View>\n\n        <View style={styles.confidenceRow}>\n          <View style={styles.confidenceInfo}>\n            <ThemedText type=\"label\">AI Confidence</ThemedText>\n            <View style={styles.analysisMethodRow}>\n              <Feather \n                name={scan.analysisMethod === \"database\" ? \"check-circle\" : \"cpu\"} \n                size={12} \n                color={theme.textSecondary} \n              />\n              <ThemedText type=\"small\" style={{ color: theme.textSecondary, marginLeft: 4 }}>\n                {scan.analysisMethod === \"database\" \n                  ? \"Database Match\" \n                  : scan.analysisMethod === \"ai\" \n                    ? \"AI Analysis\" \n                    : \"Visual Analysis\"}\n              </ThemedText>\n            </View>\n          </View>\n          <View style={[styles.confidenceBadge, { backgroundColor: confidenceColor }]}>\n            <ThemedText type=\"label\" style={styles.confidenceText}>\n              {Math.round(scan.confidence * 100)}%\n            </ThemedText>\n          </View>\n        </View>\n\n        {scan.matchDetails ? (\n          <View style={styles.matchQualityRow}>\n            <View style={[styles.matchIndicator, { backgroundColor: scan.matchDetails.shape ? theme.success + \"20\" : theme.backgroundSecondary }]}>\n              <Feather name=\"square\" size={14} color={scan.matchDetails.shape ? theme.success : theme.textSecondary} />\n              <ThemedText type=\"small\" style={{ marginLeft: 4 }}>Shape</ThemedText>\n            </View>\n            <View style={[styles.matchIndicator, { backgroundColor: scan.matchDetails.color ? theme.success + \"20\" : theme.backgroundSecondary }]}>\n              <Feather name=\"droplet\" size={14} color={scan.matchDetails.color ? theme.success : theme.textSecondary} />\n              <ThemedText type=\"small\" style={{ marginLeft: 4 }}>Color</ThemedText>\n            </View>\n            <View style={[styles.matchIndicator, { backgroundColor: scan.matchDetails.imprint ? theme.success + \"20\" : theme.backgroundSecondary }]}>\n              <Feather name=\"type\" size={14} color={scan.matchDetails.imprint ? theme.success : theme.textSecondary} />\n              <ThemedText type=\"small\" style={{ marginLeft: 4 }}>Imprint</ThemedText>\n            </View>\n          </View>\n        ) : null}\n\n        <View style={styles.detailsGrid}>\n          <View style={styles.detailItem}>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              Dosage\n            </ThemedText>\n            <ThemedText type=\"body\">{drug.dosage}</ThemedText>\n          </View>\n          <View style={styles.detailItem}>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              Shape\n            </ThemedText>\n            <ThemedText type=\"body\">{drug.shape}</ThemedText>\n          </View>\n          <View style={styles.detailItem}>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              Color\n            </ThemedText>\n            <ThemedText type=\"body\">{drug.color}</ThemedText>\n          </View>\n          <View style={styles.detailItem}>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              Manufacturer\n            </ThemedText>\n            <ThemedText type=\"body\">{drug.manufacturer}</ThemedText>\n          </View>\n        </View>\n      </View>\n\n      <Spacer height={Spacing.xl} />\n\n      {safetyAlerts.length > 0 ? (\n        <>\n          <ThemedText type=\"h3\">Safety Alerts</ThemedText>\n          <Spacer height={Spacing.md} />\n          {safetyAlerts.map((alert, index) => (\n            <View\n              key={index}\n              style={[\n                styles.alertCard,\n                { backgroundColor: MedicalColors.severityMajor.background },\n              ]}\n            >\n              <Feather\n                name=\"alert-triangle\"\n                size={20}\n                color={MedicalColors.severityMajor.text}\n              />\n              <ThemedText\n                type=\"body\"\n                style={[styles.alertText, { color: MedicalColors.severityMajor.text }]}\n              >\n                {alert}\n              </ThemedText>\n            </View>\n          ))}\n          <Spacer height={Spacing.xl} />\n        </>\n      ) : null}\n\n      <ThemedText type=\"h3\">Warnings</ThemedText>\n      <Spacer height={Spacing.md} />\n      <View style={[styles.infoCard, { backgroundColor: theme.cardBackground }]}>\n        {drug.warnings.map((warning, index) => (\n          <View key={index} style={styles.warningItem}>\n            <Feather name=\"alert-circle\" size={16} color={theme.accent} />\n            <ThemedText type=\"body\" style={styles.warningText}>\n              {warning}\n            </ThemedText>\n          </View>\n        ))}\n      </View>\n\n      <Spacer height={Spacing.xl} />\n\n      <ThemedText type=\"h3\">Side Effects</ThemedText>\n      <Spacer height={Spacing.md} />\n      <View style={[styles.infoCard, { backgroundColor: theme.cardBackground }]}>\n        <View style={styles.sideEffectsGrid}>\n          {drug.sideEffects.map((effect, index) => (\n            <View\n              key={index}\n              style={[styles.sideEffectBadge, { backgroundColor: theme.backgroundSecondary }]}\n            >\n              <ThemedText type=\"small\">{effect}</ThemedText>\n            </View>\n          ))}\n        </View>\n      </View>\n\n      <Spacer height={Spacing.xl} />\n\n      <ThemedText type=\"h3\">Known Interactions</ThemedText>\n      <Spacer height={Spacing.md} />\n      <View style={[styles.infoCard, { backgroundColor: theme.cardBackground }]}>\n        {drug.interactions.map((interaction, index) => (\n          <View key={index} style={styles.interactionItem}>\n            <Feather name=\"x-circle\" size={16} color={theme.error} />\n            <ThemedText type=\"body\" style={styles.interactionText}>\n              {interaction}\n            </ThemedText>\n          </View>\n        ))}\n      </View>\n\n      <Spacer height={Spacing[\"2xl\"]} />\n\n      <Button\n        onPress={() => navigation.getParent()?.getParent()?.navigate(\"InteractionsTab\")}\n        style={{ backgroundColor: theme.secondary }}\n      >\n        Check Drug Interactions\n      </Button>\n\n      <Spacer height={Spacing.lg} />\n\n      <Button\n        onPress={() => navigation.getParent()?.getParent()?.navigate(\"PharmacyTab\")}\n      >\n        Find Nearby Pharmacies\n      </Button>\n\n      <Spacer height={Spacing[\"3xl\"]} />\n    </ScreenScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  loading: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingVertical: Spacing[\"4xl\"],\n  },\n  resultCard: {\n    borderRadius: BorderRadius.xl,\n    padding: Spacing.xl,\n  },\n  resultHeader: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginBottom: Spacing.xl,\n  },\n  pillIcon: {\n    width: 64,\n    height: 64,\n    borderRadius: 32,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginRight: Spacing.lg,\n  },\n  resultInfo: {\n    flex: 1,\n  },\n  confidenceRow: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    marginBottom: Spacing.md,\n  },\n  confidenceInfo: {\n    flex: 1,\n  },\n  analysisMethodRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginTop: 2,\n  },\n  confidenceBadge: {\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.sm,\n  },\n  confidenceText: {\n    color: \"#FFFFFF\",\n  },\n  matchQualityRow: {\n    flexDirection: \"row\",\n    gap: Spacing.sm,\n    marginBottom: Spacing.xl,\n  },\n  matchIndicator: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.sm,\n  },\n  detailsGrid: {\n    flexDirection: \"row\",\n    flexWrap: \"wrap\",\n    marginHorizontal: -Spacing.sm,\n  },\n  detailItem: {\n    width: \"50%\",\n    paddingHorizontal: Spacing.sm,\n    marginBottom: Spacing.md,\n  },\n  alertCard: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.md,\n    marginBottom: Spacing.sm,\n  },\n  alertText: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n  infoCard: {\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.lg,\n  },\n  warningItem: {\n    flexDirection: \"row\",\n    alignItems: \"flex-start\",\n    marginBottom: Spacing.sm,\n  },\n  warningText: {\n    flex: 1,\n    marginLeft: Spacing.sm,\n  },\n  sideEffectsGrid: {\n    flexDirection: \"row\",\n    flexWrap: \"wrap\",\n    gap: Spacing.sm,\n  },\n  sideEffectBadge: {\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.sm,\n  },\n  interactionItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginBottom: Spacing.sm,\n  },\n  interactionText: {\n    flex: 1,\n    marginLeft: Spacing.sm,\n  },\n});\n","path":null,"size_bytes":11895,"size_tokens":null},"components/Button.tsx":{"content":"import React, { ReactNode } from \"react\";\nimport { StyleSheet, Pressable, ViewStyle, StyleProp } from \"react-native\";\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n  WithSpringConfig,\n} from \"react-native-reanimated\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { BorderRadius, Spacing } from \"@/constants/theme\";\n\ninterface ButtonProps {\n  onPress?: () => void;\n  children: ReactNode;\n  style?: StyleProp<ViewStyle>;\n  disabled?: boolean;\n}\n\nconst springConfig: WithSpringConfig = {\n  damping: 15,\n  mass: 0.3,\n  stiffness: 150,\n  overshootClamping: true,\n  energyThreshold: 0.001,\n};\n\nconst AnimatedPressable = Animated.createAnimatedComponent(Pressable);\n\nexport function Button({\n  onPress,\n  children,\n  style,\n  disabled = false,\n}: ButtonProps) {\n  const { theme } = useTheme();\n  const scale = useSharedValue(1);\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const handlePressIn = () => {\n    if (!disabled) {\n      scale.value = withSpring(0.98, springConfig);\n    }\n  };\n\n  const handlePressOut = () => {\n    if (!disabled) {\n      scale.value = withSpring(1, springConfig);\n    }\n  };\n\n  return (\n    <AnimatedPressable\n      onPress={disabled ? undefined : onPress}\n      onPressIn={handlePressIn}\n      onPressOut={handlePressOut}\n      disabled={disabled}\n      style={[\n        styles.button,\n        {\n          backgroundColor: theme.link,\n          opacity: disabled ? 0.5 : 1,\n        },\n        style,\n        animatedStyle,\n      ]}\n    >\n      <ThemedText\n        type=\"body\"\n        style={[styles.buttonText, { color: theme.buttonText }]}\n      >\n        {children}\n      </ThemedText>\n    </AnimatedPressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  button: {\n    height: Spacing.buttonHeight,\n    borderRadius: BorderRadius.full,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  buttonText: {\n    fontWeight: \"600\",\n  },\n});\n","path":null,"size_bytes":2014,"size_tokens":null},"components/ProgressBar.tsx":{"content":"import React from \"react\";\nimport { StyleSheet, View } from \"react-native\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { BorderRadius, Spacing } from \"@/constants/theme\";\n\ninterface ProgressBarProps {\n  progress: number;\n  height?: number;\n  color?: string;\n  backgroundColor?: string;\n}\n\nexport function ProgressBar({\n  progress,\n  height = 8,\n  color,\n  backgroundColor,\n}: ProgressBarProps) {\n  const { theme } = useTheme();\n  const clampedProgress = Math.min(Math.max(progress, 0), 1);\n\n  return (\n    <View\n      style={[\n        styles.container,\n        {\n          height,\n          backgroundColor: backgroundColor || theme.backgroundSecondary,\n        },\n      ]}\n    >\n      <View\n        style={[\n          styles.fill,\n          {\n            width: `${clampedProgress * 100}%`,\n            backgroundColor: color || theme.primary,\n          },\n        ]}\n      />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    borderRadius: BorderRadius.full,\n    overflow: \"hidden\",\n  },\n  fill: {\n    height: \"100%\",\n    borderRadius: BorderRadius.full,\n  },\n});\n","path":null,"size_bytes":1099,"size_tokens":null},"components/HeaderTitle.tsx":{"content":"import React from \"react\";\nimport { View, StyleSheet, Image } from \"react-native\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing } from \"@/constants/theme\";\n\ninterface HeaderTitleProps {\n  title: string;\n}\n\nexport function HeaderTitle({ title }: HeaderTitleProps) {\n  const { theme } = useTheme();\n\n  return (\n    <View style={styles.container}>\n      <Image\n        source={require(\"../assets/images/icon.png\")}\n        style={styles.icon}\n        resizeMode=\"contain\"\n      />\n      <ThemedText style={[styles.title, { color: theme.primary }]}>{title}</ThemedText>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"flex-start\",\n  },\n  icon: {\n    width: 32,\n    height: 32,\n    marginRight: Spacing.sm,\n    borderRadius: 8,\n  },\n  title: {\n    fontSize: 18,\n    fontWeight: \"700\",\n  },\n});\n","path":null,"size_bytes":956,"size_tokens":null},"components/VoiceAssistantButton.tsx":{"content":"import React, { useState, useRef, useCallback } from \"react\";\nimport {\n  StyleSheet,\n  View,\n  Modal,\n  Pressable,\n  TextInput,\n  ScrollView,\n  Platform,\n} from \"react-native\";\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n  withRepeat,\n  withSequence,\n  WithSpringConfig,\n} from \"react-native-reanimated\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Shadows } from \"@/constants/theme\";\nimport { processVoiceQuery, speakText, stopSpeaking, simulateFasterWhisperSTT } from \"@/utils/aiServices\";\n\nconst springConfig: WithSpringConfig = {\n  damping: 15,\n  mass: 0.5,\n  stiffness: 150,\n};\n\nconst AnimatedPressable = Animated.createAnimatedComponent(Pressable);\n\nconst TAB_BAR_HEIGHT = 80;\n\ninterface Message {\n  id: string;\n  text: string;\n  isUser: boolean;\n  timestamp: Date;\n  usedLocalFallback?: boolean;\n}\n\nexport function VoiceAssistantButton() {\n  const { theme } = useTheme();\n  const insets = useSafeAreaInsets();\n  \n  const [isModalVisible, setIsModalVisible] = useState(false);\n  const [isListening, setIsListening] = useState(false);\n  const [isSpeaking, setIsSpeaking] = useState(false);\n  const [speakingMessageId, setSpeakingMessageId] = useState<string | null>(null);\n  const [language, setLanguage] = useState<\"en\" | \"uz\" | \"ru\">(\"en\");\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [inputText, setInputText] = useState(\"\");\n  const [isProcessing, setIsProcessing] = useState(false);\n  \n  const isListeningRef = useRef(false);\n  const micTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  \n  const scale = useSharedValue(1);\n  const pulseScale = useSharedValue(1);\n\n  const animatedButtonStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const animatedPulseStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: pulseScale.value }],\n    opacity: 2 - pulseScale.value,\n  }));\n\n  const handlePressIn = () => {\n    scale.value = withSpring(0.9, springConfig);\n  };\n\n  const handlePressOut = () => {\n    scale.value = withSpring(1, springConfig);\n  };\n\n  const handlePress = () => {\n    setIsModalVisible(true);\n  };\n\n  const handleSend = async () => {\n    if (!inputText.trim() || isProcessing) return;\n\n    const userMessage: Message = {\n      id: Date.now().toString(),\n      text: inputText.trim(),\n      isUser: true,\n      timestamp: new Date(),\n    };\n\n    setMessages((prev) => [...prev, userMessage]);\n    setInputText(\"\");\n    setIsProcessing(true);\n\n    try {\n      const response = await processVoiceQuery(inputText.trim(), language);\n      \n      const assistantMessage: Message = {\n        id: (Date.now() + 1).toString(),\n        text: response.text,\n        isUser: false,\n        timestamp: new Date(),\n        usedLocalFallback: response.usedLocalFallback,\n      };\n\n      setMessages((prev) => [...prev, assistantMessage]);\n    } catch (error) {\n      const errorMessage: Message = {\n        id: (Date.now() + 1).toString(),\n        text: \"Sorry, I couldn't process your request. Please try again.\",\n        isUser: false,\n        timestamp: new Date(),\n      };\n      setMessages((prev) => [...prev, errorMessage]);\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const stopListeningAndProcess = useCallback(async () => {\n    if (micTimeoutRef.current) {\n      clearTimeout(micTimeoutRef.current);\n      micTimeoutRef.current = null;\n    }\n    \n    if (!isListeningRef.current) return;\n    \n    isListeningRef.current = false;\n    setIsListening(false);\n    pulseScale.value = withSpring(1);\n    \n    if (isProcessing) return;\n    \n    const sttResult = simulateFasterWhisperSTT(language);\n    setInputText(sttResult.text);\n    \n    const sttMessage: Message = {\n      id: Date.now().toString() + \"_stt\",\n      text: `Heard: \"${sttResult.text}\" (${Math.round(sttResult.confidence * 100)}% confidence)`,\n      isUser: true,\n      timestamp: new Date(),\n    };\n    setMessages((prev) => [...prev, sttMessage]);\n    \n    setIsProcessing(true);\n    try {\n      const response = await processVoiceQuery(sttResult.text, language);\n      \n      const assistantMessage: Message = {\n        id: (Date.now() + 1).toString(),\n        text: response.text,\n        isUser: false,\n        timestamp: new Date(),\n        usedLocalFallback: response.usedLocalFallback,\n      };\n\n      setMessages((prev) => [...prev, assistantMessage]);\n      \n      handleSpeakMessage(assistantMessage.id, response.text);\n    } catch (error) {\n      const errorMessage: Message = {\n        id: (Date.now() + 1).toString(),\n        text: \"Sorry, I couldn't process your request. Please try again.\",\n        isUser: false,\n        timestamp: new Date(),\n      };\n      setMessages((prev) => [...prev, errorMessage]);\n    } finally {\n      setIsProcessing(false);\n    }\n  }, [language, isProcessing, pulseScale]);\n\n  const handleMicPress = async () => {\n    if (isListeningRef.current) {\n      await stopListeningAndProcess();\n    } else {\n      if (micTimeoutRef.current) {\n        clearTimeout(micTimeoutRef.current);\n      }\n      \n      isListeningRef.current = true;\n      setIsListening(true);\n      pulseScale.value = withRepeat(\n        withSequence(\n          withSpring(1.3, { damping: 10 }),\n          withSpring(1, { damping: 10 })\n        ),\n        -1,\n        true\n      );\n      \n      micTimeoutRef.current = setTimeout(() => {\n        if (isListeningRef.current) {\n          stopListeningAndProcess();\n        }\n      }, 3000);\n    }\n  };\n\n  const handleSpeakMessage = async (messageId: string, text: string) => {\n    if (isSpeaking && speakingMessageId === messageId) {\n      await stopSpeaking();\n      setIsSpeaking(false);\n      setSpeakingMessageId(null);\n      return;\n    }\n    \n    if (isSpeaking) {\n      await stopSpeaking();\n    }\n    \n    setIsSpeaking(true);\n    setSpeakingMessageId(messageId);\n    \n    await speakText(text, {\n      language,\n      rate: 0.9,\n      onDone: () => {\n        setIsSpeaking(false);\n        setSpeakingMessageId(null);\n      },\n      onError: () => {\n        setIsSpeaking(false);\n        setSpeakingMessageId(null);\n      },\n    });\n  };\n\n  const languageLabels = {\n    en: \"EN\",\n    uz: \"UZ\",\n    ru: \"RU\",\n  };\n\n  return (\n    <>\n      <AnimatedPressable\n        onPress={handlePress}\n        onPressIn={handlePressIn}\n        onPressOut={handlePressOut}\n        accessibilityLabel=\"Open voice assistant\"\n        accessibilityRole=\"button\"\n        style={[\n          styles.fab,\n          {\n            backgroundColor: theme.secondary,\n            bottom: TAB_BAR_HEIGHT + insets.bottom + Spacing.lg,\n          },\n          Shadows.large,\n          animatedButtonStyle,\n        ]}\n      >\n        <Feather name=\"mic\" size={24} color=\"#FFFFFF\" />\n      </AnimatedPressable>\n\n      <Modal\n        visible={isModalVisible}\n        animationType=\"slide\"\n        transparent\n        onRequestClose={() => setIsModalVisible(false)}\n      >\n        <View style={styles.modalOverlay}>\n          <ThemedView style={[styles.modalContainer, { paddingBottom: insets.bottom }]}>\n            <View style={styles.modalHeader}>\n              <ThemedText type=\"h3\">Voice Assistant</ThemedText>\n              <View style={styles.headerRight}>\n                <Pressable\n                  style={[styles.languageButton, { backgroundColor: theme.backgroundSecondary }]}\n                  onPress={() => {\n                    const langs: Array<\"en\" | \"uz\" | \"ru\"> = [\"en\", \"uz\", \"ru\"];\n                    const currentIndex = langs.indexOf(language);\n                    setLanguage(langs[(currentIndex + 1) % langs.length]);\n                  }}\n                >\n                  <ThemedText type=\"label\">{languageLabels[language]}</ThemedText>\n                </Pressable>\n                <Pressable\n                  onPress={() => setIsModalVisible(false)}\n                  style={styles.closeButton}\n                >\n                  <Feather name=\"x\" size={24} color={theme.text} />\n                </Pressable>\n              </View>\n            </View>\n\n            <ScrollView\n              style={styles.messagesContainer}\n              contentContainerStyle={styles.messagesContent}\n            >\n              {messages.length === 0 ? (\n                <View style={styles.emptyChat}>\n                  <View style={[styles.emptyIcon, { backgroundColor: theme.backgroundSecondary }]}>\n                    <Feather name=\"message-circle\" size={32} color={theme.primary} />\n                  </View>\n                  <ThemedText type=\"body\" style={[styles.emptyText, { color: theme.textSecondary }]}>\n                    Ask me about medications, interactions, or finding pharmacies\n                  </ThemedText>\n                </View>\n              ) : (\n                messages.map((message) => (\n                  <View key={message.id}>\n                    <View\n                      style={[\n                        styles.messageBubble,\n                        message.isUser\n                          ? [styles.userBubble, { backgroundColor: theme.primary }]\n                          : [styles.assistantBubble, { backgroundColor: theme.backgroundSecondary }],\n                      ]}\n                    >\n                      <ThemedText\n                        type=\"body\"\n                        style={message.isUser ? styles.userText : undefined}\n                      >\n                        {message.text}\n                      </ThemedText>\n                      {!message.isUser ? (\n                        <Pressable\n                          onPress={() => handleSpeakMessage(message.id, message.text)}\n                          style={[\n                            styles.speakButton,\n                            {\n                              backgroundColor: speakingMessageId === message.id ? theme.primary : theme.backgroundTertiary,\n                            },\n                          ]}\n                        >\n                          <Feather\n                            name={speakingMessageId === message.id ? \"volume-x\" : \"volume-2\"}\n                            size={14}\n                            color={speakingMessageId === message.id ? \"#FFFFFF\" : theme.text}\n                          />\n                        </Pressable>\n                      ) : null}\n                    </View>\n                    {!message.isUser && message.usedLocalFallback ? (\n                      <View style={styles.fallbackBadge}>\n                        <Feather name=\"cpu\" size={10} color={theme.textSecondary} />\n                        <ThemedText type=\"caption\" style={{ color: theme.textSecondary, marginLeft: 4, fontSize: 10 }}>\n                          On-device response\n                        </ThemedText>\n                      </View>\n                    ) : null}\n                  </View>\n                ))\n              )}\n              {isProcessing ? (\n                <View style={[styles.messageBubble, styles.assistantBubble, { backgroundColor: theme.backgroundSecondary }]}>\n                  <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n                    Thinking...\n                  </ThemedText>\n                </View>\n              ) : null}\n            </ScrollView>\n\n            <View style={[styles.inputContainer, { backgroundColor: theme.backgroundSecondary }]}>\n              <TextInput\n                style={[styles.input, { color: theme.text }]}\n                placeholder=\"Type your question...\"\n                placeholderTextColor={theme.textSecondary}\n                value={inputText}\n                onChangeText={setInputText}\n                onSubmitEditing={handleSend}\n                returnKeyType=\"send\"\n                multiline\n              />\n              <View style={styles.inputButtons}>\n                <Pressable\n                  onPress={handleMicPress}\n                  style={[\n                    styles.micButton,\n                    {\n                      backgroundColor: isListening ? theme.error : theme.backgroundTertiary,\n                    },\n                  ]}\n                >\n                  {isListening ? (\n                    <Animated.View style={[styles.pulseRing, animatedPulseStyle, { borderColor: theme.error }]} />\n                  ) : null}\n                  <Feather\n                    name={isListening ? \"mic-off\" : \"mic\"}\n                    size={20}\n                    color={isListening ? \"#FFFFFF\" : theme.text}\n                  />\n                </Pressable>\n                <Pressable\n                  onPress={handleSend}\n                  disabled={!inputText.trim() || isProcessing}\n                  style={[\n                    styles.sendButton,\n                    {\n                      backgroundColor: inputText.trim() ? theme.primary : theme.backgroundTertiary,\n                    },\n                  ]}\n                >\n                  <Feather\n                    name=\"send\"\n                    size={20}\n                    color={inputText.trim() ? \"#FFFFFF\" : theme.textSecondary}\n                  />\n                </Pressable>\n              </View>\n            </View>\n\n            {Platform.OS === \"web\" ? (\n              <ThemedText type=\"caption\" style={[styles.webNote, { color: theme.textSecondary }]}>\n                Voice input works best in Expo Go on your device\n              </ThemedText>\n            ) : null}\n          </ThemedView>\n        </View>\n      </Modal>\n    </>\n  );\n}\n\nconst styles = StyleSheet.create({\n  fab: {\n    position: \"absolute\",\n    right: Spacing.xl,\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    zIndex: 100,\n  },\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n    justifyContent: \"flex-end\",\n  },\n  modalContainer: {\n    height: \"70%\",\n    borderTopLeftRadius: BorderRadius.xl,\n    borderTopRightRadius: BorderRadius.xl,\n  },\n  modalHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    padding: Spacing.lg,\n    borderBottomWidth: 1,\n    borderBottomColor: \"rgba(128, 128, 128, 0.2)\",\n  },\n  headerRight: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.sm,\n  },\n  languageButton: {\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.sm,\n  },\n  closeButton: {\n    padding: Spacing.xs,\n  },\n  messagesContainer: {\n    flex: 1,\n  },\n  messagesContent: {\n    padding: Spacing.lg,\n    gap: Spacing.md,\n  },\n  emptyChat: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingVertical: Spacing[\"4xl\"],\n  },\n  emptyIcon: {\n    width: 64,\n    height: 64,\n    borderRadius: 32,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginBottom: Spacing.lg,\n  },\n  emptyText: {\n    textAlign: \"center\",\n    maxWidth: 250,\n  },\n  messageBubble: {\n    maxWidth: \"80%\",\n    padding: Spacing.md,\n    borderRadius: BorderRadius.lg,\n  },\n  userBubble: {\n    alignSelf: \"flex-end\",\n    borderBottomRightRadius: Spacing.xs,\n  },\n  assistantBubble: {\n    alignSelf: \"flex-start\",\n    borderBottomLeftRadius: Spacing.xs,\n  },\n  userText: {\n    color: \"#FFFFFF\",\n  },\n  speakButton: {\n    position: \"absolute\",\n    bottom: Spacing.xs,\n    right: Spacing.xs,\n    width: 28,\n    height: 28,\n    borderRadius: 14,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  inputContainer: {\n    flexDirection: \"row\",\n    alignItems: \"flex-end\",\n    margin: Spacing.lg,\n    padding: Spacing.sm,\n    borderRadius: BorderRadius.lg,\n    gap: Spacing.sm,\n  },\n  input: {\n    flex: 1,\n    fontSize: 16,\n    maxHeight: 100,\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.sm,\n  },\n  inputButtons: {\n    flexDirection: \"row\",\n    gap: Spacing.sm,\n  },\n  micButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  pulseRing: {\n    position: \"absolute\",\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    borderWidth: 2,\n  },\n  sendButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  webNote: {\n    textAlign: \"center\",\n    paddingBottom: Spacing.sm,\n  },\n  fallbackBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    alignSelf: \"flex-start\",\n    marginTop: Spacing.xs,\n    marginLeft: Spacing.sm,\n    opacity: 0.7,\n  },\n});\n","path":null,"size_bytes":16682,"size_tokens":null},"design_guidelines.md":{"content":"# AI-Driven Medication & Pharmacy App - Design Guidelines\n\n## Architecture Decisions\n\n### Authentication\n**No authentication required** - This app prioritizes ease-of-use and immediate access. However, include a comprehensive **Profile/Settings screen** with:\n- User-customizable avatar (generate 3 medical-themed preset avatars: a pill capsule icon, a stethoscope icon, and a medical cross icon with gradient fills)\n- Display name field for personalization\n- Language selection (English, Uzbek, Russian) with auto-detection\n- Currency preference for medical tourism mode\n- App preferences: theme (light/dark), notification settings, measurement units\n- Family/caregiver linking code generator (optional feature for sharing adherence data)\n\n### Navigation Architecture\n**Tab Navigation (5 tabs)** - The app has multiple distinct feature areas requiring easy switching:\n\nTab structure (left to right):\n1. **Home** - Dashboard with recent scans, reminders, and gamification progress\n2. **Interactions** - Drug interaction checker and safety alerts\n3. **Scanner** (Center tab with elevated style) - Core pill recognition camera\n4. **Pharmacy** - Map-based pharmacy locator with inventory\n5. **Profile** - Settings, rewards, family panel\n\n**Floating Action Button:** Voice assistant accessible from all tabs (bottom-right corner with microphone icon)\n\n## Screen Specifications\n\n### 1. Home Screen (Dashboard)\n- **Purpose:** Quick access to medication status, reminders, and gamification progress\n- **Layout:**\n  - Transparent header with greeting \"Good morning, [Name]\" and notification bell (right button)\n  - Scrollable main content area\n  - Safe area insets: top = insets.top + Spacing.xl, bottom = tabBarHeight + Spacing.xl\n- **Components:**\n  - Today's medication card (list of scheduled doses with checkboxes)\n  - Gamification progress bar with current points and next reward\n  - Recent scans carousel (horizontal scroll of last 5 scanned pills)\n  - Quick stats: adherence streak, pills scanned this week\n  - Batch recall alert banner (if applicable, dismissible)\n- **Visual hierarchy:** Cards with subtle elevation (shadowOpacity: 0.05), primary action colors for due medications\n\n### 2. Scanner Screen (Camera)\n- **Purpose:** Visual pill recognition using device camera\n- **Layout:**\n  - Full-screen camera view with AR overlay\n  - Custom header with close button (left) and flash toggle (right), transparent background\n  - Safe area insets: top = insets.top + Spacing.md, bottom = Spacing.xxl\n- **Components:**\n  - Camera viewfinder with centered reticle for pill positioning\n  - AR overlay highlighting detected pill edges\n  - Capture button (large, centered at bottom with pill capsule icon)\n  - Gallery access button (bottom-left for importing pill photos)\n  - Real-time detection indicator (top: \"Scanning...\" or \"Pill detected\")\n- **Floating elements:**\n  - Results modal slides up from bottom after successful scan\n  - Modal contains: pill name, dosage, manufacturer, safety warnings, interaction check button\n\n### 3. Drug Interactions Screen\n- **Purpose:** Multi-drug interaction analysis and safety checking\n- **Layout:**\n  - Default navigation header with title \"Drug Interactions\" and info button (right)\n  - Scrollable form\n  - Safe area insets: top = Spacing.xl, bottom = tabBarHeight + Spacing.xl\n- **Components:**\n  - Medication input section (add pills via scan or manual search)\n  - List of added medications (each with delete swipe action)\n  - \"Check Interactions\" primary button (below medication list)\n  - Results section with severity badges (minor/moderate/major color-coded)\n  - Expandable cards for each interaction with management advice\n  - Personalized safety alerts section (age, pregnancy, allergies based on profile)\n\n### 4. Pharmacy Locator Screen\n- **Purpose:** Find verified pharmacies with real-time inventory\n- **Layout:**\n  - Transparent header with search bar and filter button (right)\n  - Full-screen Mapbox map with bottom sheet overlay\n  - Safe area insets: top = headerHeight + Spacing.md\n- **Components:**\n  - Interactive Mapbox map with pharmacy markers (color-coded: verified green, unverified gray)\n  - Bottom sheet (draggable, 40% initial height) listing nearby pharmacies\n  - Each pharmacy card: name, distance, walking time, inventory status, price, verification badge\n  - Filter chips: 24/7, in-stock, verified only, price range\n  - Directions button launches navigation\n  - Price anomaly warning icon (red exclamation) for suspicious listings\n\n### 5. Voice Assistant (Floating Modal)\n- **Purpose:** Conversational medication queries via speech\n- **Layout:**\n  - Native modal from bottom (70% screen height)\n  - Header with close button and language selector\n  - Safe area insets: top = Spacing.xl, bottom = insets.bottom + Spacing.xl\n- **Components:**\n  - Animated waveform visualization during listening\n  - Large microphone button (hold to speak, release to process)\n  - Conversation history (chat bubbles: user on right, assistant on left)\n  - Language indicator badge (UZ/EN/RU)\n  - Auto-detect toggle in header\n  - Speaker icon for playing TTS responses\n\n### 6. Profile & Settings Screen\n- **Purpose:** User preferences, gamification rewards, family panel\n- **Layout:**\n  - Default header with title \"Profile\"\n  - Scrollable content\n  - Safe area insets: top = Spacing.xl, bottom = tabBarHeight + Spacing.xl\n- **Components:**\n  - Avatar and name card at top (editable on tap)\n  - Gamification section: total points, current level, progress to next tier, rewards catalog button\n  - Settings sections:\n    - Personal (age, pregnancy status, allergies, chronic conditions)\n    - Preferences (language, currency, theme, units)\n    - Notifications (reminders, recall alerts, family updates)\n    - Family panel (linked caregivers, invite code generator)\n  - About section (version, privacy policy, terms)\n\n### 7. Medication Reminders Screen (Stack navigation from Home)\n- **Purpose:** Schedule and track medication doses\n- **Layout:**\n  - Default header with title \"Reminders\" and add button (right)\n  - Scrollable list\n  - Safe area insets: top = Spacing.xl, bottom = tabBarHeight + Spacing.xl\n- **Components:**\n  - Calendar view (week view with today highlighted)\n  - Daily dose list grouped by time\n  - Each reminder card: medication name, dosage, time, checkbox for completion\n  - Adherence calendar (monthly grid showing taken/missed doses)\n  - Add reminder button opens modal form (medication, time, frequency, duration)\n\n### 8. Rewards & Gamification Screen (Stack from Profile)\n- **Purpose:** View achievements and redeem points\n- **Layout:**\n  - Custom header with gradient background showing current points balance\n  - Scrollable content\n  - Safe area insets: top = headerHeight + Spacing.xl, bottom = tabBarHeight + Spacing.xl\n- **Components:**\n  - Level progress bar with milestone markers\n  - Achievement badges grid (unlocked/locked states)\n  - Streaks section (current streak flame icon with day count)\n  - Rewards catalog (cards with point cost, redemption button, description)\n  - Activity log (recent point-earning actions)\n\n## Design System\n\n### Color Palette (Material Design 3 - Medical Theme)\n**Primary:** #2E7D32 (Medical Green - trust, health, growth)\n**Secondary:** #1976D2 (Professional Blue - reliability)\n**Accent:** #FF6F00 (Alert Orange - warnings, notifications)\n**Error:** #D32F2F (Critical Red - severe interactions, counterfeits)\n**Success:** #388E3C (Confirmation Green)\n**Background:** #FAFAFA (Light), #121212 (Dark)\n**Surface:** #FFFFFF (Light), #1E1E1E (Dark)\n**Text Primary:** #212121 (Light), #FFFFFF (Dark)\n**Text Secondary:** #757575 (Light), #B0B0B0 (Dark)\n\n### Typography (Accessibility-focused)\n- **Display:** 32pt, Bold (screen titles)\n- **Headline:** 24pt, Semibold (section headers)\n- **Title:** 20pt, Medium (card titles)\n- **Body:** 18pt, Regular (main content - larger for readability)\n- **Label:** 16pt, Medium (buttons, labels)\n- **Caption:** 14pt, Regular (helper text)\n\n### Spacing Scale\n- xs: 4, sm: 8, md: 12, lg: 16, xl: 24, xxl: 32\n\n### Component Styles\n**Cards:** \n- Background: surface color\n- Border radius: 16\n- Padding: Spacing.lg\n- Subtle elevation: shadowOpacity 0.05, shadowRadius 4, shadowOffset {width: 0, height: 2}\n\n**Buttons (Primary):**\n- Background: primary color\n- Border radius: 12\n- Padding: {vertical: 14, horizontal: 24}\n- Label: 16pt medium\n- Press state: opacity 0.8\n\n**Floating Action Button (Voice Assistant):**\n- Size: 56x56\n- Background: secondary color\n- Border radius: 28\n- Icon: microphone (Feather)\n- Shadow: shadowOpacity 0.10, shadowRadius 2, shadowOffset {width: 0, height: 2}\n\n**Interaction Severity Badges:**\n- Minor: background #FFF3E0, text #E65100\n- Moderate: background #FFE0B2, text #EF6C00\n- Major: background #FFCDD2, text #C62828\n\n### Icons\n- Use Feather icons from @expo/vector-icons exclusively\n- Common icons: camera, pill (circle), map-pin, mic, bell, settings, check-circle, alert-triangle\n- Icon size: 24 for inline, 32 for headers, 48 for primary actions\n\n### Critical Assets to Generate\n1. **Pill Recognition Demo:** 3 sample pill images (different shapes: round tablet, oval capsule, oblong pill) for onboarding/tutorial\n2. **Profile Avatars:** 3 medical-themed preset avatars (capsule, stethoscope, medical cross with gradients)\n3. **Pharmacy Verification Badge:** Green checkmark shield icon for verified pharmacies\n4. **Gamification Achievements:** 6 badge icons (first scan, 7-day streak, 10 reports, 50 scans, interaction detective, medication master)\n5. **Empty States:** Illustrations for no scans yet, no interactions found, no nearby pharmacies\n\n### Accessibility\n- Minimum touch target: 44x44 (iOS) / 48x48 (Android)\n- Color contrast ratio: 4.5:1 for text, 3:1 for UI elements\n- Support system font scaling up to 200%\n- Screen reader labels for all interactive elements\n- High contrast mode option in settings\n- Haptic feedback for scan success, interaction warnings, reminder alerts","path":null,"size_bytes":9958,"size_tokens":null},"screens/RemindersScreen.tsx":{"content":"import React, { useState, useEffect, useCallback } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  Pressable,\n  Modal,\n  TextInput,\n  ScrollView,\n  Platform,\n} from \"react-native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { useFocusEffect } from \"@react-navigation/native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport * as Haptics from \"expo-haptics\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { ReminderCard } from \"@/components/ReminderCard\";\nimport { Button } from \"@/components/Button\";\nimport { Card } from \"@/components/Card\";\nimport { EmptyState } from \"@/components/EmptyState\";\nimport Spacer from \"@/components/Spacer\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Shadows } from \"@/constants/theme\";\nimport { HomeStackParamList } from \"@/navigation/HomeStackNavigator\";\nimport {\n  getReminders,\n  saveReminder,\n  deleteReminder,\n  markReminderTaken,\n  Reminder,\n  generateId,\n} from \"@/utils/storage\";\nimport {\n  scheduleReminderNotification,\n  cancelReminderNotification,\n  calculateAdherenceStats,\n  getAdherenceColor,\n  getAdherenceLabel,\n  requestNotificationPermissions,\n  checkNotificationPermissions,\n  AdherenceStats,\n} from \"@/utils/notifications\";\n\ntype RemindersScreenProps = {\n  navigation: NativeStackNavigationProp<HomeStackParamList, \"Reminders\">;\n};\n\nconst DAYS_OF_WEEK = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n\nfunction generateCalendarDays(year: number, month: number): (Date | null)[] {\n  const firstDay = new Date(year, month, 1);\n  const lastDay = new Date(year, month + 1, 0);\n  const daysInMonth = lastDay.getDate();\n  const startDayOfWeek = firstDay.getDay();\n  \n  const days: (Date | null)[] = [];\n  \n  for (let i = 0; i < startDayOfWeek; i++) {\n    days.push(null);\n  }\n  \n  for (let day = 1; day <= daysInMonth; day++) {\n    days.push(new Date(year, month, day));\n  }\n  \n  return days;\n}\n\nexport default function RemindersScreen({ navigation }: RemindersScreenProps) {\n  const { theme, isDark } = useTheme();\n  const [reminders, setReminders] = useState<Reminder[]>([]);\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [isModalVisible, setIsModalVisible] = useState(false);\n  const [showCalendar, setShowCalendar] = useState(false);\n  const [calendarMonth, setCalendarMonth] = useState(new Date());\n  const [adherenceStats, setAdherenceStats] = useState<AdherenceStats | null>(null);\n  const [notificationStatus, setNotificationStatus] = useState<\"granted\" | \"denied\" | \"undetermined\">(\"undetermined\");\n  const [newReminder, setNewReminder] = useState({\n    medicationName: \"\",\n    dosage: \"\",\n    time: \"08:00\",\n  });\n\n  const loadReminders = useCallback(async () => {\n    const data = await getReminders();\n    setReminders(data);\n    const stats = calculateAdherenceStats(data);\n    setAdherenceStats(stats);\n  }, []);\n\n  const checkNotifications = useCallback(async () => {\n    const status = await checkNotificationPermissions();\n    setNotificationStatus(status);\n  }, []);\n\n  useFocusEffect(\n    useCallback(() => {\n      loadReminders();\n      checkNotifications();\n    }, [loadReminders, checkNotifications])\n  );\n\n  const handleToggle = async (id: string) => {\n    if (Platform.OS !== \"web\") {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    const dateStr = selectedDate.toISOString().split(\"T\")[0];\n    await markReminderTaken(id, dateStr);\n    await loadReminders();\n  };\n\n  const handleEnableNotifications = async () => {\n    const granted = await requestNotificationPermissions();\n    if (granted) {\n      setNotificationStatus(\"granted\");\n      for (const reminder of reminders) {\n        if (reminder.isEnabled) {\n          await scheduleReminderNotification(reminder);\n        }\n      }\n      if (Platform.OS !== \"web\") {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n      }\n    } else {\n      setNotificationStatus(\"denied\");\n    }\n  };\n\n  const handleAddReminder = async () => {\n    if (!newReminder.medicationName.trim()) return;\n\n    const reminder: Reminder = {\n      id: generateId(),\n      medicationId: generateId(),\n      medicationName: newReminder.medicationName.trim(),\n      dosage: newReminder.dosage.trim() || \"As prescribed\",\n      time: newReminder.time,\n      frequency: \"daily\",\n      isEnabled: true,\n      takenDates: [],\n    };\n\n    await saveReminder(reminder);\n    \n    if (notificationStatus === \"granted\") {\n      await scheduleReminderNotification(reminder);\n    }\n    \n    await loadReminders();\n\n    setNewReminder({ medicationName: \"\", dosage: \"\", time: \"08:00\" });\n    setIsModalVisible(false);\n\n    if (Platform.OS !== \"web\") {\n      Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n    }\n  };\n\n  const handleDeleteReminder = async (id: string) => {\n    await cancelReminderNotification(id);\n    await deleteReminder(id);\n    await loadReminders();\n    if (Platform.OS !== \"web\") {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n  };\n\n  const today = new Date().toISOString().split(\"T\")[0];\n  const selectedDateStr = selectedDate.toISOString().split(\"T\")[0];\n  \n  const todayReminders = reminders.filter((r) => r.isEnabled);\n  const takenToday = todayReminders.filter((r) => r.takenDates.includes(selectedDateStr));\n\n  const currentWeekDates = Array.from({ length: 7 }, (_, i) => {\n    const date = new Date();\n    const dayOfWeek = date.getDay();\n    const diff = i - dayOfWeek;\n    const newDate = new Date(date);\n    newDate.setDate(date.getDate() + diff);\n    return newDate;\n  });\n\n  const getAdherenceForDate = (date: Date) => {\n    const dateStr = date.toISOString().split(\"T\")[0];\n    const taken = reminders.filter((r) => r.takenDates.includes(dateStr)).length;\n    const total = reminders.filter((r) => r.isEnabled).length;\n    if (total === 0) return null;\n    return taken / total;\n  };\n\n  const calendarDays = generateCalendarDays(\n    calendarMonth.getFullYear(),\n    calendarMonth.getMonth()\n  );\n\n  const navigateMonth = (direction: number) => {\n    const newMonth = new Date(calendarMonth);\n    newMonth.setMonth(newMonth.getMonth() + direction);\n    setCalendarMonth(newMonth);\n  };\n\n  return (\n    <>\n      <ScreenScrollView>\n        {notificationStatus !== \"granted\" && Platform.OS !== \"web\" && (\n          <>\n            <Card style={[styles.notificationBanner, { borderColor: theme.accent }]}>\n              <View style={styles.notificationContent}>\n                <View style={[styles.notificationIcon, { backgroundColor: theme.accent + \"20\" }]}>\n                  <Feather name=\"bell-off\" size={20} color={theme.accent} />\n                </View>\n                <View style={styles.notificationTextContainer}>\n                  <ThemedText type=\"label\">Enable Notifications</ThemedText>\n                  <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                    Get reminded when it's time to take your medications\n                  </ThemedText>\n                </View>\n              </View>\n              <Spacer height={Spacing.md} />\n              <Button \n                onPress={handleEnableNotifications} \n                variant=\"secondary\"\n                size=\"small\"\n              >\n                Enable Notifications\n              </Button>\n            </Card>\n            <Spacer height={Spacing.lg} />\n          </>\n        )}\n\n        {adherenceStats && reminders.length > 0 && (\n          <>\n            <Card style={styles.statsCard}>\n              <View style={styles.statsHeader}>\n                <ThemedText type=\"h4\">Adherence Overview</ThemedText>\n                <Pressable onPress={() => setShowCalendar(!showCalendar)}>\n                  <Feather \n                    name={showCalendar ? \"list\" : \"calendar\"} \n                    size={20} \n                    color={theme.primary} \n                  />\n                </Pressable>\n              </View>\n              \n              <Spacer height={Spacing.lg} />\n              \n              <View style={styles.statsGrid}>\n                <View style={styles.statItem}>\n                  <View style={styles.statCircle}>\n                    <ThemedText \n                      type=\"h3\" \n                      style={{ color: getAdherenceColor(adherenceStats.weeklyAdherence) }}\n                    >\n                      {Math.round(adherenceStats.weeklyAdherence)}%\n                    </ThemedText>\n                  </View>\n                  <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                    This Week\n                  </ThemedText>\n                  <ThemedText \n                    type=\"caption\" \n                    style={{ color: getAdherenceColor(adherenceStats.weeklyAdherence) }}\n                  >\n                    {getAdherenceLabel(adherenceStats.weeklyAdherence)}\n                  </ThemedText>\n                </View>\n                \n                <View style={styles.statDivider} />\n                \n                <View style={styles.statItem}>\n                  <View style={[styles.streakBadge, { backgroundColor: theme.primary + \"20\" }]}>\n                    <Feather name=\"zap\" size={16} color={theme.primary} />\n                    <ThemedText type=\"h4\" style={{ marginLeft: Spacing.xs }}>\n                      {adherenceStats.currentStreak}\n                    </ThemedText>\n                  </View>\n                  <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                    Day Streak\n                  </ThemedText>\n                  <ThemedText type=\"caption\" style={{ color: theme.primary }}>\n                    Best: {adherenceStats.longestStreak} days\n                  </ThemedText>\n                </View>\n                \n                <View style={styles.statDivider} />\n                \n                <View style={styles.statItem}>\n                  <ThemedText type=\"h3\" style={{ color: theme.success }}>\n                    {adherenceStats.totalDosesTaken}\n                  </ThemedText>\n                  <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                    Doses Taken\n                  </ThemedText>\n                  <ThemedText type=\"caption\" style={{ color: theme.error }}>\n                    {adherenceStats.totalDosesMissed} missed\n                  </ThemedText>\n                </View>\n              </View>\n            </Card>\n            <Spacer height={Spacing.lg} />\n          </>\n        )}\n\n        {showCalendar && reminders.length > 0 ? (\n          <>\n            <Card style={styles.calendarCard}>\n              <View style={styles.calendarHeader}>\n                <Pressable onPress={() => navigateMonth(-1)} style={styles.calendarNavButton}>\n                  <Feather name=\"chevron-left\" size={24} color={theme.text} />\n                </Pressable>\n                <ThemedText type=\"h4\">\n                  {calendarMonth.toLocaleDateString(undefined, { \n                    month: \"long\", \n                    year: \"numeric\" \n                  })}\n                </ThemedText>\n                <Pressable onPress={() => navigateMonth(1)} style={styles.calendarNavButton}>\n                  <Feather name=\"chevron-right\" size={24} color={theme.text} />\n                </Pressable>\n              </View>\n              \n              <Spacer height={Spacing.md} />\n              \n              <View style={styles.calendarDaysHeader}>\n                {DAYS_OF_WEEK.map((day) => (\n                  <View key={day} style={styles.calendarDayHeader}>\n                    <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                      {day}\n                    </ThemedText>\n                  </View>\n                ))}\n              </View>\n              \n              <View style={styles.calendarGrid}>\n                {calendarDays.map((date, index) => {\n                  if (!date) {\n                    return <View key={`empty-${index}`} style={styles.calendarDay} />;\n                  }\n                  \n                  const dateStr = date.toISOString().split(\"T\")[0];\n                  const isToday = dateStr === today;\n                  const isSelected = dateStr === selectedDateStr;\n                  const adherence = getAdherenceForDate(date);\n                  const isFuture = date > new Date();\n                  \n                  return (\n                    <Pressable\n                      key={dateStr}\n                      onPress={() => {\n                        setSelectedDate(date);\n                        setShowCalendar(false);\n                      }}\n                      style={[\n                        styles.calendarDay,\n                        isToday && { borderWidth: 2, borderColor: theme.primary },\n                        isSelected && { backgroundColor: theme.primary },\n                      ]}\n                    >\n                      <ThemedText\n                        type=\"body\"\n                        style={[\n                          { color: isFuture ? theme.textSecondary : theme.text },\n                          isSelected && { color: \"#FFFFFF\" },\n                        ]}\n                      >\n                        {date.getDate()}\n                      </ThemedText>\n                      {adherence !== null && !isFuture ? (\n                        <View\n                          style={[\n                            styles.calendarAdherenceDot,\n                            {\n                              backgroundColor:\n                                adherence >= 1\n                                  ? theme.success\n                                  : adherence > 0\n                                  ? theme.accent\n                                  : theme.error,\n                            },\n                          ]}\n                        />\n                      ) : null}\n                    </Pressable>\n                  );\n                })}\n              </View>\n              \n              <Spacer height={Spacing.md} />\n              \n              <View style={styles.calendarLegend}>\n                <View style={styles.legendItem}>\n                  <View style={[styles.legendDot, { backgroundColor: theme.success }]} />\n                  <ThemedText type=\"caption\">All taken</ThemedText>\n                </View>\n                <View style={styles.legendItem}>\n                  <View style={[styles.legendDot, { backgroundColor: theme.accent }]} />\n                  <ThemedText type=\"caption\">Partial</ThemedText>\n                </View>\n                <View style={styles.legendItem}>\n                  <View style={[styles.legendDot, { backgroundColor: theme.error }]} />\n                  <ThemedText type=\"caption\">Missed</ThemedText>\n                </View>\n              </View>\n            </Card>\n            <Spacer height={Spacing.lg} />\n          </>\n        ) : (\n          <>\n            <View style={styles.weekContainer}>\n              {currentWeekDates.map((date, index) => {\n                const dateStr = date.toISOString().split(\"T\")[0];\n                const isSelected = dateStr === selectedDateStr;\n                const isToday = dateStr === today;\n                const adherence = getAdherenceForDate(date);\n\n                return (\n                  <Pressable\n                    key={index}\n                    onPress={() => setSelectedDate(date)}\n                    style={[\n                      styles.dayItem,\n                      isSelected && { backgroundColor: theme.primary },\n                    ]}\n                  >\n                    <ThemedText\n                      type=\"caption\"\n                      style={[\n                        styles.dayLabel,\n                        { color: isSelected ? \"#FFFFFF\" : theme.textSecondary },\n                      ]}\n                    >\n                      {DAYS_OF_WEEK[date.getDay()]}\n                    </ThemedText>\n                    <ThemedText\n                      type=\"h4\"\n                      style={[\n                        styles.dayNumber,\n                        { color: isSelected ? \"#FFFFFF\" : theme.text },\n                      ]}\n                    >\n                      {date.getDate()}\n                    </ThemedText>\n                    {adherence !== null ? (\n                      <View\n                        style={[\n                          styles.adherenceDot,\n                          {\n                            backgroundColor:\n                              adherence >= 1\n                                ? theme.success\n                                : adherence > 0\n                                ? theme.accent\n                                : theme.error,\n                          },\n                        ]}\n                      />\n                    ) : (\n                      <View style={styles.adherenceDot} />\n                    )}\n                  </Pressable>\n                );\n              })}\n            </View>\n\n            <Spacer height={Spacing.xl} />\n          </>\n        )}\n\n        <View style={styles.summaryRow}>\n          <ThemedText type=\"h3\">\n            {selectedDateStr === today\n              ? \"Today's Medications\"\n              : selectedDate.toLocaleDateString(undefined, {\n                  weekday: \"long\",\n                  month: \"short\",\n                  day: \"numeric\",\n                })}\n          </ThemedText>\n          <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n            {takenToday.length}/{todayReminders.length} taken\n          </ThemedText>\n        </View>\n\n        <Spacer height={Spacing.lg} />\n\n        {reminders.length === 0 ? (\n          <EmptyState\n            icon=\"bell\"\n            title=\"No Reminders Yet\"\n            description=\"Add medication reminders to stay on track with your treatment\"\n            actionLabel=\"Add Reminder\"\n            onAction={() => setIsModalVisible(true)}\n          />\n        ) : (\n          <View style={styles.remindersList}>\n            {todayReminders.map((reminder) => (\n              <View key={reminder.id} style={styles.reminderItem}>\n                <ReminderCard\n                  reminder={reminder}\n                  onToggle={handleToggle}\n                  onPress={() => {}}\n                  isTaken={reminder.takenDates.includes(selectedDateStr)}\n                />\n                <Pressable\n                  onPress={() => handleDeleteReminder(reminder.id)}\n                  style={[styles.deleteButton, { backgroundColor: theme.error + \"20\" }]}\n                >\n                  <Feather name=\"trash-2\" size={16} color={theme.error} />\n                </Pressable>\n              </View>\n            ))}\n          </View>\n        )}\n\n        <Spacer height={Spacing[\"3xl\"]} />\n      </ScreenScrollView>\n\n      <Pressable\n        onPress={() => setIsModalVisible(true)}\n        style={[styles.fab, { backgroundColor: theme.primary }, Shadows.large]}\n        accessibilityLabel=\"Add medication reminder\"\n        accessibilityRole=\"button\"\n      >\n        <Feather name=\"plus\" size={24} color=\"#FFFFFF\" />\n      </Pressable>\n\n      <Modal\n        visible={isModalVisible}\n        animationType=\"slide\"\n        transparent\n        onRequestClose={() => setIsModalVisible(false)}\n      >\n        <View style={styles.modalOverlay}>\n          <ThemedView style={styles.modalContent}>\n            <View style={styles.modalHeader}>\n              <ThemedText type=\"h3\">Add Reminder</ThemedText>\n              <Pressable onPress={() => setIsModalVisible(false)}>\n                <Feather name=\"x\" size={24} color={theme.text} />\n              </Pressable>\n            </View>\n\n            <Spacer height={Spacing.xl} />\n\n            <ThemedText type=\"label\">Medication Name</ThemedText>\n            <Spacer height={Spacing.sm} />\n            <TextInput\n              style={[\n                styles.input,\n                { backgroundColor: theme.backgroundSecondary, color: theme.text },\n              ]}\n              placeholder=\"e.g., Acetaminophen\"\n              placeholderTextColor={theme.textSecondary}\n              value={newReminder.medicationName}\n              onChangeText={(text) =>\n                setNewReminder({ ...newReminder, medicationName: text })\n              }\n            />\n\n            <Spacer height={Spacing.lg} />\n\n            <ThemedText type=\"label\">Dosage</ThemedText>\n            <Spacer height={Spacing.sm} />\n            <TextInput\n              style={[\n                styles.input,\n                { backgroundColor: theme.backgroundSecondary, color: theme.text },\n              ]}\n              placeholder=\"e.g., 500mg\"\n              placeholderTextColor={theme.textSecondary}\n              value={newReminder.dosage}\n              onChangeText={(text) =>\n                setNewReminder({ ...newReminder, dosage: text })\n              }\n            />\n\n            <Spacer height={Spacing.lg} />\n\n            <ThemedText type=\"label\">Time</ThemedText>\n            <Spacer height={Spacing.sm} />\n            <View style={styles.timePickerRow}>\n              {[\"08:00\", \"12:00\", \"18:00\", \"22:00\"].map((time) => (\n                <Pressable\n                  key={time}\n                  onPress={() => setNewReminder({ ...newReminder, time })}\n                  style={[\n                    styles.timeChip,\n                    {\n                      backgroundColor:\n                        newReminder.time === time\n                          ? theme.primary\n                          : theme.backgroundSecondary,\n                    },\n                  ]}\n                >\n                  <ThemedText\n                    type=\"label\"\n                    style={{\n                      color: newReminder.time === time ? \"#FFFFFF\" : theme.text,\n                    }}\n                  >\n                    {time}\n                  </ThemedText>\n                </Pressable>\n              ))}\n            </View>\n\n            <Spacer height={Spacing[\"2xl\"]} />\n\n            <Button onPress={handleAddReminder}>Add Reminder</Button>\n          </ThemedView>\n        </View>\n      </Modal>\n    </>\n  );\n}\n\nconst styles = StyleSheet.create({\n  notificationBanner: {\n    borderWidth: 1,\n    borderStyle: \"dashed\",\n  },\n  notificationContent: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  notificationIcon: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  notificationTextContainer: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n  statsCard: {\n    padding: Spacing.lg,\n  },\n  statsHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n  },\n  statsGrid: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n  },\n  statItem: {\n    flex: 1,\n    alignItems: \"center\",\n  },\n  statCircle: {\n    marginBottom: Spacing.xs,\n  },\n  streakBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.lg,\n    marginBottom: Spacing.xs,\n  },\n  statDivider: {\n    width: 1,\n    height: 60,\n    backgroundColor: \"rgba(128, 128, 128, 0.2)\",\n  },\n  calendarCard: {\n    padding: Spacing.lg,\n  },\n  calendarHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n  },\n  calendarNavButton: {\n    padding: Spacing.sm,\n  },\n  calendarDaysHeader: {\n    flexDirection: \"row\",\n  },\n  calendarDayHeader: {\n    flex: 1,\n    alignItems: \"center\",\n    paddingVertical: Spacing.sm,\n  },\n  calendarGrid: {\n    flexDirection: \"row\",\n    flexWrap: \"wrap\",\n  },\n  calendarDay: {\n    width: \"14.28%\",\n    aspectRatio: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    borderRadius: BorderRadius.md,\n  },\n  calendarAdherenceDot: {\n    position: \"absolute\",\n    bottom: 4,\n    width: 4,\n    height: 4,\n    borderRadius: 2,\n  },\n  calendarLegend: {\n    flexDirection: \"row\",\n    justifyContent: \"center\",\n    gap: Spacing.lg,\n  },\n  legendItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.xs,\n  },\n  legendDot: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n  },\n  weekContainer: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n  },\n  dayItem: {\n    alignItems: \"center\",\n    paddingVertical: Spacing.md,\n    paddingHorizontal: Spacing.sm,\n    borderRadius: BorderRadius.lg,\n    minWidth: 44,\n  },\n  dayLabel: {\n    marginBottom: Spacing.xs,\n  },\n  dayNumber: {},\n  adherenceDot: {\n    width: 6,\n    height: 6,\n    borderRadius: 3,\n    marginTop: Spacing.sm,\n  },\n  summaryRow: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n  },\n  remindersList: {\n    gap: Spacing.md,\n  },\n  reminderItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.sm,\n  },\n  deleteButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  fab: {\n    position: \"absolute\",\n    right: Spacing.xl,\n    bottom: 100,\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: \"rgba(0,0,0,0.5)\",\n    justifyContent: \"flex-end\",\n  },\n  modalContent: {\n    borderTopLeftRadius: BorderRadius.xl,\n    borderTopRightRadius: BorderRadius.xl,\n    padding: Spacing.xl,\n    paddingBottom: Spacing[\"4xl\"],\n  },\n  modalHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n  },\n  input: {\n    height: 48,\n    borderRadius: BorderRadius.md,\n    paddingHorizontal: Spacing.lg,\n    fontSize: 16,\n  },\n  timePickerRow: {\n    flexDirection: \"row\",\n    gap: Spacing.sm,\n  },\n  timeChip: {\n    flex: 1,\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.md,\n    alignItems: \"center\",\n  },\n});\n","path":null,"size_bytes":26100,"size_tokens":null},"components/Spacer.tsx":{"content":"import { View } from \"react-native\";\n\ntype Props = {\n  width?: number;\n  height?: number;\n};\n\nexport default function Spacer(props: Props) {\n  const width: number = props.width ?? 1;\n  const height: number = props.height ?? 1;\n\n  return (\n    <View\n      style={{\n        width,\n        height,\n      }}\n    />\n  );\n}\n","path":null,"size_bytes":318,"size_tokens":null},"navigation/HomeStackNavigator.tsx":{"content":"import React from \"react\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport HomeScreen from \"@/screens/HomeScreen\";\nimport RemindersScreen from \"@/screens/RemindersScreen\";\nimport MedicationDetailScreen from \"@/screens/MedicationDetailScreen\";\nimport { HeaderTitle } from \"@/components/HeaderTitle\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { getCommonScreenOptions } from \"@/navigation/screenOptions\";\n\nexport type HomeStackParamList = {\n  Home: undefined;\n  Reminders: undefined;\n  MedicationDetail: { medicationId: string };\n};\n\nconst Stack = createNativeStackNavigator<HomeStackParamList>();\n\nexport default function HomeStackNavigator() {\n  const { theme, isDark } = useTheme();\n\n  return (\n    <Stack.Navigator\n      screenOptions={{\n        ...getCommonScreenOptions({ theme, isDark }),\n      }}\n    >\n      <Stack.Screen\n        name=\"Home\"\n        component={HomeScreen}\n        options={{\n          headerTitle: () => <HeaderTitle title=\"MediScan AI\" />,\n        }}\n      />\n      <Stack.Screen\n        name=\"Reminders\"\n        component={RemindersScreen}\n        options={{ headerTitle: \"Reminders\" }}\n      />\n      <Stack.Screen\n        name=\"MedicationDetail\"\n        component={MedicationDetailScreen}\n        options={{ headerTitle: \"Medication Details\" }}\n      />\n    </Stack.Navigator>\n  );\n}\n","path":null,"size_bytes":1358,"size_tokens":null},"utils/drugDatabase.ts":{"content":"export interface DrugInfo {\n  id: string;\n  name: string;\n  genericName: string;\n  manufacturer: string;\n  dosage: string;\n  shape: string;\n  color: string;\n  imprint?: string;\n  description: string;\n  warnings: string[];\n  sideEffects: string[];\n  interactions: string[];\n  pregnancyCategory: string;\n  category: string;\n}\n\nexport interface DrugPriceData {\n  drugId: string;\n  genericName: string;\n  averagePrice: number;\n  minPrice: number;\n  maxPrice: number;\n  stdDeviation: number;\n  priceHistory: number[];\n  currency: string;\n}\n\nexport const DRUG_PRICE_DATABASE: DrugPriceData[] = [\n  { drugId: \"drug_1\", genericName: \"Acetaminophen\", averagePrice: 8.50, minPrice: 4.00, maxPrice: 15.00, stdDeviation: 2.50, priceHistory: [7.50, 8.00, 8.50, 9.00, 8.25], currency: \"USD\" },\n  { drugId: \"drug_2\", genericName: \"Ibuprofen\", averagePrice: 9.00, minPrice: 5.00, maxPrice: 16.00, stdDeviation: 2.80, priceHistory: [8.00, 8.50, 9.00, 9.50, 10.00], currency: \"USD\" },\n  { drugId: \"drug_3\", genericName: \"Amoxicillin\", averagePrice: 15.00, minPrice: 8.00, maxPrice: 25.00, stdDeviation: 4.00, priceHistory: [14.00, 14.50, 15.00, 15.50, 16.00], currency: \"USD\" },\n  { drugId: \"drug_4\", genericName: \"Lisinopril\", averagePrice: 12.00, minPrice: 6.00, maxPrice: 20.00, stdDeviation: 3.50, priceHistory: [11.00, 11.50, 12.00, 12.50, 12.00], currency: \"USD\" },\n  { drugId: \"drug_5\", genericName: \"Metformin\", averagePrice: 10.00, minPrice: 4.00, maxPrice: 18.00, stdDeviation: 3.00, priceHistory: [9.50, 10.00, 10.50, 9.00, 10.00], currency: \"USD\" },\n  { drugId: \"drug_6\", genericName: \"Omeprazole\", averagePrice: 18.00, minPrice: 10.00, maxPrice: 30.00, stdDeviation: 5.00, priceHistory: [17.00, 17.50, 18.00, 18.50, 19.00], currency: \"USD\" },\n  { drugId: \"drug_7\", genericName: \"Atorvastatin\", averagePrice: 25.00, minPrice: 12.00, maxPrice: 45.00, stdDeviation: 8.00, priceHistory: [23.00, 24.00, 25.00, 26.00, 25.50], currency: \"USD\" },\n  { drugId: \"drug_8\", genericName: \"Amlodipine\", averagePrice: 14.00, minPrice: 7.00, maxPrice: 24.00, stdDeviation: 4.00, priceHistory: [13.50, 14.00, 14.50, 13.00, 14.00], currency: \"USD\" },\n  { drugId: \"drug_9\", genericName: \"Levothyroxine\", averagePrice: 16.00, minPrice: 8.00, maxPrice: 28.00, stdDeviation: 5.00, priceHistory: [15.00, 15.50, 16.00, 16.50, 17.00], currency: \"USD\" },\n  { drugId: \"drug_10\", genericName: \"Gabapentin\", averagePrice: 22.00, minPrice: 10.00, maxPrice: 40.00, stdDeviation: 7.00, priceHistory: [20.00, 21.00, 22.00, 23.00, 22.50], currency: \"USD\" },\n  { drugId: \"drug_11\", genericName: \"Sertraline\", averagePrice: 20.00, minPrice: 10.00, maxPrice: 35.00, stdDeviation: 6.00, priceHistory: [18.00, 19.00, 20.00, 21.00, 20.50], currency: \"USD\" },\n  { drugId: \"drug_12\", genericName: \"Hydrochlorothiazide\", averagePrice: 8.00, minPrice: 4.00, maxPrice: 14.00, stdDeviation: 2.50, priceHistory: [7.50, 8.00, 8.50, 7.00, 8.00], currency: \"USD\" },\n  { drugId: \"drug_13\", genericName: \"Losartan\", averagePrice: 18.00, minPrice: 9.00, maxPrice: 30.00, stdDeviation: 5.00, priceHistory: [17.00, 17.50, 18.00, 18.50, 18.00], currency: \"USD\" },\n  { drugId: \"drug_14\", genericName: \"Pantoprazole\", averagePrice: 20.00, minPrice: 12.00, maxPrice: 32.00, stdDeviation: 5.00, priceHistory: [19.00, 19.50, 20.00, 20.50, 21.00], currency: \"USD\" },\n  { drugId: \"drug_15\", genericName: \"Prednisone\", averagePrice: 12.00, minPrice: 5.00, maxPrice: 22.00, stdDeviation: 4.00, priceHistory: [11.00, 11.50, 12.00, 12.50, 12.00], currency: \"USD\" },\n  { drugId: \"drug_16\", genericName: \"Alprazolam\", averagePrice: 25.00, minPrice: 15.00, maxPrice: 40.00, stdDeviation: 6.00, priceHistory: [24.00, 24.50, 25.00, 25.50, 26.00], currency: \"USD\" },\n];\n\nexport function getDrugPriceData(drugId: string): DrugPriceData | undefined {\n  return DRUG_PRICE_DATABASE.find(p => p.drugId === drugId);\n}\n\nexport function getDrugPriceByGeneric(genericName: string): DrugPriceData | undefined {\n  return DRUG_PRICE_DATABASE.find(p => \n    p.genericName.toLowerCase() === genericName.toLowerCase()\n  );\n}\n\nexport interface DrugInteraction {\n  drug1: string;\n  drug2: string;\n  severity: \"minor\" | \"moderate\" | \"major\";\n  description: string;\n  management: string;\n}\n\nexport const SAMPLE_DRUGS: DrugInfo[] = [\n  {\n    id: \"drug_1\",\n    name: \"Acetaminophen 500mg\",\n    genericName: \"Acetaminophen\",\n    manufacturer: \"Generic Pharmaceuticals\",\n    dosage: \"500mg\",\n    shape: \"round\",\n    color: \"white\",\n    imprint: \"TYLENOL 500\",\n    description: \"Pain reliever and fever reducer\",\n    warnings: [\"Do not exceed 4000mg in 24 hours\", \"Avoid alcohol\", \"May cause liver damage\"],\n    sideEffects: [\"Nausea\", \"Stomach pain\", \"Loss of appetite\"],\n    interactions: [\"Warfarin\", \"Alcohol\", \"Isoniazid\"],\n    pregnancyCategory: \"B\",\n    category: \"Analgesic\",\n  },\n  {\n    id: \"drug_2\",\n    name: \"Ibuprofen 200mg\",\n    genericName: \"Ibuprofen\",\n    manufacturer: \"Advil Pharmaceuticals\",\n    dosage: \"200mg\",\n    shape: \"oval\",\n    color: \"brown\",\n    imprint: \"ADVIL\",\n    description: \"NSAID for pain, fever, and inflammation\",\n    warnings: [\"Not recommended during pregnancy\", \"May cause stomach bleeding\", \"Take with food\"],\n    sideEffects: [\"Stomach upset\", \"Dizziness\", \"Rash\"],\n    interactions: [\"Aspirin\", \"Blood thinners\", \"ACE inhibitors\"],\n    pregnancyCategory: \"D\",\n    category: \"NSAID\",\n  },\n  {\n    id: \"drug_3\",\n    name: \"Amoxicillin 500mg\",\n    genericName: \"Amoxicillin\",\n    manufacturer: \"Antibiotics Inc.\",\n    dosage: \"500mg\",\n    shape: \"capsule\",\n    color: \"pink/red\",\n    imprint: \"AMOX 500\",\n    description: \"Antibiotic for bacterial infections\",\n    warnings: [\"Complete full course\", \"May cause allergic reactions\", \"Store in cool place\"],\n    sideEffects: [\"Diarrhea\", \"Nausea\", \"Rash\"],\n    interactions: [\"Methotrexate\", \"Birth control pills\", \"Warfarin\"],\n    pregnancyCategory: \"B\",\n    category: \"Antibiotic\",\n  },\n  {\n    id: \"drug_4\",\n    name: \"Lisinopril 10mg\",\n    genericName: \"Lisinopril\",\n    manufacturer: \"Cardio Pharma\",\n    dosage: \"10mg\",\n    shape: \"round\",\n    color: \"pink\",\n    imprint: \"L 10\",\n    description: \"ACE inhibitor for blood pressure\",\n    warnings: [\"May cause dizziness\", \"Do not use during pregnancy\", \"Monitor potassium levels\"],\n    sideEffects: [\"Dry cough\", \"Dizziness\", \"Fatigue\"],\n    interactions: [\"Potassium supplements\", \"NSAIDs\", \"Lithium\"],\n    pregnancyCategory: \"D\",\n    category: \"Antihypertensive\",\n  },\n  {\n    id: \"drug_5\",\n    name: \"Metformin 500mg\",\n    genericName: \"Metformin\",\n    manufacturer: \"Diabetes Care\",\n    dosage: \"500mg\",\n    shape: \"oval\",\n    color: \"white\",\n    imprint: \"MET 500\",\n    description: \"Oral diabetes medicine\",\n    warnings: [\"Take with meals\", \"May cause lactic acidosis\", \"Monitor kidney function\"],\n    sideEffects: [\"Nausea\", \"Diarrhea\", \"Stomach upset\"],\n    interactions: [\"Contrast dye\", \"Alcohol\", \"Cimetidine\"],\n    pregnancyCategory: \"B\",\n    category: \"Antidiabetic\",\n  },\n  {\n    id: \"drug_6\",\n    name: \"Omeprazole 20mg\",\n    genericName: \"Omeprazole\",\n    manufacturer: \"Gastro Pharma\",\n    dosage: \"20mg\",\n    shape: \"capsule\",\n    color: \"purple\",\n    imprint: \"PRILOSEC 20\",\n    description: \"Proton pump inhibitor for acid reflux\",\n    warnings: [\"Long-term use may affect calcium absorption\", \"Take before meals\"],\n    sideEffects: [\"Headache\", \"Stomach pain\", \"Nausea\"],\n    interactions: [\"Clopidogrel\", \"Methotrexate\", \"Digoxin\"],\n    pregnancyCategory: \"C\",\n    category: \"PPI\",\n  },\n];\n\nexport const SAMPLE_INTERACTIONS: DrugInteraction[] = [\n  {\n    drug1: \"Acetaminophen\",\n    drug2: \"Warfarin\",\n    severity: \"moderate\",\n    description: \"Acetaminophen may increase the anticoagulant effect of warfarin\",\n    management: \"Monitor INR more frequently when starting or stopping acetaminophen\",\n  },\n  {\n    drug1: \"Ibuprofen\",\n    drug2: \"Aspirin\",\n    severity: \"major\",\n    description: \"NSAIDs may interfere with the cardioprotective effects of aspirin\",\n    management: \"Take aspirin at least 30 minutes before ibuprofen or 8 hours after\",\n  },\n  {\n    drug1: \"Lisinopril\",\n    drug2: \"Ibuprofen\",\n    severity: \"moderate\",\n    description: \"NSAIDs may reduce the antihypertensive effect of ACE inhibitors\",\n    management: \"Monitor blood pressure and consider alternative pain relief\",\n  },\n  {\n    drug1: \"Metformin\",\n    drug2: \"Alcohol\",\n    severity: \"major\",\n    description: \"Alcohol increases the risk of lactic acidosis with metformin\",\n    management: \"Limit alcohol consumption while taking metformin\",\n  },\n  {\n    drug1: \"Omeprazole\",\n    drug2: \"Clopidogrel\",\n    severity: \"major\",\n    description: \"Omeprazole may reduce the effectiveness of clopidogrel\",\n    management: \"Consider using pantoprazole as an alternative PPI\",\n  },\n  {\n    drug1: \"Amoxicillin\",\n    drug2: \"Warfarin\",\n    severity: \"moderate\",\n    description: \"Antibiotics may increase the anticoagulant effect of warfarin\",\n    management: \"Monitor INR more frequently during antibiotic treatment\",\n  },\n];\n\nexport function searchDrugs(query: string): DrugInfo[] {\n  const lowerQuery = query.toLowerCase();\n  return SAMPLE_DRUGS.filter(\n    (drug) =>\n      drug.name.toLowerCase().includes(lowerQuery) ||\n      drug.genericName.toLowerCase().includes(lowerQuery) ||\n      drug.imprint?.toLowerCase().includes(lowerQuery)\n  );\n}\n\nexport function getDrugById(id: string): DrugInfo | undefined {\n  return SAMPLE_DRUGS.find((drug) => drug.id === id);\n}\n\nexport function checkInteractions(drugNames: string[]): DrugInteraction[] {\n  const interactions: DrugInteraction[] = [];\n  \n  for (let i = 0; i < drugNames.length; i++) {\n    for (let j = i + 1; j < drugNames.length; j++) {\n      const drug1 = drugNames[i].toLowerCase();\n      const drug2 = drugNames[j].toLowerCase();\n      \n      const found = SAMPLE_INTERACTIONS.filter(\n        (interaction) =>\n          (interaction.drug1.toLowerCase().includes(drug1) ||\n            interaction.drug1.toLowerCase().includes(drug2)) &&\n          (interaction.drug2.toLowerCase().includes(drug1) ||\n            interaction.drug2.toLowerCase().includes(drug2))\n      );\n      \n      interactions.push(...found);\n    }\n  }\n  \n  return interactions;\n}\n\nexport function simulatePillRecognition(): DrugInfo {\n  const randomIndex = Math.floor(Math.random() * SAMPLE_DRUGS.length);\n  return SAMPLE_DRUGS[randomIndex];\n}\n\nexport function checkSafetyForProfile(\n  drug: DrugInfo,\n  profile: { isPregnant?: boolean; allergies: string[]; age?: number }\n): string[] {\n  const alerts: string[] = [];\n  \n  if (profile.isPregnant && (drug.pregnancyCategory === \"D\" || drug.pregnancyCategory === \"X\")) {\n    alerts.push(`Warning: ${drug.name} is not recommended during pregnancy (Category ${drug.pregnancyCategory})`);\n  }\n  \n  if (profile.allergies.length > 0) {\n    const drugLower = drug.genericName.toLowerCase();\n    const hasAllergy = profile.allergies.some((allergy) =>\n      drugLower.includes(allergy.toLowerCase())\n    );\n    if (hasAllergy) {\n      alerts.push(`Alert: You may be allergic to ${drug.genericName}`);\n    }\n  }\n  \n  if (profile.age && profile.age > 65) {\n    if (drug.category === \"NSAID\") {\n      alerts.push(`Caution: NSAIDs may increase risk of bleeding in patients over 65`);\n    }\n  }\n  \n  return alerts;\n}\n\nexport const COMPREHENSIVE_DRUG_DATABASE: DrugInfo[] = [\n  {\n    id: \"drug_7\",\n    name: \"Atorvastatin 20mg\",\n    genericName: \"Atorvastatin\",\n    manufacturer: \"Lipitor Pharma\",\n    dosage: \"20mg\",\n    shape: \"oval\",\n    color: \"white\",\n    imprint: \"ATV 20\",\n    description: \"Statin medication for high cholesterol\",\n    warnings: [\"May cause muscle pain\", \"Avoid grapefruit\", \"Regular liver monitoring\"],\n    sideEffects: [\"Muscle pain\", \"Joint pain\", \"Digestive problems\"],\n    interactions: [\"Gemfibrozil\", \"Clarithromycin\", \"Grapefruit juice\"],\n    pregnancyCategory: \"X\",\n    category: \"Statin\",\n  },\n  {\n    id: \"drug_8\",\n    name: \"Amlodipine 5mg\",\n    genericName: \"Amlodipine\",\n    manufacturer: \"Norvasc Labs\",\n    dosage: \"5mg\",\n    shape: \"round\",\n    color: \"white\",\n    imprint: \"AML 5\",\n    description: \"Calcium channel blocker for blood pressure\",\n    warnings: [\"May cause swelling\", \"Avoid sudden discontinuation\"],\n    sideEffects: [\"Swelling\", \"Dizziness\", \"Flushing\"],\n    interactions: [\"Simvastatin\", \"Cyclosporine\", \"Grapefruit\"],\n    pregnancyCategory: \"C\",\n    category: \"Antihypertensive\",\n  },\n  {\n    id: \"drug_9\",\n    name: \"Levothyroxine 50mcg\",\n    genericName: \"Levothyroxine\",\n    manufacturer: \"Thyroid Care\",\n    dosage: \"50mcg\",\n    shape: \"round\",\n    color: \"white\",\n    imprint: \"SYNTHROID 50\",\n    description: \"Thyroid hormone replacement\",\n    warnings: [\"Take on empty stomach\", \"Consistent timing important\"],\n    sideEffects: [\"Weight changes\", \"Nervousness\", \"Irregular heartbeat\"],\n    interactions: [\"Calcium supplements\", \"Iron\", \"Antacids\"],\n    pregnancyCategory: \"A\",\n    category: \"Thyroid\",\n  },\n  {\n    id: \"drug_10\",\n    name: \"Gabapentin 300mg\",\n    genericName: \"Gabapentin\",\n    manufacturer: \"Neurontin Labs\",\n    dosage: \"300mg\",\n    shape: \"capsule\",\n    color: \"yellow\",\n    imprint: \"NEURONTIN 300\",\n    description: \"Anticonvulsant for nerve pain and seizures\",\n    warnings: [\"May cause drowsiness\", \"Do not stop suddenly\", \"Avoid alcohol\"],\n    sideEffects: [\"Drowsiness\", \"Dizziness\", \"Fatigue\"],\n    interactions: [\"Antacids\", \"Morphine\", \"Hydrocodone\"],\n    pregnancyCategory: \"C\",\n    category: \"Anticonvulsant\",\n  },\n  {\n    id: \"drug_11\",\n    name: \"Sertraline 50mg\",\n    genericName: \"Sertraline\",\n    manufacturer: \"Zoloft Pharma\",\n    dosage: \"50mg\",\n    shape: \"oval\",\n    color: \"blue\",\n    imprint: \"ZOLOFT 50\",\n    description: \"SSRI antidepressant\",\n    warnings: [\"May increase suicidal thoughts in young adults\", \"Avoid alcohol\", \"Do not stop suddenly\"],\n    sideEffects: [\"Nausea\", \"Insomnia\", \"Sexual dysfunction\"],\n    interactions: [\"MAO inhibitors\", \"Tramadol\", \"Pimozide\"],\n    pregnancyCategory: \"C\",\n    category: \"Antidepressant\",\n  },\n  {\n    id: \"drug_12\",\n    name: \"Hydrochlorothiazide 25mg\",\n    genericName: \"Hydrochlorothiazide\",\n    manufacturer: \"Diuretic Labs\",\n    dosage: \"25mg\",\n    shape: \"round\",\n    color: \"peach\",\n    imprint: \"HCTZ 25\",\n    description: \"Thiazide diuretic for blood pressure and edema\",\n    warnings: [\"May cause electrolyte imbalance\", \"Increase sun sensitivity\"],\n    sideEffects: [\"Frequent urination\", \"Dizziness\", \"Weakness\"],\n    interactions: [\"Lithium\", \"Digoxin\", \"NSAIDs\"],\n    pregnancyCategory: \"B\",\n    category: \"Diuretic\",\n  },\n  {\n    id: \"drug_13\",\n    name: \"Losartan 50mg\",\n    genericName: \"Losartan\",\n    manufacturer: \"Cozaar Pharma\",\n    dosage: \"50mg\",\n    shape: \"oval\",\n    color: \"green\",\n    imprint: \"COZAAR 50\",\n    description: \"ARB for blood pressure and kidney protection\",\n    warnings: [\"Do not use during pregnancy\", \"Monitor potassium levels\"],\n    sideEffects: [\"Dizziness\", \"Fatigue\", \"Upper respiratory infection\"],\n    interactions: [\"Potassium supplements\", \"NSAIDs\", \"Lithium\"],\n    pregnancyCategory: \"D\",\n    category: \"Antihypertensive\",\n  },\n  {\n    id: \"drug_14\",\n    name: \"Pantoprazole 40mg\",\n    genericName: \"Pantoprazole\",\n    manufacturer: \"Protonix Labs\",\n    dosage: \"40mg\",\n    shape: \"oval\",\n    color: \"yellow\",\n    imprint: \"PROTONIX 40\",\n    description: \"PPI for acid reflux and GERD\",\n    warnings: [\"Long-term use may affect bone health\", \"Take before meals\"],\n    sideEffects: [\"Headache\", \"Diarrhea\", \"Nausea\"],\n    interactions: [\"Methotrexate\", \"Warfarin\", \"Atazanavir\"],\n    pregnancyCategory: \"B\",\n    category: \"PPI\",\n  },\n  {\n    id: \"drug_15\",\n    name: \"Prednisone 10mg\",\n    genericName: \"Prednisone\",\n    manufacturer: \"Steroid Pharma\",\n    dosage: \"10mg\",\n    shape: \"round\",\n    color: \"white\",\n    imprint: \"PRED 10\",\n    description: \"Corticosteroid for inflammation and immune conditions\",\n    warnings: [\"Do not stop suddenly\", \"May raise blood sugar\", \"Weakens immune system\"],\n    sideEffects: [\"Weight gain\", \"Mood changes\", \"Insomnia\"],\n    interactions: [\"NSAIDs\", \"Diabetes medications\", \"Blood thinners\"],\n    pregnancyCategory: \"C\",\n    category: \"Corticosteroid\",\n  },\n  {\n    id: \"drug_16\",\n    name: \"Alprazolam 0.5mg\",\n    genericName: \"Alprazolam\",\n    manufacturer: \"Xanax Labs\",\n    dosage: \"0.5mg\",\n    shape: \"oval\",\n    color: \"orange\",\n    imprint: \"XANAX 0.5\",\n    description: \"Benzodiazepine for anxiety disorders\",\n    warnings: [\"Habit forming\", \"Avoid alcohol\", \"May cause severe withdrawal\"],\n    sideEffects: [\"Drowsiness\", \"Memory problems\", \"Coordination issues\"],\n    interactions: [\"Opioids\", \"Alcohol\", \"Antidepressants\"],\n    pregnancyCategory: \"D\",\n    category: \"Benzodiazepine\",\n  },\n];\n\nexport const EXTENDED_INTERACTIONS: DrugInteraction[] = [\n  {\n    drug1: \"Atorvastatin\",\n    drug2: \"Gemfibrozil\",\n    severity: \"major\",\n    description: \"Increased risk of severe muscle damage (rhabdomyolysis)\",\n    management: \"Avoid combination; use fenofibrate if fibrate is needed\",\n  },\n  {\n    drug1: \"Sertraline\",\n    drug2: \"Tramadol\",\n    severity: \"major\",\n    description: \"Increased risk of serotonin syndrome and seizures\",\n    management: \"Use with extreme caution; monitor for signs of serotonin syndrome\",\n  },\n  {\n    drug1: \"Lisinopril\",\n    drug2: \"Potassium\",\n    severity: \"moderate\",\n    description: \"ACE inhibitors can increase potassium levels\",\n    management: \"Monitor potassium levels regularly; avoid potassium supplements\",\n  },\n  {\n    drug1: \"Alprazolam\",\n    drug2: \"Opioids\",\n    severity: \"major\",\n    description: \"Increased risk of profound sedation, respiratory depression, and death\",\n    management: \"Avoid combination when possible; use lowest effective doses if needed\",\n  },\n  {\n    drug1: \"Levothyroxine\",\n    drug2: \"Calcium\",\n    severity: \"moderate\",\n    description: \"Calcium reduces levothyroxine absorption\",\n    management: \"Take levothyroxine 4 hours before or after calcium supplements\",\n  },\n  {\n    drug1: \"Metformin\",\n    drug2: \"Contrast dye\",\n    severity: \"major\",\n    description: \"Risk of lactic acidosis when metformin is continued during contrast procedures\",\n    management: \"Stop metformin before contrast procedures; resume 48 hours after with kidney function check\",\n  },\n  {\n    drug1: \"Prednisone\",\n    drug2: \"NSAIDs\",\n    severity: \"moderate\",\n    description: \"Increased risk of GI bleeding and ulceration\",\n    management: \"Use gastroprotective agent if combination is necessary\",\n  },\n  {\n    drug1: \"Warfarin\",\n    drug2: \"Vitamin K\",\n    severity: \"moderate\",\n    description: \"Vitamin K decreases the anticoagulant effect of warfarin\",\n    management: \"Maintain consistent vitamin K intake; monitor INR regularly\",\n  },\n  {\n    drug1: \"Gabapentin\",\n    drug2: \"Morphine\",\n    severity: \"moderate\",\n    description: \"Morphine increases gabapentin levels; both cause CNS depression\",\n    management: \"Monitor for increased sedation; may need dose adjustment\",\n  },\n  {\n    drug1: \"Amlodipine\",\n    drug2: \"Simvastatin\",\n    severity: \"moderate\",\n    description: \"Increased simvastatin levels, higher risk of muscle damage\",\n    management: \"Limit simvastatin to 20mg daily with amlodipine\",\n  },\n  {\n    drug1: \"Losartan\",\n    drug2: \"Lithium\",\n    severity: \"moderate\",\n    description: \"ARBs can increase lithium levels, causing toxicity\",\n    management: \"Monitor lithium levels closely when starting or changing losartan\",\n  },\n  {\n    drug1: \"Hydrochlorothiazide\",\n    drug2: \"Digoxin\",\n    severity: \"moderate\",\n    description: \"Diuretic-induced low potassium increases digoxin toxicity risk\",\n    management: \"Monitor potassium and digoxin levels; consider potassium supplementation\",\n  },\n];\n","path":null,"size_bytes":19639,"size_tokens":null},"components/EmptyState.tsx":{"content":"import React from \"react\";\nimport { StyleSheet, View } from \"react-native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { Button } from \"@/components/Button\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\n\ninterface EmptyStateProps {\n  icon: keyof typeof Feather.glyphMap;\n  title: string;\n  description: string;\n  actionLabel?: string;\n  onAction?: () => void;\n}\n\nexport function EmptyState({\n  icon,\n  title,\n  description,\n  actionLabel,\n  onAction,\n}: EmptyStateProps) {\n  const { theme } = useTheme();\n\n  return (\n    <View style={styles.container}>\n      <View style={[styles.iconContainer, { backgroundColor: theme.backgroundSecondary }]}>\n        <Feather name={icon} size={48} color={theme.primary} />\n      </View>\n      <ThemedText type=\"h3\" style={styles.title}>\n        {title}\n      </ThemedText>\n      <ThemedText\n        type=\"body\"\n        style={[styles.description, { color: theme.textSecondary }]}\n      >\n        {description}\n      </ThemedText>\n      {actionLabel && onAction ? (\n        <Button onPress={onAction} style={styles.button}>\n          {actionLabel}\n        </Button>\n      ) : null}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingHorizontal: Spacing[\"2xl\"],\n    paddingVertical: Spacing[\"4xl\"],\n  },\n  iconContainer: {\n    width: 96,\n    height: 96,\n    borderRadius: BorderRadius[\"2xl\"],\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginBottom: Spacing.xl,\n  },\n  title: {\n    textAlign: \"center\",\n    marginBottom: Spacing.sm,\n  },\n  description: {\n    textAlign: \"center\",\n    marginBottom: Spacing.xl,\n  },\n  button: {\n    minWidth: 160,\n  },\n});\n","path":null,"size_bytes":1828,"size_tokens":null},"screens/InteractionsScreen.tsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  TextInput,\n  Pressable,\n  ActivityIndicator,\n} from \"react-native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { Feather } from \"@expo/vector-icons\";\nimport * as Haptics from \"expo-haptics\";\nimport { Platform } from \"react-native\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { SeverityBadge } from \"@/components/SeverityBadge\";\nimport { Button } from \"@/components/Button\";\nimport Spacer from \"@/components/Spacer\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Shadows, MedicalColors } from \"@/constants/theme\";\nimport { InteractionsStackParamList } from \"@/navigation/InteractionsStackNavigator\";\nimport { getMedications, Medication } from \"@/utils/storage\";\nimport { searchDrugs, SAMPLE_DRUGS, COMPREHENSIVE_DRUG_DATABASE, DrugInfo } from \"@/utils/drugDatabase\";\nimport { checkDrugInteractionsAI, DrugInteractionAIResult } from \"@/utils/aiServices\";\nimport { awardPoints } from \"@/utils/gamification\";\n\ntype InteractionsScreenProps = {\n  navigation: NativeStackNavigationProp<InteractionsStackParamList, \"Interactions\">;\n};\n\nconst RISK_COLORS = {\n  low: \"#4CAF50\",\n  moderate: \"#FF9800\",\n  high: \"#F44336\",\n  critical: \"#B71C1C\",\n};\n\nexport default function InteractionsScreen({ navigation }: InteractionsScreenProps) {\n  const { theme } = useTheme();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedMedications, setSelectedMedications] = useState<string[]>([]);\n  const [searchResults, setSearchResults] = useState<DrugInfo[]>([]);\n  const [showResults, setShowResults] = useState(false);\n  const [isChecking, setIsChecking] = useState(false);\n  const [interactionResults, setInteractionResults] = useState<DrugInteractionAIResult | null>(null);\n  const [scannedMedications, setScannedMedications] = useState<Medication[]>([]);\n\n  useEffect(() => {\n    loadScannedMedications();\n  }, []);\n\n  const loadScannedMedications = async () => {\n    const medications = await getMedications();\n    setScannedMedications(medications);\n  };\n\n  const handleSearch = (text: string) => {\n    setSearchQuery(text);\n    if (text.length >= 2) {\n      const allDrugs = [...SAMPLE_DRUGS, ...COMPREHENSIVE_DRUG_DATABASE];\n      const lowerQuery = text.toLowerCase();\n      const results = allDrugs.filter(\n        (drug) =>\n          drug.name.toLowerCase().includes(lowerQuery) ||\n          drug.genericName.toLowerCase().includes(lowerQuery) ||\n          drug.imprint?.toLowerCase().includes(lowerQuery)\n      );\n      setSearchResults(results);\n      setShowResults(true);\n    } else {\n      setSearchResults([]);\n      setShowResults(false);\n    }\n  };\n\n  const addMedication = (name: string) => {\n    if (!selectedMedications.includes(name)) {\n      setSelectedMedications([...selectedMedications, name]);\n      if (Platform.OS !== \"web\") {\n        Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n      }\n    }\n    setSearchQuery(\"\");\n    setShowResults(false);\n    setInteractionResults(null);\n  };\n\n  const removeMedication = (name: string) => {\n    setSelectedMedications(selectedMedications.filter((m) => m !== name));\n    setInteractionResults(null);\n    if (Platform.OS !== \"web\") {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n  };\n\n  const checkInteractions = async () => {\n    if (selectedMedications.length < 2) return;\n\n    setIsChecking(true);\n    try {\n      const results = await checkDrugInteractionsAI(selectedMedications);\n      setInteractionResults(results);\n      \n      await awardPoints(\"interaction_check\");\n      \n      if (Platform.OS !== \"web\") {\n        if (results.interactions.length > 0) {\n          Haptics.notificationAsync(Haptics.NotificationFeedbackType.Warning);\n        } else {\n          Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n        }\n      }\n    } catch (error) {\n      console.error(\"Error checking interactions:\", error);\n    } finally {\n      setIsChecking(false);\n    }\n  };\n\n  return (\n    <ScreenScrollView>\n      <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n        Add medications to check for potential drug interactions\n      </ThemedText>\n      <Spacer height={Spacing.xl} />\n\n      <View style={styles.searchContainer}>\n        <View\n          style={[\n            styles.searchInputContainer,\n            { backgroundColor: theme.backgroundSecondary },\n          ]}\n        >\n          <Feather name=\"search\" size={20} color={theme.textSecondary} />\n          <TextInput\n            style={[styles.searchInput, { color: theme.text }]}\n            placeholder=\"Search medications...\"\n            placeholderTextColor={theme.textSecondary}\n            value={searchQuery}\n            onChangeText={handleSearch}\n            autoCapitalize=\"none\"\n          />\n          {searchQuery.length > 0 ? (\n            <Pressable onPress={() => handleSearch(\"\")}>\n              <Feather name=\"x\" size={20} color={theme.textSecondary} />\n            </Pressable>\n          ) : null}\n        </View>\n\n        {showResults && searchResults.length > 0 ? (\n          <View\n            style={[\n              styles.resultsDropdown,\n              { backgroundColor: theme.cardBackground },\n              Shadows.medium,\n            ]}\n          >\n            {searchResults.map((drug) => (\n              <Pressable\n                key={drug.id}\n                onPress={() => addMedication(drug.genericName)}\n                style={({ pressed }) => [\n                  styles.resultItem,\n                  { opacity: pressed ? 0.7 : 1 },\n                ]}\n              >\n                <ThemedText type=\"body\">{drug.name}</ThemedText>\n                <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n                  {drug.genericName}\n                </ThemedText>\n              </Pressable>\n            ))}\n          </View>\n        ) : null}\n      </View>\n\n      {scannedMedications.length > 0 && selectedMedications.length === 0 ? (\n        <>\n          <Spacer height={Spacing.xl} />\n          <ThemedText type=\"h4\">From Your Scans</ThemedText>\n          <Spacer height={Spacing.md} />\n          <View style={styles.quickAddGrid}>\n            {scannedMedications.slice(0, 4).map((med) => (\n              <Pressable\n                key={med.id}\n                onPress={() => addMedication(med.genericName)}\n                style={({ pressed }) => [\n                  styles.quickAddChip,\n                  {\n                    backgroundColor: theme.backgroundSecondary,\n                    opacity: pressed ? 0.7 : 1,\n                  },\n                ]}\n              >\n                <Feather name=\"plus\" size={14} color={theme.primary} />\n                <ThemedText type=\"small\" style={{ marginLeft: Spacing.xs }}>\n                  {med.genericName}\n                </ThemedText>\n              </Pressable>\n            ))}\n          </View>\n        </>\n      ) : null}\n\n      <Spacer height={Spacing.xl} />\n\n      <ThemedText type=\"h3\">\n        Selected Medications ({selectedMedications.length})\n      </ThemedText>\n      <Spacer height={Spacing.md} />\n\n      {selectedMedications.length === 0 ? (\n        <View style={[styles.emptySelection, { backgroundColor: theme.cardBackground }]}>\n          <Feather name=\"clipboard\" size={24} color={theme.textSecondary} />\n          <ThemedText\n            type=\"body\"\n            style={[styles.emptyText, { color: theme.textSecondary }]}\n          >\n            No medications selected. Add at least 2 to check interactions.\n          </ThemedText>\n        </View>\n      ) : (\n        <View style={styles.medicationsList}>\n          {selectedMedications.map((med, index) => (\n            <View\n              key={index}\n              style={[\n                styles.medicationChip,\n                { backgroundColor: theme.cardBackground },\n                Shadows.small,\n              ]}\n            >\n              <Feather name=\"disc\" size={16} color={theme.primary} />\n              <ThemedText type=\"body\" style={styles.medicationName}>\n                {med}\n              </ThemedText>\n              <Pressable\n                onPress={() => removeMedication(med)}\n                style={styles.removeButton}\n              >\n                <Feather name=\"x\" size={18} color={theme.error} />\n              </Pressable>\n            </View>\n          ))}\n        </View>\n      )}\n\n      <Spacer height={Spacing.xl} />\n\n      <Button\n        onPress={checkInteractions}\n        disabled={selectedMedications.length < 2 || isChecking}\n      >\n        {isChecking ? \"Checking...\" : \"Check Interactions\"}\n      </Button>\n\n      {interactionResults ? (\n        <>\n          <Spacer height={Spacing[\"2xl\"]} />\n\n          <View\n            style={[\n              styles.riskHeader,\n              {\n                backgroundColor: RISK_COLORS[interactionResults.riskLevel] + \"15\",\n                borderColor: RISK_COLORS[interactionResults.riskLevel],\n              },\n            ]}\n          >\n            <View style={styles.riskRow}>\n              <View style={[styles.riskIndicator, { backgroundColor: RISK_COLORS[interactionResults.riskLevel] }]}>\n                <ThemedText type=\"label\" style={styles.riskText}>\n                  {interactionResults.riskLevel.toUpperCase()} RISK\n                </ThemedText>\n              </View>\n              {interactionResults.aiGenerated ? (\n                <View style={[styles.aiBadge, { backgroundColor: theme.secondary }]}>\n                  <Feather name=\"cpu\" size={12} color=\"#FFFFFF\" />\n                  <ThemedText type=\"caption\" style={styles.aiText}>AI Analysis</ThemedText>\n                </View>\n              ) : null}\n            </View>\n          </View>\n\n          <Spacer height={Spacing.lg} />\n\n          <View\n            style={[\n              styles.summaryCard,\n              {\n                backgroundColor:\n                  interactionResults.interactions.length > 0\n                    ? theme.cardBackground\n                    : theme.success + \"20\",\n              },\n            ]}\n          >\n            <Feather\n              name={\n                interactionResults.interactions.length > 0\n                  ? \"alert-triangle\"\n                  : \"check-circle\"\n              }\n              size={24}\n              color={\n                interactionResults.interactions.length > 0\n                  ? theme.accent\n                  : theme.success\n              }\n            />\n            <ThemedText type=\"body\" style={styles.summaryText}>\n              {interactionResults.summary}\n            </ThemedText>\n          </View>\n\n          {interactionResults.interactions.length > 0 ? (\n            <>\n              <Spacer height={Spacing.xl} />\n              <ThemedText type=\"h3\">Interactions Found</ThemedText>\n              <Spacer height={Spacing.md} />\n\n              {interactionResults.interactions.map((interaction, index) => (\n                <View\n                  key={index}\n                  style={[\n                    styles.interactionCard,\n                    { backgroundColor: theme.cardBackground },\n                    Shadows.small,\n                  ]}\n                >\n                  <View style={styles.interactionHeader}>\n                    <ThemedText type=\"h4\">\n                      {interaction.drug1} + {interaction.drug2}\n                    </ThemedText>\n                    <SeverityBadge severity={interaction.severity} />\n                  </View>\n                  <ThemedText\n                    type=\"body\"\n                    style={[styles.interactionDesc, { color: theme.textSecondary }]}\n                  >\n                    {interaction.description}\n                  </ThemedText>\n                  <View style={styles.managementBox}>\n                    <Feather name=\"info\" size={16} color={theme.secondary} />\n                    <ThemedText type=\"small\" style={styles.managementText}>\n                      {interaction.management}\n                    </ThemedText>\n                  </View>\n                </View>\n              ))}\n            </>\n          ) : null}\n\n          <Spacer height={Spacing.xl} />\n          <ThemedText type=\"h3\">Recommendations</ThemedText>\n          <Spacer height={Spacing.md} />\n\n          {interactionResults.recommendations.map((rec, index) => (\n            <View key={index} style={styles.recommendationItem}>\n              <Feather name=\"check\" size={16} color={theme.success} />\n              <ThemedText type=\"body\" style={styles.recommendationText}>\n                {rec}\n              </ThemedText>\n            </View>\n          ))}\n        </>\n      ) : null}\n\n      <Spacer height={Spacing[\"3xl\"]} />\n    </ScreenScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  searchContainer: {\n    position: \"relative\",\n    zIndex: 100,\n  },\n  searchInputContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.lg,\n    height: 48,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n  },\n  searchInput: {\n    flex: 1,\n    fontSize: 16,\n  },\n  resultsDropdown: {\n    position: \"absolute\",\n    top: 56,\n    left: 0,\n    right: 0,\n    borderRadius: BorderRadius.md,\n    maxHeight: 200,\n    overflow: \"hidden\",\n  },\n  resultItem: {\n    padding: Spacing.md,\n    borderBottomWidth: 1,\n    borderBottomColor: \"rgba(0,0,0,0.05)\",\n  },\n  quickAddGrid: {\n    flexDirection: \"row\",\n    flexWrap: \"wrap\",\n    gap: Spacing.sm,\n  },\n  quickAddChip: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.md,\n  },\n  emptySelection: {\n    alignItems: \"center\",\n    padding: Spacing.xl,\n    borderRadius: BorderRadius.lg,\n  },\n  emptyText: {\n    marginTop: Spacing.md,\n    textAlign: \"center\",\n  },\n  medicationsList: {\n    gap: Spacing.sm,\n  },\n  medicationChip: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: Spacing.md,\n    borderRadius: BorderRadius.md,\n  },\n  medicationName: {\n    flex: 1,\n    marginLeft: Spacing.sm,\n  },\n  removeButton: {\n    padding: Spacing.xs,\n  },\n  summaryCard: {\n    flexDirection: \"row\",\n    alignItems: \"flex-start\",\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.lg,\n  },\n  summaryText: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n  interactionCard: {\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.lg,\n    marginBottom: Spacing.md,\n  },\n  interactionHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"flex-start\",\n    marginBottom: Spacing.sm,\n  },\n  interactionDesc: {\n    marginBottom: Spacing.md,\n  },\n  managementBox: {\n    flexDirection: \"row\",\n    alignItems: \"flex-start\",\n    padding: Spacing.md,\n    backgroundColor: \"rgba(25, 118, 210, 0.1)\",\n    borderRadius: BorderRadius.sm,\n  },\n  managementText: {\n    flex: 1,\n    marginLeft: Spacing.sm,\n  },\n  recommendationItem: {\n    flexDirection: \"row\",\n    alignItems: \"flex-start\",\n    marginBottom: Spacing.sm,\n  },\n  recommendationText: {\n    flex: 1,\n    marginLeft: Spacing.sm,\n  },\n  riskHeader: {\n    borderWidth: 2,\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.md,\n  },\n  riskRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n  },\n  riskIndicator: {\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.md,\n  },\n  riskText: {\n    color: \"#FFFFFF\",\n    fontWeight: \"700\",\n  },\n  aiBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.sm,\n    gap: 4,\n  },\n  aiText: {\n    color: \"#FFFFFF\",\n    fontWeight: \"600\",\n  },\n});\n","path":null,"size_bytes":15875,"size_tokens":null},"screens/CrashScreen.tsx":{"content":"import React from \"react\";\n// @ts-nocheck - Intentional crash for testing error boundary\nexport default function CrashScreen() {\n  const undefinedVariable = someUndefinedVariable.property;\n  return <>{undefinedVariable}</>;\n}\n","path":null,"size_bytes":226,"size_tokens":null},"screens/FamilyPanelScreen.tsx":{"content":"import React, { useState, useEffect, useCallback } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  Pressable,\n  Modal,\n  TextInput,\n  Share,\n  Platform,\n} from \"react-native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { useFocusEffect } from \"@react-navigation/native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport * as Clipboard from \"expo-clipboard\";\nimport * as Haptics from \"expo-haptics\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { MedCard } from \"@/components/MedCard\";\nimport { ProgressBar } from \"@/components/ProgressBar\";\nimport { Button } from \"@/components/Button\";\nimport { EmptyState } from \"@/components/EmptyState\";\nimport Spacer from \"@/components/Spacer\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Shadows } from \"@/constants/theme\";\nimport { ProfileStackParamList } from \"@/navigation/ProfileStackNavigator\";\nimport {\n  getFamilyMembers,\n  saveFamilyMember,\n  generateInviteCode,\n  generateId,\n  FamilyMember,\n  getReminders,\n} from \"@/utils/storage\";\nimport { calculateAdherenceStats, AdherenceStats } from \"@/utils/notifications\";\n\ntype FamilyPanelScreenProps = {\n  navigation: NativeStackNavigationProp<ProfileStackParamList, \"FamilyPanel\">;\n};\n\nexport default function FamilyPanelScreen({ navigation }: FamilyPanelScreenProps) {\n  const { theme } = useTheme();\n  const [familyMembers, setFamilyMembers] = useState<FamilyMember[]>([]);\n  const [inviteCode, setInviteCode] = useState(\"\");\n  const [isModalVisible, setIsModalVisible] = useState(false);\n  const [isJoinModalVisible, setIsJoinModalVisible] = useState(false);\n  const [joinCode, setJoinCode] = useState(\"\");\n  const [adherenceStats, setAdherenceStats] = useState<AdherenceStats | null>(null);\n  const [medicationCount, setMedicationCount] = useState(0);\n  const [newMember, setNewMember] = useState({\n    name: \"\",\n    relationship: \"\",\n  });\n\n  useFocusEffect(\n    useCallback(() => {\n      const loadData = async () => {\n        const [members, reminders] = await Promise.all([\n          getFamilyMembers(),\n          getReminders(),\n        ]);\n        setFamilyMembers(members);\n        setInviteCode(generateInviteCode());\n        setMedicationCount(reminders.filter(r => r.isEnabled).length);\n        setAdherenceStats(calculateAdherenceStats(reminders));\n      };\n      loadData();\n    }, [])\n  );\n\n  const handleCopyCode = async () => {\n    await Clipboard.setStringAsync(inviteCode);\n    if (Platform.OS !== \"web\") {\n      Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n    }\n  };\n\n  const handleShareCode = async () => {\n    try {\n      await Share.share({\n        message: `Join my family group on MediScan AI to monitor medication adherence. Use code: ${inviteCode}`,\n      });\n    } catch (error) {\n      console.error(\"Error sharing:\", error);\n    }\n  };\n\n  const handleAddMember = async () => {\n    if (!newMember.name.trim()) return;\n\n    const member: FamilyMember = {\n      id: generateId(),\n      name: newMember.name.trim(),\n      relationship: newMember.relationship.trim() || \"Family\",\n      inviteCode: generateInviteCode(),\n      isConnected: false,\n      adherencePercentage: 0,\n    };\n\n    await saveFamilyMember(member);\n    const members = await getFamilyMembers();\n    setFamilyMembers(members);\n\n    setNewMember({ name: \"\", relationship: \"\" });\n    setIsModalVisible(false);\n\n    if (Platform.OS !== \"web\") {\n      Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n    }\n  };\n\n  const handleJoinFamily = async () => {\n    if (!joinCode.trim()) return;\n\n    const member: FamilyMember = {\n      id: generateId(),\n      name: \"Connected Member\",\n      relationship: \"Caregiver\",\n      inviteCode: joinCode.trim(),\n      isConnected: true,\n      adherencePercentage: Math.floor(Math.random() * 40) + 60,\n    };\n\n    await saveFamilyMember(member);\n    const members = await getFamilyMembers();\n    setFamilyMembers(members);\n\n    setJoinCode(\"\");\n    setIsJoinModalVisible(false);\n  };\n\n  return (\n    <>\n      <ScreenScrollView>\n        <View style={[styles.inviteCard, { backgroundColor: theme.cardBackground }, Shadows.medium]}>\n          <ThemedText type=\"h4\">Your Invite Code</ThemedText>\n          <Spacer height={Spacing.sm} />\n          <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n            Share this code with family members to let them monitor your medication adherence\n          </ThemedText>\n          <Spacer height={Spacing.lg} />\n\n          <View style={[styles.codeContainer, { backgroundColor: theme.backgroundSecondary }]}>\n            <ThemedText type=\"h2\" style={styles.codeText}>\n              {inviteCode}\n            </ThemedText>\n          </View>\n\n          <Spacer height={Spacing.lg} />\n\n          <View style={styles.buttonRow}>\n            <Pressable\n              onPress={handleCopyCode}\n              style={[styles.actionButton, { backgroundColor: theme.backgroundSecondary }]}\n            >\n              <Feather name=\"copy\" size={20} color={theme.primary} />\n              <ThemedText type=\"label\" style={[styles.actionText, { color: theme.primary }]}>\n                Copy\n              </ThemedText>\n            </Pressable>\n            <Pressable\n              onPress={handleShareCode}\n              style={[styles.actionButton, { backgroundColor: theme.primary }]}\n            >\n              <Feather name=\"share-2\" size={20} color=\"#FFFFFF\" />\n              <ThemedText type=\"label\" style={[styles.actionText, { color: \"#FFFFFF\" }]}>\n                Share\n              </ThemedText>\n            </Pressable>\n          </View>\n        </View>\n\n        <Spacer height={Spacing.xl} />\n\n        <View style={[styles.yourAdherenceCard, { backgroundColor: theme.cardBackground }, Shadows.small]}>\n          <View style={styles.adherenceCardHeader}>\n            <View style={styles.adherenceCardTitle}>\n              <Feather name=\"activity\" size={20} color={theme.primary} />\n              <ThemedText type=\"h4\" style={{ marginLeft: Spacing.sm }}>\n                Your Adherence Summary\n              </ThemedText>\n            </View>\n          </View>\n          <Spacer height={Spacing.md} />\n          <View style={styles.adherenceStatsGrid}>\n            <View style={styles.adherenceStatBox}>\n              <ThemedText type=\"h2\" style={{ color: theme.primary }}>\n                {Math.round(adherenceStats?.weeklyAdherence || 0)}%\n              </ThemedText>\n              <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                This Week\n              </ThemedText>\n            </View>\n            <View style={styles.adherenceStatBox}>\n              <ThemedText type=\"h2\" style={{ color: theme.primary }}>\n                {Math.round(adherenceStats?.monthlyAdherence || 0)}%\n              </ThemedText>\n              <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                This Month\n              </ThemedText>\n            </View>\n            <View style={styles.adherenceStatBox}>\n              <ThemedText type=\"h2\" style={{ color: theme.accent }}>\n                {adherenceStats?.longestStreak || 0}\n              </ThemedText>\n              <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                Best Streak\n              </ThemedText>\n            </View>\n          </View>\n        </View>\n\n        <Spacer height={Spacing.xl} />\n\n        <View style={styles.sectionHeader}>\n          <ThemedText type=\"h3\">Family Members</ThemedText>\n          <Pressable\n            onPress={() => setIsJoinModalVisible(true)}\n            style={({ pressed }) => ({ opacity: pressed ? 0.7 : 1 })}\n          >\n            <ThemedText type=\"link\">Join Family</ThemedText>\n          </Pressable>\n        </View>\n        <Spacer height={Spacing.md} />\n\n        {familyMembers.length === 0 ? (\n          <EmptyState\n            icon=\"users\"\n            title=\"No Family Members\"\n            description=\"Add family members to let them monitor your medication adherence\"\n            actionLabel=\"Add Member\"\n            onAction={() => setIsModalVisible(true)}\n          />\n        ) : (\n          <View style={styles.membersList}>\n            {familyMembers.map((member) => (\n              <View\n                key={member.id}\n                style={[\n                  styles.memberCard,\n                  { backgroundColor: theme.cardBackground },\n                  Shadows.small,\n                ]}\n              >\n                <View style={styles.memberHeader}>\n                  <View\n                    style={[\n                      styles.memberAvatar,\n                      { backgroundColor: member.isConnected ? theme.success : theme.secondary },\n                    ]}\n                  >\n                    <Feather name=\"user\" size={20} color=\"#FFFFFF\" />\n                  </View>\n                  <View style={styles.memberInfo}>\n                    <ThemedText type=\"h4\">{member.name}</ThemedText>\n                    <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n                      {member.relationship}\n                    </ThemedText>\n                  </View>\n                  <View\n                    style={[\n                      styles.statusBadge,\n                      {\n                        backgroundColor: member.isConnected\n                          ? theme.success + \"20\"\n                          : theme.accent + \"20\",\n                      },\n                    ]}\n                  >\n                    <ThemedText\n                      type=\"caption\"\n                      style={{\n                        color: member.isConnected ? theme.success : theme.accent,\n                      }}\n                    >\n                      {member.isConnected ? \"Connected\" : \"Pending\"}\n                    </ThemedText>\n                  </View>\n                </View>\n\n                {member.isConnected ? (\n                  <>\n                    <Spacer height={Spacing.lg} />\n                    <View style={styles.adherenceSection}>\n                      <View style={styles.adherenceHeader}>\n                        <ThemedText type=\"label\">Adherence Rate</ThemedText>\n                        <ThemedText type=\"h4\" style={{ color: theme.primary }}>\n                          {member.adherencePercentage}%\n                        </ThemedText>\n                      </View>\n                      <Spacer height={Spacing.sm} />\n                      <ProgressBar\n                        progress={member.adherencePercentage / 100}\n                        color={\n                          member.adherencePercentage >= 80\n                            ? theme.success\n                            : member.adherencePercentage >= 50\n                            ? theme.accent\n                            : theme.error\n                        }\n                      />\n                    </View>\n\n                    <Spacer height={Spacing.lg} />\n\n                    <View style={styles.statsRow}>\n                      <View style={styles.statItem}>\n                        <ThemedText type=\"h4\">\n                          {adherenceStats?.currentStreak || 0}\n                        </ThemedText>\n                        <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                          Days Streak\n                        </ThemedText>\n                      </View>\n                      <View style={styles.statItem}>\n                        <ThemedText type=\"h4\">{medicationCount}</ThemedText>\n                        <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                          Medications\n                        </ThemedText>\n                      </View>\n                      <View style={styles.statItem}>\n                        <ThemedText type=\"h4\">\n                          {adherenceStats?.totalDosesMissed || 0}\n                        </ThemedText>\n                        <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                          Missed This Week\n                        </ThemedText>\n                      </View>\n                    </View>\n                  </>\n                ) : (\n                  <>\n                    <Spacer height={Spacing.md} />\n                    <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n                      Invite code: {member.inviteCode}\n                    </ThemedText>\n                  </>\n                )}\n              </View>\n            ))}\n          </View>\n        )}\n\n        <Spacer height={Spacing[\"2xl\"]} />\n\n        <Button onPress={() => setIsModalVisible(true)}>Add Family Member</Button>\n\n        <Spacer height={Spacing[\"3xl\"]} />\n      </ScreenScrollView>\n\n      <Modal\n        visible={isModalVisible}\n        animationType=\"slide\"\n        transparent\n        onRequestClose={() => setIsModalVisible(false)}\n      >\n        <View style={styles.modalOverlay}>\n          <ThemedView style={styles.modalContent}>\n            <View style={styles.modalHeader}>\n              <ThemedText type=\"h3\">Add Family Member</ThemedText>\n              <Pressable onPress={() => setIsModalVisible(false)}>\n                <Feather name=\"x\" size={24} color={theme.text} />\n              </Pressable>\n            </View>\n\n            <Spacer height={Spacing.xl} />\n\n            <ThemedText type=\"label\">Name</ThemedText>\n            <Spacer height={Spacing.sm} />\n            <TextInput\n              style={[\n                styles.input,\n                { backgroundColor: theme.backgroundSecondary, color: theme.text },\n              ]}\n              placeholder=\"Enter name\"\n              placeholderTextColor={theme.textSecondary}\n              value={newMember.name}\n              onChangeText={(text) => setNewMember({ ...newMember, name: text })}\n            />\n\n            <Spacer height={Spacing.lg} />\n\n            <ThemedText type=\"label\">Relationship</ThemedText>\n            <Spacer height={Spacing.sm} />\n            <TextInput\n              style={[\n                styles.input,\n                { backgroundColor: theme.backgroundSecondary, color: theme.text },\n              ]}\n              placeholder=\"e.g., Parent, Child, Caregiver\"\n              placeholderTextColor={theme.textSecondary}\n              value={newMember.relationship}\n              onChangeText={(text) => setNewMember({ ...newMember, relationship: text })}\n            />\n\n            <Spacer height={Spacing[\"2xl\"]} />\n\n            <Button onPress={handleAddMember}>Add Member</Button>\n          </ThemedView>\n        </View>\n      </Modal>\n\n      <Modal\n        visible={isJoinModalVisible}\n        animationType=\"slide\"\n        transparent\n        onRequestClose={() => setIsJoinModalVisible(false)}\n      >\n        <View style={styles.modalOverlay}>\n          <ThemedView style={styles.modalContent}>\n            <View style={styles.modalHeader}>\n              <ThemedText type=\"h3\">Join Family</ThemedText>\n              <Pressable onPress={() => setIsJoinModalVisible(false)}>\n                <Feather name=\"x\" size={24} color={theme.text} />\n              </Pressable>\n            </View>\n\n            <Spacer height={Spacing.xl} />\n\n            <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n              Enter the invite code shared by a family member to connect\n            </ThemedText>\n\n            <Spacer height={Spacing.lg} />\n\n            <TextInput\n              style={[\n                styles.input,\n                styles.codeInput,\n                { backgroundColor: theme.backgroundSecondary, color: theme.text },\n              ]}\n              placeholder=\"Enter code\"\n              placeholderTextColor={theme.textSecondary}\n              value={joinCode}\n              onChangeText={setJoinCode}\n              autoCapitalize=\"characters\"\n              maxLength={6}\n            />\n\n            <Spacer height={Spacing[\"2xl\"]} />\n\n            <Button onPress={handleJoinFamily}>Join</Button>\n          </ThemedView>\n        </View>\n      </Modal>\n    </>\n  );\n}\n\nconst styles = StyleSheet.create({\n  inviteCard: {\n    borderRadius: BorderRadius.xl,\n    padding: Spacing.xl,\n  },\n  codeContainer: {\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.lg,\n    alignItems: \"center\",\n  },\n  codeText: {\n    letterSpacing: 4,\n  },\n  buttonRow: {\n    flexDirection: \"row\",\n    gap: Spacing.md,\n  },\n  actionButton: {\n    flex: 1,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n  },\n  actionText: {\n    fontWeight: \"600\",\n  },\n  sectionHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n  },\n  membersList: {\n    gap: Spacing.md,\n  },\n  memberCard: {\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.lg,\n  },\n  memberHeader: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  memberAvatar: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginRight: Spacing.md,\n  },\n  memberInfo: {\n    flex: 1,\n  },\n  statusBadge: {\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.xs,\n  },\n  adherenceSection: {},\n  adherenceHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n  },\n  statsRow: {\n    flexDirection: \"row\",\n    justifyContent: \"space-around\",\n  },\n  statItem: {\n    alignItems: \"center\",\n  },\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: \"rgba(0,0,0,0.5)\",\n    justifyContent: \"flex-end\",\n  },\n  modalContent: {\n    borderTopLeftRadius: BorderRadius.xl,\n    borderTopRightRadius: BorderRadius.xl,\n    padding: Spacing.xl,\n    paddingBottom: Spacing[\"4xl\"],\n  },\n  modalHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n  },\n  input: {\n    height: 48,\n    borderRadius: BorderRadius.md,\n    paddingHorizontal: Spacing.lg,\n    fontSize: 16,\n  },\n  codeInput: {\n    textAlign: \"center\",\n    fontSize: 24,\n    letterSpacing: 4,\n    fontWeight: \"600\",\n  },\n  yourAdherenceCard: {\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.lg,\n  },\n  adherenceCardHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n  },\n  adherenceCardTitle: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  adherenceStatsGrid: {\n    flexDirection: \"row\",\n    justifyContent: \"space-around\",\n  },\n  adherenceStatBox: {\n    alignItems: \"center\",\n  },\n});\n","path":null,"size_bytes":18796,"size_tokens":null},"screens/RewardsScreen.tsx":{"content":"import React, { useState, useEffect, useCallback } from \"react\";\nimport { View, StyleSheet, Pressable, ScrollView } from \"react-native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { useFocusEffect } from \"@react-navigation/native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { LinearGradient } from \"expo-linear-gradient\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { ProgressBar } from \"@/components/ProgressBar\";\nimport Spacer from \"@/components/Spacer\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useScreenInsets } from \"@/hooks/useScreenInsets\";\nimport { Spacing, BorderRadius, Shadows } from \"@/constants/theme\";\nimport { ProfileStackParamList } from \"@/navigation/ProfileStackNavigator\";\nimport { getGamificationData, GamificationData } from \"@/utils/storage\";\nimport { getLatestActivity, getUserStats, ACHIEVEMENTS, ActivityItem, UserStats } from \"@/utils/gamification\";\n\ntype RewardsScreenProps = {\n  navigation: NativeStackNavigationProp<ProfileStackParamList, \"Rewards\">;\n};\n\ninterface Reward {\n  id: string;\n  name: string;\n  description: string;\n  pointsCost: number;\n  icon: keyof typeof Feather.glyphMap;\n}\n\ninterface DisplayAchievement {\n  id: string;\n  name: string;\n  description: string;\n  icon: keyof typeof Feather.glyphMap;\n  unlocked: boolean;\n}\n\nconst REWARDS: Reward[] = [\n  {\n    id: \"discount_5\",\n    name: \"5% Pharmacy Discount\",\n    description: \"Valid at partner pharmacies\",\n    pointsCost: 200,\n    icon: \"percent\",\n  },\n  {\n    id: \"discount_10\",\n    name: \"10% Pharmacy Discount\",\n    description: \"Valid at partner pharmacies\",\n    pointsCost: 500,\n    icon: \"percent\",\n  },\n  {\n    id: \"consultation\",\n    name: \"Free Consultation\",\n    description: \"15-min pharmacist consultation\",\n    pointsCost: 1000,\n    icon: \"phone\",\n  },\n  {\n    id: \"priority\",\n    name: \"Priority Support\",\n    description: \"1 month of priority support\",\n    pointsCost: 750,\n    icon: \"headphones\",\n  },\n];\n\nexport default function RewardsScreen({ navigation }: RewardsScreenProps) {\n  const { theme, isDark } = useTheme();\n  const { paddingTop, paddingBottom } = useScreenInsets();\n  const [gamification, setGamification] = useState<GamificationData | null>(null);\n  const [activities, setActivities] = useState<ActivityItem[]>([]);\n  const [stats, setStats] = useState<UserStats | null>(null);\n\n  useFocusEffect(\n    useCallback(() => {\n      const loadData = async () => {\n        const [data, activityList, userStats] = await Promise.all([\n          getGamificationData(),\n          getLatestActivity(5),\n          getUserStats(),\n        ]);\n        setGamification(data);\n        setActivities(activityList);\n        setStats(userStats);\n      };\n      loadData();\n    }, [])\n  );\n\n  const displayAchievements: DisplayAchievement[] = ACHIEVEMENTS.slice(0, 6).map((a) => ({\n    id: a.id,\n    name: a.name,\n    description: a.description,\n    icon: a.icon as keyof typeof Feather.glyphMap,\n    unlocked: gamification?.achievements.includes(a.id) || false,\n  }));\n\n  const unlockedCount = displayAchievements.filter((a) => a.unlocked).length;\n  const levelProgress = gamification ? (gamification.points % 100) / 100 : 0;\n\n  return (\n    <ThemedView style={styles.container}>\n      <LinearGradient\n        colors={isDark ? [\"#1B5E20\", \"#121212\"] : [\"#2E7D32\", \"#FAFAFA\"]}\n        style={[styles.header, { paddingTop: paddingTop }]}\n      >\n        <ThemedText type=\"display\" style={styles.pointsValue}>\n          {gamification?.points || 0}\n        </ThemedText>\n        <ThemedText type=\"h4\" style={styles.pointsLabel}>\n          Total Points\n        </ThemedText>\n        <Spacer height={Spacing.lg} />\n        <View style={styles.levelContainer}>\n          <View style={styles.levelInfo}>\n            <ThemedText type=\"label\" style={styles.levelText}>\n              Level {gamification?.level || 1}\n            </ThemedText>\n            <ThemedText type=\"small\" style={styles.levelText}>\n              {100 - ((gamification?.points || 0) % 100)} to next level\n            </ThemedText>\n          </View>\n          <ProgressBar\n            progress={levelProgress}\n            height={8}\n            color=\"#FFFFFF\"\n            backgroundColor=\"rgba(255,255,255,0.3)\"\n          />\n        </View>\n      </LinearGradient>\n\n      <ScrollView\n        style={styles.content}\n        contentContainerStyle={[styles.contentContainer, { paddingBottom }]}\n        showsVerticalScrollIndicator={false}\n      >\n        <View style={styles.streakCard}>\n          <View style={[styles.streakIcon, { backgroundColor: theme.accent + \"20\" }]}>\n            <Feather name=\"zap\" size={24} color={theme.accent} />\n          </View>\n          <View style={styles.streakInfo}>\n            <ThemedText type=\"h3\">{gamification?.streak || 0} Day Streak</ThemedText>\n            <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n              Keep taking your medications daily\n            </ThemedText>\n          </View>\n        </View>\n\n        <Spacer height={Spacing.xl} />\n\n        <View style={styles.sectionHeader}>\n          <ThemedText type=\"h3\">Achievements</ThemedText>\n          <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n            {unlockedCount}/{displayAchievements.length} unlocked\n          </ThemedText>\n        </View>\n        <Spacer height={Spacing.md} />\n\n        <View style={styles.achievementsGrid}>\n          {displayAchievements.map((achievement) => (\n            <View\n              key={achievement.id}\n              style={[\n                styles.achievementCard,\n                {\n                  backgroundColor: theme.cardBackground,\n                  opacity: achievement.unlocked ? 1 : 0.5,\n                },\n                Shadows.small,\n              ]}\n            >\n              <View\n                style={[\n                  styles.achievementIcon,\n                  {\n                    backgroundColor: achievement.unlocked\n                      ? theme.primary + \"20\"\n                      : theme.backgroundSecondary,\n                  },\n                ]}\n              >\n                <Feather\n                  name={achievement.icon}\n                  size={24}\n                  color={achievement.unlocked ? theme.primary : theme.textSecondary}\n                />\n              </View>\n              <ThemedText type=\"label\" style={styles.achievementName} numberOfLines={1}>\n                {achievement.name}\n              </ThemedText>\n              <ThemedText\n                type=\"caption\"\n                style={[styles.achievementDesc, { color: theme.textSecondary }]}\n                numberOfLines={2}\n              >\n                {achievement.description}\n              </ThemedText>\n              {achievement.unlocked ? (\n                <View style={[styles.unlockedBadge, { backgroundColor: theme.success }]}>\n                  <Feather name=\"check\" size={12} color=\"#FFFFFF\" />\n                </View>\n              ) : null}\n            </View>\n          ))}\n        </View>\n\n        <Spacer height={Spacing[\"2xl\"]} />\n\n        <ThemedText type=\"h3\">Rewards Catalog</ThemedText>\n        <Spacer height={Spacing.md} />\n\n        {REWARDS.map((reward) => {\n          const canRedeem = (gamification?.points || 0) >= reward.pointsCost;\n\n          return (\n            <View\n              key={reward.id}\n              style={[\n                styles.rewardCard,\n                { backgroundColor: theme.cardBackground },\n                Shadows.small,\n              ]}\n            >\n              <View style={[styles.rewardIcon, { backgroundColor: theme.secondary + \"20\" }]}>\n                <Feather name={reward.icon} size={24} color={theme.secondary} />\n              </View>\n              <View style={styles.rewardInfo}>\n                <ThemedText type=\"h4\">{reward.name}</ThemedText>\n                <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n                  {reward.description}\n                </ThemedText>\n              </View>\n              <Pressable\n                style={[\n                  styles.redeemButton,\n                  {\n                    backgroundColor: canRedeem ? theme.primary : theme.backgroundSecondary,\n                  },\n                ]}\n                disabled={!canRedeem}\n              >\n                <ThemedText\n                  type=\"label\"\n                  style={{ color: canRedeem ? \"#FFFFFF\" : theme.textSecondary }}\n                >\n                  {reward.pointsCost} pts\n                </ThemedText>\n              </Pressable>\n            </View>\n          );\n        })}\n\n        <Spacer height={Spacing[\"2xl\"]} />\n\n        <ThemedText type=\"h3\">Recent Activity</ThemedText>\n        <Spacer height={Spacing.md} />\n\n        <View style={[styles.activityCard, { backgroundColor: theme.cardBackground }]}>\n          {activities.length > 0 ? (\n            activities.map((activity, index) => (\n              <View key={activity.id || index} style={styles.activityItem}>\n                <View style={[styles.activityDot, { backgroundColor: theme.primary }]} />\n                <ThemedText type=\"body\" style={styles.activityText} numberOfLines={1}>\n                  {activity.action}\n                </ThemedText>\n                <ThemedText type=\"caption\" style={{ color: theme.success }}>\n                  +{activity.points} pts\n                </ThemedText>\n              </View>\n            ))\n          ) : (\n            <View style={styles.activityItem}>\n              <View style={[styles.activityDot, { backgroundColor: theme.textSecondary }]} />\n              <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n                No recent activity. Scan a pill to get started!\n              </ThemedText>\n            </View>\n          )}\n        </View>\n\n        <Spacer height={Spacing.lg} />\n        \n        <View style={styles.statsRow}>\n          <View style={styles.statBox}>\n            <ThemedText type=\"h3\">{stats?.totalScans || 0}</ThemedText>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              Total Scans\n            </ThemedText>\n          </View>\n          <View style={styles.statBox}>\n            <ThemedText type=\"h3\">{stats?.totalInteractionsChecked || 0}</ThemedText>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              Interactions Checked\n            </ThemedText>\n          </View>\n        </View>\n      </ScrollView>\n    </ThemedView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  header: {\n    padding: Spacing.xl,\n    alignItems: \"center\",\n  },\n  pointsValue: {\n    color: \"#FFFFFF\",\n  },\n  pointsLabel: {\n    color: \"rgba(255,255,255,0.8)\",\n  },\n  levelContainer: {\n    width: \"100%\",\n  },\n  levelInfo: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    marginBottom: Spacing.sm,\n  },\n  levelText: {\n    color: \"#FFFFFF\",\n  },\n  content: {\n    flex: 1,\n    marginTop: -Spacing.lg,\n  },\n  contentContainer: {\n    paddingHorizontal: Spacing.xl,\n    paddingTop: Spacing.lg,\n  },\n  streakCard: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: Spacing.lg,\n    backgroundColor: \"transparent\",\n  },\n  streakIcon: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginRight: Spacing.lg,\n  },\n  streakInfo: {\n    flex: 1,\n  },\n  sectionHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n  },\n  achievementsGrid: {\n    flexDirection: \"row\",\n    flexWrap: \"wrap\",\n    marginHorizontal: -Spacing.sm,\n  },\n  achievementCard: {\n    width: \"50%\",\n    padding: Spacing.sm,\n  },\n  achievementIcon: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginBottom: Spacing.sm,\n  },\n  achievementName: {\n    marginBottom: Spacing.xs,\n  },\n  achievementDesc: {},\n  unlockedBadge: {\n    position: \"absolute\",\n    top: Spacing.sm + 4,\n    right: Spacing.sm + 4,\n    width: 20,\n    height: 20,\n    borderRadius: 10,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  rewardCard: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: Spacing.lg,\n    borderRadius: BorderRadius.lg,\n    marginBottom: Spacing.md,\n  },\n  rewardIcon: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginRight: Spacing.lg,\n  },\n  rewardInfo: {\n    flex: 1,\n  },\n  redeemButton: {\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.md,\n  },\n  activityCard: {\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.lg,\n  },\n  activityItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingVertical: Spacing.sm,\n  },\n  activityDot: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n    marginRight: Spacing.md,\n  },\n  activityText: {\n    flex: 1,\n  },\n  statsRow: {\n    flexDirection: \"row\",\n    gap: Spacing.md,\n  },\n  statBox: {\n    flex: 1,\n    alignItems: \"center\",\n    paddingVertical: Spacing.lg,\n  },\n});\n","path":null,"size_bytes":13226,"size_tokens":null},"screens/PharmacyScreen.tsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  TextInput,\n  Pressable,\n  ScrollView,\n  Platform,\n  Linking,\n  ActivityIndicator,\n} from \"react-native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { Feather } from \"@expo/vector-icons\";\nimport * as Location from \"expo-location\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { PharmacyCard } from \"@/components/PharmacyCard\";\nimport { MapViewContainer } from \"@/components/MapViewContainer\";\n\ninterface Region {\n  latitude: number;\n  longitude: number;\n  latitudeDelta: number;\n  longitudeDelta: number;\n}\nimport { Button } from \"@/components/Button\";\nimport Spacer from \"@/components/Spacer\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { useScreenInsets } from \"@/hooks/useScreenInsets\";\nimport { Spacing, BorderRadius, Shadows, MedicalColors } from \"@/constants/theme\";\nimport { PharmacyStackParamList } from \"@/navigation/PharmacyStackNavigator\";\nimport { detectPriceAnomalies, PriceInfo } from \"@/utils/aiServices\";\n\ntype PharmacyScreenProps = {\n  navigation: NativeStackNavigationProp<PharmacyStackParamList, \"Pharmacy\">;\n};\n\ninterface PharmacyLocation {\n  id: string;\n  name: string;\n  address: string;\n  distance: string;\n  walkingTime: string;\n  isVerified: boolean;\n  is24Hours: boolean;\n  inStock: boolean;\n  latitude: number;\n  longitude: number;\n}\n\nconst SAMPLE_PHARMACIES: PharmacyLocation[] = [\n  {\n    id: \"1\",\n    name: \"HealthPlus Pharmacy\",\n    address: \"123 Main Street\",\n    distance: \"0.3 km\",\n    walkingTime: \"4 min\",\n    isVerified: true,\n    is24Hours: false,\n    inStock: true,\n    latitude: 41.3111,\n    longitude: 69.2797,\n  },\n  {\n    id: \"2\",\n    name: \"MediCare Central\",\n    address: \"456 Oak Avenue\",\n    distance: \"0.8 km\",\n    walkingTime: \"10 min\",\n    isVerified: true,\n    is24Hours: true,\n    inStock: true,\n    latitude: 41.3115,\n    longitude: 69.2820,\n  },\n  {\n    id: \"3\",\n    name: \"QuickMeds Pharmacy\",\n    address: \"789 Pine Road\",\n    distance: \"1.2 km\",\n    walkingTime: \"15 min\",\n    isVerified: true,\n    is24Hours: false,\n    inStock: false,\n    latitude: 41.3090,\n    longitude: 69.2750,\n  },\n  {\n    id: \"4\",\n    name: \"City Pharmacy\",\n    address: \"321 Elm Street\",\n    distance: \"1.5 km\",\n    walkingTime: \"19 min\",\n    isVerified: true,\n    is24Hours: true,\n    inStock: true,\n    latitude: 41.3125,\n    longitude: 69.2860,\n  },\n  {\n    id: \"5\",\n    name: \"Budget Meds Online\",\n    address: \"Online Only\",\n    distance: \"Online\",\n    walkingTime: \"N/A\",\n    isVerified: false,\n    is24Hours: true,\n    inStock: true,\n    latitude: 0,\n    longitude: 0,\n  },\n];\n\ntype FilterType = \"all\" | \"verified\" | \"24hours\" | \"instock\";\n\nconst DEFAULT_REGION: Region = {\n  latitude: 41.3111,\n  longitude: 69.2797,\n  latitudeDelta: 0.02,\n  longitudeDelta: 0.02,\n};\n\nexport default function PharmacyScreen({ navigation }: PharmacyScreenProps) {\n  const { theme } = useTheme();\n  const { paddingTop, paddingBottom } = useScreenInsets();\n  const [locationPermission, setLocationPermission] = useState<boolean | null>(null);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedFilter, setSelectedFilter] = useState<FilterType>(\"all\");\n  const [pharmacies, setPharmacies] = useState<PharmacyLocation[]>(SAMPLE_PHARMACIES);\n  const [priceData, setPriceData] = useState<PriceInfo[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [userLocation, setUserLocation] = useState<{ latitude: number; longitude: number } | null>(null);\n  const [mapRegion, setMapRegion] = useState<Region>(DEFAULT_REGION);\n\n  useEffect(() => {\n    checkLocationPermission();\n    loadPriceData();\n  }, []);\n\n  const checkLocationPermission = async () => {\n    const { status } = await Location.requestForegroundPermissionsAsync();\n    const granted = status === \"granted\";\n    setLocationPermission(granted);\n    \n    if (granted) {\n      try {\n        const location = await Location.getCurrentPositionAsync({\n          accuracy: Location.Accuracy.Balanced,\n        });\n        const coords = {\n          latitude: location.coords.latitude,\n          longitude: location.coords.longitude,\n        };\n        setUserLocation(coords);\n        setMapRegion({\n          ...coords,\n          latitudeDelta: 0.02,\n          longitudeDelta: 0.02,\n        });\n      } catch (error) {\n        console.log(\"Could not get current location, using default\");\n      }\n    }\n  };\n\n  const loadPriceData = async () => {\n    setIsLoading(true);\n    try {\n      const prices = await detectPriceAnomalies(\"Acetaminophen 500mg\");\n      setPriceData(prices);\n    } catch (error) {\n      console.error(\"Error loading price data:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const filteredPharmacies = pharmacies.filter((pharmacy) => {\n    const matchesSearch =\n      pharmacy.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      pharmacy.address.toLowerCase().includes(searchQuery.toLowerCase());\n\n    switch (selectedFilter) {\n      case \"verified\":\n        return matchesSearch && pharmacy.isVerified;\n      case \"24hours\":\n        return matchesSearch && pharmacy.is24Hours;\n      case \"instock\":\n        return matchesSearch && pharmacy.inStock;\n      default:\n        return matchesSearch;\n    }\n  });\n\n  const openDirections = (pharmacy: PharmacyLocation) => {\n    if (pharmacy.latitude === 0) return;\n    \n    const url = Platform.select({\n      ios: `maps://app?daddr=${pharmacy.latitude},${pharmacy.longitude}`,\n      android: `google.navigation:q=${pharmacy.latitude},${pharmacy.longitude}`,\n      default: `https://www.google.com/maps/dir/?api=1&destination=${pharmacy.latitude},${pharmacy.longitude}`,\n    });\n    \n    Linking.openURL(url).catch(() => {\n      Linking.openURL(\n        `https://www.google.com/maps/dir/?api=1&destination=${pharmacy.latitude},${pharmacy.longitude}`\n      );\n    });\n  };\n\n  const filters: { key: FilterType; label: string; icon: keyof typeof Feather.glyphMap }[] = [\n    { key: \"all\", label: \"All\", icon: \"list\" },\n    { key: \"verified\", label: \"Verified\", icon: \"check-circle\" },\n    { key: \"24hours\", label: \"24/7\", icon: \"clock\" },\n    { key: \"instock\", label: \"In Stock\", icon: \"package\" },\n  ];\n\n  const renderMap = () => {\n    if (locationPermission === false) {\n      return (\n        <View style={[styles.mapPlaceholder, { backgroundColor: theme.backgroundSecondary }]}>\n          <View style={styles.mapContent}>\n            <Feather name=\"map\" size={48} color={theme.textSecondary} />\n            <ThemedText type=\"body\" style={[styles.mapText, { color: theme.textSecondary }]}>\n              Enable location to see nearby pharmacies on the map\n            </ThemedText>\n            <Button\n              onPress={checkLocationPermission}\n              style={styles.enableLocationButton}\n            >\n              Enable Location\n            </Button>\n          </View>\n        </View>\n      );\n    }\n\n    const pharmacyMarkers = filteredPharmacies.map((p) => ({\n      id: p.id,\n      name: p.name,\n      address: p.address,\n      distance: p.distance,\n      latitude: p.latitude,\n      longitude: p.longitude,\n      isVerified: p.isVerified,\n    }));\n\n    return (\n      <MapViewContainer\n        region={mapRegion}\n        onRegionChange={setMapRegion}\n        pharmacies={pharmacyMarkers}\n        userLocation={userLocation}\n        locationPermission={locationPermission === true}\n      />\n    );\n  };\n\n  return (\n    <ThemedView style={styles.container}>\n      {renderMap()}\n\n      <View style={[styles.bottomSheet, { backgroundColor: theme.backgroundRoot }]}>\n        <View style={styles.handle} />\n\n        <View style={styles.searchContainer}>\n          <View\n            style={[\n              styles.searchInputContainer,\n              { backgroundColor: theme.backgroundSecondary },\n            ]}\n          >\n            <Feather name=\"search\" size={20} color={theme.textSecondary} />\n            <TextInput\n              style={[styles.searchInput, { color: theme.text }]}\n              placeholder=\"Search pharmacies...\"\n              placeholderTextColor={theme.textSecondary}\n              value={searchQuery}\n              onChangeText={setSearchQuery}\n            />\n          </View>\n        </View>\n\n        <ScrollView\n          horizontal\n          showsHorizontalScrollIndicator={false}\n          style={styles.filtersContainer}\n          contentContainerStyle={styles.filtersContent}\n        >\n          {filters.map((filter) => (\n            <Pressable\n              key={filter.key}\n              onPress={() => setSelectedFilter(filter.key)}\n              style={[\n                styles.filterChip,\n                {\n                  backgroundColor:\n                    selectedFilter === filter.key\n                      ? theme.primary\n                      : theme.backgroundSecondary,\n                },\n              ]}\n            >\n              <Feather\n                name={filter.icon}\n                size={14}\n                color={selectedFilter === filter.key ? \"#FFFFFF\" : theme.text}\n              />\n              <ThemedText\n                type=\"small\"\n                style={[\n                  styles.filterLabel,\n                  { color: selectedFilter === filter.key ? \"#FFFFFF\" : theme.text },\n                ]}\n              >\n                {filter.label}\n              </ThemedText>\n            </Pressable>\n          ))}\n        </ScrollView>\n\n        <ScrollView\n          style={styles.pharmaciesList}\n          contentContainerStyle={[\n            styles.pharmaciesContent,\n            { paddingBottom: paddingBottom },\n          ]}\n          showsVerticalScrollIndicator={false}\n        >\n          <ThemedText type=\"h4\" style={styles.listTitle}>\n            Nearby Pharmacies ({filteredPharmacies.length})\n          </ThemedText>\n          <Spacer height={Spacing.md} />\n\n          {isLoading ? (\n            <View style={styles.loadingContainer}>\n              <ActivityIndicator size=\"large\" color={theme.primary} />\n              <ThemedText\n                type=\"body\"\n                style={[styles.loadingText, { color: theme.textSecondary }]}\n              >\n                Loading pharmacy data...\n              </ThemedText>\n            </View>\n          ) : (\n            filteredPharmacies.map((pharmacy) => {\n              const priceInfo = priceData.find(\n                (p) => p.pharmacyName === pharmacy.name\n              );\n\n              return (\n                <View key={pharmacy.id} style={styles.pharmacyItem}>\n                  <Pressable\n                    onPress={() =>\n                      navigation.navigate(\"PharmacyDetail\", { pharmacyId: pharmacy.id })\n                    }\n                    style={({ pressed }) => [\n                      styles.pharmacyCard,\n                      { backgroundColor: theme.cardBackground, opacity: pressed ? 0.9 : 1 },\n                      Shadows.small,\n                    ]}\n                  >\n                    <View style={styles.pharmacyHeader}>\n                      <View style={styles.pharmacyNameRow}>\n                        <ThemedText type=\"h4\" style={styles.pharmacyName}>\n                          {pharmacy.name}\n                        </ThemedText>\n                        {pharmacy.isVerified ? (\n                          <View\n                            style={[\n                              styles.verifiedBadge,\n                              { backgroundColor: MedicalColors.verified },\n                            ]}\n                          >\n                            <Feather name=\"check\" size={12} color=\"#FFFFFF\" />\n                          </View>\n                        ) : null}\n                        {pharmacy.is24Hours ? (\n                          <View\n                            style={[\n                              styles.badge24,\n                              { backgroundColor: theme.secondary },\n                            ]}\n                          >\n                            <ThemedText type=\"caption\" style={styles.badgeText}>\n                              24/7\n                            </ThemedText>\n                          </View>\n                        ) : null}\n                      </View>\n                      <ThemedText\n                        type=\"small\"\n                        style={{ color: theme.textSecondary }}\n                      >\n                        {pharmacy.address}\n                      </ThemedText>\n                    </View>\n\n                    <View style={styles.pharmacyDetails}>\n                      <View style={styles.detailItem}>\n                        <Feather name=\"map-pin\" size={14} color={theme.textSecondary} />\n                        <ThemedText\n                          type=\"small\"\n                          style={[styles.detailText, { color: theme.textSecondary }]}\n                        >\n                          {pharmacy.distance}\n                        </ThemedText>\n                      </View>\n                      <View style={styles.detailItem}>\n                        <Feather name=\"clock\" size={14} color={theme.textSecondary} />\n                        <ThemedText\n                          type=\"small\"\n                          style={[styles.detailText, { color: theme.textSecondary }]}\n                        >\n                          {pharmacy.walkingTime}\n                        </ThemedText>\n                      </View>\n                      <View\n                        style={[\n                          styles.stockBadge,\n                          {\n                            backgroundColor: pharmacy.inStock\n                              ? MedicalColors.safe + \"20\"\n                              : theme.backgroundSecondary,\n                          },\n                        ]}\n                      >\n                        <ThemedText\n                          type=\"caption\"\n                          style={{\n                            color: pharmacy.inStock ? MedicalColors.safe : theme.textSecondary,\n                          }}\n                        >\n                          {pharmacy.inStock ? \"In Stock\" : \"Out of Stock\"}\n                        </ThemedText>\n                      </View>\n                    </View>\n\n                    {priceInfo ? (\n                      <View style={styles.priceSection}>\n                        <View style={styles.priceRow}>\n                          <ThemedText\n                            type=\"h4\"\n                            style={{\n                              color: priceInfo.priceAnomalyDetails?.riskLevel === \"danger\"\n                                ? MedicalColors.suspicious\n                                : priceInfo.priceAnomalyDetails?.riskLevel === \"warning\"\n                                  ? MedicalColors.severityMajor.text\n                                  : priceInfo.isSuspicious\n                                    ? MedicalColors.suspicious\n                                    : theme.primary,\n                            }}\n                          >\n                            ${priceInfo.price.toFixed(2)}\n                          </ThemedText>\n                          {priceInfo.priceAnomalyDetails ? (\n                            <View\n                              style={[\n                                styles.riskBadge,\n                                {\n                                  backgroundColor:\n                                    priceInfo.priceAnomalyDetails.riskLevel === \"danger\"\n                                      ? MedicalColors.severityMajor.background\n                                      : priceInfo.priceAnomalyDetails.riskLevel === \"warning\"\n                                        ? MedicalColors.severityMajor.background\n                                        : priceInfo.priceAnomalyDetails.riskLevel === \"caution\"\n                                          ? MedicalColors.severityModerate.background\n                                          : MedicalColors.safe + \"20\",\n                                },\n                              ]}\n                            >\n                              <Feather\n                                name={\n                                  priceInfo.priceAnomalyDetails.riskLevel === \"danger\"\n                                    ? \"alert-octagon\"\n                                    : priceInfo.priceAnomalyDetails.riskLevel === \"warning\"\n                                      ? \"alert-triangle\"\n                                      : priceInfo.priceAnomalyDetails.riskLevel === \"caution\"\n                                        ? \"info\"\n                                        : \"check-circle\"\n                                }\n                                size={12}\n                                color={\n                                  priceInfo.priceAnomalyDetails.riskLevel === \"danger\"\n                                    ? MedicalColors.suspicious\n                                    : priceInfo.priceAnomalyDetails.riskLevel === \"warning\"\n                                      ? MedicalColors.severityMajor.text\n                                      : priceInfo.priceAnomalyDetails.riskLevel === \"caution\"\n                                        ? MedicalColors.severityModerate.text\n                                        : MedicalColors.safe\n                                }\n                              />\n                              <ThemedText\n                                type=\"caption\"\n                                style={{\n                                  marginLeft: 4,\n                                  color:\n                                    priceInfo.priceAnomalyDetails.riskLevel === \"danger\"\n                                      ? MedicalColors.suspicious\n                                      : priceInfo.priceAnomalyDetails.riskLevel === \"warning\"\n                                        ? MedicalColors.severityMajor.text\n                                        : priceInfo.priceAnomalyDetails.riskLevel === \"caution\"\n                                          ? MedicalColors.severityModerate.text\n                                          : MedicalColors.safe,\n                                }}\n                              >\n                                {priceInfo.priceAnomalyDetails.riskLevel === \"danger\"\n                                  ? \"Counterfeit Risk\"\n                                  : priceInfo.priceAnomalyDetails.riskLevel === \"warning\"\n                                    ? \"Price Alert\"\n                                    : priceInfo.priceAnomalyDetails.riskLevel === \"caution\"\n                                      ? \"Verify Price\"\n                                      : \"Fair Price\"}\n                              </ThemedText>\n                            </View>\n                          ) : priceInfo.isSuspicious ? (\n                            <View\n                              style={[\n                                styles.warningBadge,\n                                { backgroundColor: MedicalColors.severityMajor.background },\n                              ]}\n                            >\n                              <Feather\n                                name=\"alert-triangle\"\n                                size={12}\n                                color={MedicalColors.suspicious}\n                              />\n                              <ThemedText\n                                type=\"caption\"\n                                style={{ color: MedicalColors.suspicious, marginLeft: 4 }}\n                              >\n                                Price Alert\n                              </ThemedText>\n                            </View>\n                          ) : null}\n                        </View>\n                        {priceInfo.priceAnomalyDetails && priceInfo.priceAnomalyDetails.expectedRange.min > 0 ? (\n                          <View style={styles.priceAnalysisRow}>\n                            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                              Typical: ${priceInfo.priceAnomalyDetails.expectedRange.min.toFixed(2)} - ${priceInfo.priceAnomalyDetails.expectedRange.max.toFixed(2)}\n                            </ThemedText>\n                            {priceInfo.priceAnomalyDetails.riskLevel !== \"safe\" ? (\n                              <ThemedText type=\"caption\" style={{ color: theme.textSecondary, marginLeft: 8 }}>\n                                AI Score: {Math.round((priceInfo.anomalyScore || 0) * 100)}%\n                              </ThemedText>\n                            ) : null}\n                          </View>\n                        ) : null}\n                        {priceInfo.suspicionReason ? (\n                          <ThemedText\n                            type=\"caption\"\n                            style={[styles.suspicionReason, { color: MedicalColors.suspicious }]}\n                          >\n                            {priceInfo.suspicionReason}\n                          </ThemedText>\n                        ) : null}\n                      </View>\n                    ) : null}\n\n                    {pharmacy.latitude !== 0 ? (\n                      <Pressable\n                        onPress={() => openDirections(pharmacy)}\n                        style={[\n                          styles.directionsButton,\n                          { backgroundColor: theme.primary },\n                        ]}\n                      >\n                        <Feather name=\"navigation\" size={16} color=\"#FFFFFF\" />\n                        <ThemedText type=\"label\" style={styles.directionsText}>\n                          Get Directions\n                        </ThemedText>\n                      </Pressable>\n                    ) : null}\n                  </Pressable>\n                </View>\n              );\n            })\n          )}\n        </ScrollView>\n      </View>\n    </ThemedView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  mapPlaceholder: {\n    height: \"35%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    position: \"relative\",\n  },\n  mapContent: {\n    alignItems: \"center\",\n  },\n  mapText: {\n    marginTop: Spacing.md,\n    marginBottom: Spacing.lg,\n  },\n  enableLocationButton: {\n    minWidth: 160,\n  },\n  pharmacyMarkers: {\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n  },\n  marker: {\n    position: \"absolute\",\n    width: 32,\n    height: 32,\n    borderRadius: 16,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  bottomSheet: {\n    flex: 1,\n    borderTopLeftRadius: BorderRadius.xl,\n    borderTopRightRadius: BorderRadius.xl,\n    marginTop: -Spacing.xl,\n    paddingTop: Spacing.md,\n  },\n  handle: {\n    width: 40,\n    height: 4,\n    backgroundColor: \"rgba(128,128,128,0.3)\",\n    borderRadius: 2,\n    alignSelf: \"center\",\n    marginBottom: Spacing.md,\n  },\n  searchContainer: {\n    paddingHorizontal: Spacing.xl,\n  },\n  searchInputContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.lg,\n    height: 44,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n  },\n  searchInput: {\n    flex: 1,\n    fontSize: 16,\n  },\n  filtersContainer: {\n    marginTop: Spacing.md,\n  },\n  filtersContent: {\n    paddingHorizontal: Spacing.xl,\n    gap: Spacing.sm,\n  },\n  filterChip: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.full,\n    marginRight: Spacing.sm,\n    gap: Spacing.xs,\n  },\n  filterLabel: {\n    fontWeight: \"500\",\n  },\n  pharmaciesList: {\n    flex: 1,\n    marginTop: Spacing.lg,\n  },\n  pharmaciesContent: {\n    paddingHorizontal: Spacing.xl,\n  },\n  listTitle: {\n    marginBottom: Spacing.sm,\n  },\n  loadingContainer: {\n    alignItems: \"center\",\n    paddingVertical: Spacing[\"3xl\"],\n  },\n  loadingText: {\n    marginTop: Spacing.md,\n  },\n  pharmacyItem: {\n    marginBottom: Spacing.md,\n  },\n  pharmacyCard: {\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.lg,\n  },\n  pharmacyHeader: {\n    marginBottom: Spacing.md,\n  },\n  pharmacyNameRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginBottom: Spacing.xs,\n    flexWrap: \"wrap\",\n    gap: Spacing.sm,\n  },\n  pharmacyName: {\n    flex: 1,\n  },\n  verifiedBadge: {\n    width: 20,\n    height: 20,\n    borderRadius: 10,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  badge24: {\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: 2,\n    borderRadius: BorderRadius.xs,\n  },\n  badgeText: {\n    color: \"#FFFFFF\",\n    fontWeight: \"600\",\n  },\n  pharmacyDetails: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.lg,\n    marginBottom: Spacing.md,\n  },\n  detailItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.xs,\n  },\n  detailText: {},\n  stockBadge: {\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: 2,\n    borderRadius: BorderRadius.xs,\n  },\n  priceSection: {\n    marginBottom: Spacing.md,\n  },\n  priceRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.md,\n    marginBottom: Spacing.xs,\n  },\n  priceAnalysisRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginBottom: Spacing.xs,\n  },\n  suspicionReason: {\n    marginTop: Spacing.xs,\n    fontSize: 11,\n    fontStyle: \"italic\",\n  },\n  riskBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: 2,\n    borderRadius: BorderRadius.xs,\n  },\n  warningBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: 2,\n    borderRadius: BorderRadius.xs,\n  },\n  directionsButton: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n  },\n  directionsText: {\n    color: \"#FFFFFF\",\n  },\n  mapContainer: {\n    height: \"35%\",\n    position: \"relative\",\n  },\n  map: {\n    flex: 1,\n  },\n  mapOverlay: {\n    position: \"absolute\",\n    top: Spacing.lg,\n    right: Spacing.lg,\n  },\n  myLocationButton: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    ...Shadows.sm,\n  },\n  mapLegend: {\n    position: \"absolute\",\n    bottom: Spacing.xl + 20,\n    left: Spacing.lg,\n    flexDirection: \"row\",\n    gap: Spacing.md,\n  },\n  legendItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.sm,\n    gap: Spacing.xs,\n    ...Shadows.sm,\n  },\n  legendDot: {\n    width: 10,\n    height: 10,\n    borderRadius: 5,\n  },\n});\n","path":null,"size_bytes":26888,"size_tokens":null},"screens/InteractionResultScreen.tsx":{"content":"import React from \"react\";\nimport { View, StyleSheet } from \"react-native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { RouteProp } from \"@react-navigation/native\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { InteractionsStackParamList } from \"@/navigation/InteractionsStackNavigator\";\n\ntype InteractionResultScreenProps = {\n  navigation: NativeStackNavigationProp<InteractionsStackParamList, \"InteractionResult\">;\n  route: RouteProp<InteractionsStackParamList, \"InteractionResult\">;\n};\n\nexport default function InteractionResultScreen({ navigation, route }: InteractionResultScreenProps) {\n  return (\n    <ScreenScrollView>\n      <View style={styles.container}>\n        <ThemedText type=\"body\">Interaction results will display here.</ThemedText>\n      </View>\n    </ScreenScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n});\n","path":null,"size_bytes":1048,"size_tokens":null},"screens/HomeScreen.tsx":{"content":"import React, { useState, useEffect, useCallback } from \"react\";\nimport { View, StyleSheet, Pressable, RefreshControl } from \"react-native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { useFocusEffect } from \"@react-navigation/native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport * as Haptics from \"expo-haptics\";\nimport { Platform } from \"react-native\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { MedCard } from \"@/components/MedCard\";\nimport { ReminderCard } from \"@/components/ReminderCard\";\nimport { ProgressBar } from \"@/components/ProgressBar\";\nimport { EmptyState } from \"@/components/EmptyState\";\nimport Spacer from \"@/components/Spacer\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Shadows } from \"@/constants/theme\";\nimport { HomeStackParamList } from \"@/navigation/HomeStackNavigator\";\nimport {\n  getUserProfile,\n  getReminders,\n  getScanHistory,\n  getGamificationData,\n  markReminderTaken,\n  UserProfile,\n  Reminder,\n  ScanHistoryItem,\n  GamificationData,\n} from \"@/utils/storage\";\nimport { getGreeting } from \"@/utils/aiServices\";\n\ntype HomeScreenProps = {\n  navigation: NativeStackNavigationProp<HomeStackParamList, \"Home\">;\n};\n\nexport default function HomeScreen({ navigation }: HomeScreenProps) {\n  const { theme } = useTheme();\n  const [profile, setProfile] = useState<UserProfile | null>(null);\n  const [reminders, setReminders] = useState<Reminder[]>([]);\n  const [scanHistory, setScanHistory] = useState<ScanHistoryItem[]>([]);\n  const [gamification, setGamification] = useState<GamificationData | null>(null);\n  const [refreshing, setRefreshing] = useState(false);\n\n  const loadData = useCallback(async () => {\n    try {\n      const [profileData, remindersData, historyData, gamificationData] = await Promise.all([\n        getUserProfile(),\n        getReminders(),\n        getScanHistory(),\n        getGamificationData(),\n      ]);\n      setProfile(profileData);\n      setReminders(remindersData);\n      setScanHistory(historyData);\n      setGamification(gamificationData);\n    } catch (error) {\n      console.error(\"Error loading data:\", error);\n    }\n  }, []);\n\n  useFocusEffect(\n    useCallback(() => {\n      loadData();\n    }, [loadData])\n  );\n\n  const onRefresh = useCallback(async () => {\n    setRefreshing(true);\n    await loadData();\n    setRefreshing(false);\n  }, [loadData]);\n\n  const handleReminderToggle = async (id: string) => {\n    if (Platform.OS !== \"web\") {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);\n    }\n    await markReminderTaken(id);\n    await loadData();\n  };\n\n  const today = new Date().toISOString().split(\"T\")[0];\n  const todayReminders = reminders.filter((r) => r.isEnabled);\n  const takenToday = todayReminders.filter((r) => r.takenDates.includes(today));\n  const adherencePercent = todayReminders.length > 0 ? takenToday.length / todayReminders.length : 0;\n\n  const greeting = profile ? getGreeting(profile.name, profile.language) : \"Welcome\";\n\n  const levelProgress = gamification ? (gamification.points % 100) / 100 : 0;\n  const pointsToNext = gamification ? 100 - (gamification.points % 100) : 100;\n\n  return (\n    <ScreenScrollView\n      refreshControl={\n        <RefreshControl refreshing={refreshing} onRefresh={onRefresh} tintColor={theme.primary} />\n      }\n    >\n      <ThemedText type=\"h2\" style={styles.greeting}>\n        {greeting}\n      </ThemedText>\n      <Spacer height={Spacing.xl} />\n\n      <MedCard\n        title=\"Gamification Progress\"\n        leftIcon=\"award\"\n        onPress={() => navigation.getParent()?.navigate(\"ProfileTab\", { screen: \"Rewards\" })}\n      >\n        <View style={styles.gamificationContent}>\n          <View style={styles.levelRow}>\n            <ThemedText type=\"label\">Level {gamification?.level || 1}</ThemedText>\n            <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n              {gamification?.points || 0} points\n            </ThemedText>\n          </View>\n          <Spacer height={Spacing.sm} />\n          <ProgressBar progress={levelProgress} color={theme.primary} />\n          <Spacer height={Spacing.xs} />\n          <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n            {pointsToNext} points to next level\n          </ThemedText>\n\n          <View style={styles.statsRow}>\n            <View style={styles.statItem}>\n              <View style={[styles.statIcon, { backgroundColor: theme.backgroundSecondary }]}>\n                <Feather name=\"zap\" size={16} color={theme.accent} />\n              </View>\n              <ThemedText type=\"h4\">{gamification?.streak || 0}</ThemedText>\n              <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                Day Streak\n              </ThemedText>\n            </View>\n            <View style={styles.statItem}>\n              <View style={[styles.statIcon, { backgroundColor: theme.backgroundSecondary }]}>\n                <Feather name=\"camera\" size={16} color={theme.secondary} />\n              </View>\n              <ThemedText type=\"h4\">{gamification?.scansThisWeek || 0}</ThemedText>\n              <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                Scans\n              </ThemedText>\n            </View>\n            <View style={styles.statItem}>\n              <View style={[styles.statIcon, { backgroundColor: theme.backgroundSecondary }]}>\n                <Feather name=\"check-circle\" size={16} color={theme.success} />\n              </View>\n              <ThemedText type=\"h4\">{Math.round(adherencePercent * 100)}%</ThemedText>\n              <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                Adherence\n              </ThemedText>\n            </View>\n          </View>\n        </View>\n      </MedCard>\n\n      <Spacer height={Spacing.xl} />\n\n      <View style={styles.sectionHeader}>\n        <ThemedText type=\"h3\">Today's Medications</ThemedText>\n        <Pressable\n          onPress={() => navigation.navigate(\"Reminders\")}\n          style={({ pressed }) => [styles.seeAllButton, { opacity: pressed ? 0.7 : 1 }]}\n        >\n          <ThemedText type=\"link\">See All</ThemedText>\n        </Pressable>\n      </View>\n      <Spacer height={Spacing.md} />\n\n      {todayReminders.length === 0 ? (\n        <View style={[styles.emptyCard, { backgroundColor: theme.cardBackground }]}>\n          <Feather name=\"calendar\" size={24} color={theme.textSecondary} />\n          <ThemedText type=\"body\" style={[styles.emptyText, { color: theme.textSecondary }]}>\n            No medications scheduled for today\n          </ThemedText>\n          <Pressable\n            onPress={() => navigation.navigate(\"Reminders\")}\n            style={({ pressed }) => [\n              styles.addButton,\n              { backgroundColor: theme.primary, opacity: pressed ? 0.8 : 1 },\n            ]}\n          >\n            <Feather name=\"plus\" size={16} color=\"#FFFFFF\" />\n            <ThemedText type=\"label\" style={styles.addButtonText}>\n              Add Reminder\n            </ThemedText>\n          </Pressable>\n        </View>\n      ) : (\n        <View style={styles.remindersList}>\n          {todayReminders.slice(0, 3).map((reminder) => (\n            <View key={reminder.id} style={styles.reminderItem}>\n              <ReminderCard\n                reminder={reminder}\n                onToggle={handleReminderToggle}\n                onPress={() => navigation.navigate(\"Reminders\")}\n                isTaken={reminder.takenDates.includes(today)}\n              />\n            </View>\n          ))}\n        </View>\n      )}\n\n      <Spacer height={Spacing.xl} />\n\n      <View style={styles.sectionHeader}>\n        <ThemedText type=\"h3\">Recent Scans</ThemedText>\n      </View>\n      <Spacer height={Spacing.md} />\n\n      {scanHistory.length === 0 ? (\n        <View style={[styles.emptyCard, { backgroundColor: theme.cardBackground }]}>\n          <Feather name=\"camera\" size={24} color={theme.textSecondary} />\n          <ThemedText type=\"body\" style={[styles.emptyText, { color: theme.textSecondary }]}>\n            No pills scanned yet\n          </ThemedText>\n          <Pressable\n            onPress={() => navigation.getParent()?.navigate(\"ScannerTab\")}\n            style={({ pressed }) => [\n              styles.addButton,\n              { backgroundColor: theme.primary, opacity: pressed ? 0.8 : 1 },\n            ]}\n          >\n            <Feather name=\"camera\" size={16} color=\"#FFFFFF\" />\n            <ThemedText type=\"label\" style={styles.addButtonText}>\n              Scan a Pill\n            </ThemedText>\n          </Pressable>\n        </View>\n      ) : (\n        <View style={styles.scansList}>\n          {scanHistory.slice(0, 5).map((scan) => (\n            <MedCard\n              key={scan.id}\n              title={scan.medicationName}\n              subtitle={`Scanned ${new Date(scan.scannedAt).toLocaleDateString()}`}\n              leftIcon=\"disc\"\n              badge={`${Math.round(scan.confidence * 100)}%`}\n              badgeColor={theme.success}\n              onPress={() =>\n                navigation.navigate(\"MedicationDetail\", { medicationId: scan.medicationId })\n              }\n              style={styles.scanCard}\n            />\n          ))}\n        </View>\n      )}\n\n      <Spacer height={Spacing[\"3xl\"]} />\n    </ScreenScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  greeting: {\n    marginTop: Spacing.sm,\n  },\n  gamificationContent: {\n    marginTop: Spacing.sm,\n  },\n  levelRow: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n  },\n  statsRow: {\n    flexDirection: \"row\",\n    justifyContent: \"space-around\",\n    marginTop: Spacing.xl,\n  },\n  statItem: {\n    alignItems: \"center\",\n  },\n  statIcon: {\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginBottom: Spacing.sm,\n  },\n  sectionHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n  },\n  seeAllButton: {\n    padding: Spacing.xs,\n  },\n  emptyCard: {\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    padding: Spacing[\"2xl\"],\n    borderRadius: BorderRadius.lg,\n    ...Shadows.small,\n  },\n  emptyText: {\n    marginTop: Spacing.md,\n    marginBottom: Spacing.lg,\n    textAlign: \"center\",\n  },\n  addButton: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.md,\n    gap: Spacing.sm,\n  },\n  addButtonText: {\n    color: \"#FFFFFF\",\n  },\n  remindersList: {\n    gap: Spacing.md,\n  },\n  reminderItem: {},\n  scansList: {\n    gap: Spacing.md,\n  },\n  scanCard: {},\n});\n","path":null,"size_bytes":10757,"size_tokens":null},"utils/storage.ts":{"content":"import AsyncStorage from \"@react-native-async-storage/async-storage\";\n\nconst STORAGE_KEYS = {\n  USER_PROFILE: \"@mediscan_user_profile\",\n  MEDICATIONS: \"@mediscan_medications\",\n  REMINDERS: \"@mediscan_reminders\",\n  SCAN_HISTORY: \"@mediscan_scan_history\",\n  GAMIFICATION: \"@mediscan_gamification\",\n  SETTINGS: \"@mediscan_settings\",\n  FAMILY_MEMBERS: \"@mediscan_family_members\",\n};\n\nexport interface UserProfile {\n  id: string;\n  name: string;\n  age?: number;\n  isPregnant?: boolean;\n  allergies: string[];\n  chronicConditions: string[];\n  language: \"en\" | \"uz\" | \"ru\";\n  currency: string;\n  avatarIndex: number;\n}\n\nexport interface Medication {\n  id: string;\n  name: string;\n  genericName: string;\n  dosage: string;\n  manufacturer: string;\n  shape: string;\n  color: string;\n  imprint?: string;\n  scannedAt: string;\n  imageUri?: string;\n  warnings: string[];\n  sideEffects: string[];\n}\n\nexport interface Reminder {\n  id: string;\n  medicationId: string;\n  medicationName: string;\n  dosage: string;\n  time: string;\n  frequency: \"daily\" | \"weekly\" | \"monthly\" | \"as_needed\";\n  daysOfWeek?: number[];\n  isEnabled: boolean;\n  lastTaken?: string;\n  takenDates: string[];\n}\n\nexport interface ScanMatchDetails {\n  shape: boolean;\n  color: boolean;\n  imprint: boolean;\n}\n\nexport interface ScanHistoryItem {\n  id: string;\n  medicationId: string;\n  medicationName: string;\n  scannedAt: string;\n  imageUri?: string;\n  confidence: number;\n  analysisMethod?: \"ai\" | \"database\" | \"visual\";\n  matchDetails?: ScanMatchDetails;\n}\n\nexport interface GamificationData {\n  points: number;\n  level: number;\n  streak: number;\n  lastActiveDate: string;\n  achievements: string[];\n  scansThisWeek: number;\n  reportsThisMonth: number;\n  totalInteractionsChecked: number;\n  totalReportsSubmitted: number;\n}\n\nexport interface Settings {\n  theme: \"light\" | \"dark\" | \"system\";\n  notificationsEnabled: boolean;\n  reminderNotifications: boolean;\n  recallAlerts: boolean;\n  familyUpdates: boolean;\n  measurementUnits: \"metric\" | \"imperial\";\n  highContrastMode: boolean;\n  medicalTourismMode: boolean;\n  travelDestination?: string;\n  autoTranslateMeds: boolean;\n}\n\nexport interface FamilyMember {\n  id: string;\n  name: string;\n  relationship: string;\n  inviteCode: string;\n  isConnected: boolean;\n  adherencePercentage: number;\n}\n\nconst defaultProfile: UserProfile = {\n  id: \"user_1\",\n  name: \"User\",\n  allergies: [],\n  chronicConditions: [],\n  language: \"en\",\n  currency: \"USD\",\n  avatarIndex: 0,\n};\n\nconst defaultGamification: GamificationData = {\n  points: 0,\n  level: 1,\n  streak: 0,\n  lastActiveDate: new Date().toISOString().split(\"T\")[0],\n  achievements: [],\n  scansThisWeek: 0,\n  reportsThisMonth: 0,\n  totalInteractionsChecked: 0,\n  totalReportsSubmitted: 0,\n};\n\nconst defaultSettings: Settings = {\n  theme: \"system\",\n  notificationsEnabled: true,\n  reminderNotifications: true,\n  recallAlerts: true,\n  familyUpdates: true,\n  measurementUnits: \"metric\",\n  highContrastMode: false,\n  medicalTourismMode: false,\n  autoTranslateMeds: true,\n};\n\nexport async function getUserProfile(): Promise<UserProfile> {\n  try {\n    const data = await AsyncStorage.getItem(STORAGE_KEYS.USER_PROFILE);\n    return data ? JSON.parse(data) : defaultProfile;\n  } catch (error) {\n    console.error(\"Error getting user profile:\", error);\n    return defaultProfile;\n  }\n}\n\nexport async function saveUserProfile(profile: UserProfile): Promise<void> {\n  try {\n    await AsyncStorage.setItem(STORAGE_KEYS.USER_PROFILE, JSON.stringify(profile));\n  } catch (error) {\n    console.error(\"Error saving user profile:\", error);\n  }\n}\n\nexport async function getMedications(): Promise<Medication[]> {\n  try {\n    const data = await AsyncStorage.getItem(STORAGE_KEYS.MEDICATIONS);\n    return data ? JSON.parse(data) : [];\n  } catch (error) {\n    console.error(\"Error getting medications:\", error);\n    return [];\n  }\n}\n\nexport async function saveMedication(medication: Medication): Promise<void> {\n  try {\n    const medications = await getMedications();\n    const existingIndex = medications.findIndex((m) => m.id === medication.id);\n    if (existingIndex >= 0) {\n      medications[existingIndex] = medication;\n    } else {\n      medications.push(medication);\n    }\n    await AsyncStorage.setItem(STORAGE_KEYS.MEDICATIONS, JSON.stringify(medications));\n  } catch (error) {\n    console.error(\"Error saving medication:\", error);\n  }\n}\n\nexport async function getReminders(): Promise<Reminder[]> {\n  try {\n    const data = await AsyncStorage.getItem(STORAGE_KEYS.REMINDERS);\n    return data ? JSON.parse(data) : [];\n  } catch (error) {\n    console.error(\"Error getting reminders:\", error);\n    return [];\n  }\n}\n\nexport async function saveReminder(reminder: Reminder): Promise<void> {\n  try {\n    const reminders = await getReminders();\n    const existingIndex = reminders.findIndex((r) => r.id === reminder.id);\n    if (existingIndex >= 0) {\n      reminders[existingIndex] = reminder;\n    } else {\n      reminders.push(reminder);\n    }\n    await AsyncStorage.setItem(STORAGE_KEYS.REMINDERS, JSON.stringify(reminders));\n  } catch (error) {\n    console.error(\"Error saving reminder:\", error);\n  }\n}\n\nexport async function deleteReminder(reminderId: string): Promise<void> {\n  try {\n    const reminders = await getReminders();\n    const filteredReminders = reminders.filter((r) => r.id !== reminderId);\n    await AsyncStorage.setItem(STORAGE_KEYS.REMINDERS, JSON.stringify(filteredReminders));\n  } catch (error) {\n    console.error(\"Error deleting reminder:\", error);\n  }\n}\n\nexport async function markReminderTaken(reminderId: string, dateStr?: string): Promise<void> {\n  try {\n    const reminders = await getReminders();\n    const reminder = reminders.find((r) => r.id === reminderId);\n    if (reminder) {\n      const targetDate = dateStr || new Date().toISOString().split(\"T\")[0];\n      \n      if (reminder.takenDates.includes(targetDate)) {\n        reminder.takenDates = reminder.takenDates.filter(d => d !== targetDate);\n      } else {\n        reminder.takenDates.push(targetDate);\n        reminder.lastTaken = new Date().toISOString();\n      }\n      \n      await saveReminder(reminder);\n    }\n  } catch (error) {\n    console.error(\"Error marking reminder taken:\", error);\n  }\n}\n\nexport async function getScanHistory(): Promise<ScanHistoryItem[]> {\n  try {\n    const data = await AsyncStorage.getItem(STORAGE_KEYS.SCAN_HISTORY);\n    return data ? JSON.parse(data) : [];\n  } catch (error) {\n    console.error(\"Error getting scan history:\", error);\n    return [];\n  }\n}\n\nexport async function addScanToHistory(scan: ScanHistoryItem): Promise<void> {\n  try {\n    const history = await getScanHistory();\n    history.unshift(scan);\n    if (history.length > 50) {\n      history.pop();\n    }\n    await AsyncStorage.setItem(STORAGE_KEYS.SCAN_HISTORY, JSON.stringify(history));\n  } catch (error) {\n    console.error(\"Error adding scan to history:\", error);\n  }\n}\n\nexport async function getGamificationData(): Promise<GamificationData> {\n  try {\n    const data = await AsyncStorage.getItem(STORAGE_KEYS.GAMIFICATION);\n    if (data) {\n      const gamification = JSON.parse(data);\n      const today = new Date().toISOString().split(\"T\")[0];\n      if (gamification.lastActiveDate !== today) {\n        const lastDate = new Date(gamification.lastActiveDate);\n        const todayDate = new Date(today);\n        const diffDays = Math.floor(\n          (todayDate.getTime() - lastDate.getTime()) / (1000 * 60 * 60 * 24)\n        );\n        if (diffDays > 1) {\n          gamification.streak = 0;\n        }\n      }\n      return gamification;\n    }\n    return defaultGamification;\n  } catch (error) {\n    console.error(\"Error getting gamification data:\", error);\n    return defaultGamification;\n  }\n}\n\nexport async function updateGamification(updates: Partial<GamificationData>): Promise<GamificationData> {\n  try {\n    const current = await getGamificationData();\n    const updated = { ...current, ...updates };\n    await AsyncStorage.setItem(STORAGE_KEYS.GAMIFICATION, JSON.stringify(updated));\n    return updated;\n  } catch (error) {\n    console.error(\"Error updating gamification:\", error);\n    return current;\n  }\n}\n\nexport async function addPoints(points: number): Promise<GamificationData> {\n  const current = await getGamificationData();\n  const today = new Date().toISOString().split(\"T\")[0];\n  \n  let newStreak = current.streak;\n  if (current.lastActiveDate !== today) {\n    const lastDate = new Date(current.lastActiveDate);\n    const todayDate = new Date(today);\n    const diffDays = Math.floor(\n      (todayDate.getTime() - lastDate.getTime()) / (1000 * 60 * 60 * 24)\n    );\n    if (diffDays === 1) {\n      newStreak = current.streak + 1;\n    } else if (diffDays > 1) {\n      newStreak = 1;\n    }\n  }\n\n  const newPoints = current.points + points;\n  const newLevel = Math.floor(newPoints / 100) + 1;\n\n  return updateGamification({\n    points: newPoints,\n    level: newLevel,\n    streak: newStreak,\n    lastActiveDate: today,\n  });\n}\n\nexport async function getSettings(): Promise<Settings> {\n  try {\n    const data = await AsyncStorage.getItem(STORAGE_KEYS.SETTINGS);\n    return data ? { ...defaultSettings, ...JSON.parse(data) } : defaultSettings;\n  } catch (error) {\n    console.error(\"Error getting settings:\", error);\n    return defaultSettings;\n  }\n}\n\nexport async function saveSettings(settings: Settings): Promise<void> {\n  try {\n    await AsyncStorage.setItem(STORAGE_KEYS.SETTINGS, JSON.stringify(settings));\n  } catch (error) {\n    console.error(\"Error saving settings:\", error);\n  }\n}\n\nexport async function getFamilyMembers(): Promise<FamilyMember[]> {\n  try {\n    const data = await AsyncStorage.getItem(STORAGE_KEYS.FAMILY_MEMBERS);\n    return data ? JSON.parse(data) : [];\n  } catch (error) {\n    console.error(\"Error getting family members:\", error);\n    return [];\n  }\n}\n\nexport async function saveFamilyMember(member: FamilyMember): Promise<void> {\n  try {\n    const members = await getFamilyMembers();\n    const existingIndex = members.findIndex((m) => m.id === member.id);\n    if (existingIndex >= 0) {\n      members[existingIndex] = member;\n    } else {\n      members.push(member);\n    }\n    await AsyncStorage.setItem(STORAGE_KEYS.FAMILY_MEMBERS, JSON.stringify(members));\n  } catch (error) {\n    console.error(\"Error saving family member:\", error);\n  }\n}\n\nexport async function clearAllData(): Promise<void> {\n  try {\n    await AsyncStorage.multiRemove(Object.values(STORAGE_KEYS));\n  } catch (error) {\n    console.error(\"Error clearing all data:\", error);\n  }\n}\n\nexport function generateInviteCode(): string {\n  return Math.random().toString(36).substring(2, 8).toUpperCase();\n}\n\nexport function generateId(): string {\n  return Date.now().toString(36) + Math.random().toString(36).substring(2);\n}\n","path":null,"size_bytes":10738,"size_tokens":null},"screens/ScannerScreen.tsx":{"content":"import React, { useState, useRef } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  Pressable,\n  Platform,\n  ActivityIndicator,\n} from \"react-native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { CameraView, useCameraPermissions } from \"expo-camera\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport * as Haptics from \"expo-haptics\";\nimport { Feather } from \"@expo/vector-icons\";\nimport { useSafeAreaInsets } from \"react-native-safe-area-context\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ThemedView } from \"@/components/ThemedView\";\nimport { Button } from \"@/components/Button\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius } from \"@/constants/theme\";\nimport { ScannerStackParamList } from \"@/navigation/ScannerStackNavigator\";\nimport { analyzePillImage } from \"@/utils/aiServices\";\nimport { addScanToHistory, saveMedication, generateId } from \"@/utils/storage\";\nimport { awardPoints } from \"@/utils/gamification\";\n\ntype ScannerScreenProps = {\n  navigation: NativeStackNavigationProp<ScannerStackParamList, \"Scanner\">;\n};\n\nexport default function ScannerScreen({ navigation }: ScannerScreenProps) {\n  const { theme } = useTheme();\n  const insets = useSafeAreaInsets();\n  const [permission, requestPermission] = useCameraPermissions();\n  const [isScanning, setIsScanning] = useState(false);\n  const [flashOn, setFlashOn] = useState(false);\n  const cameraRef = useRef<CameraView>(null);\n\n  const handleCapture = async () => {\n    if (isScanning) return;\n\n    setIsScanning(true);\n    if (Platform.OS !== \"web\") {\n      Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Medium);\n    }\n\n    try {\n      let imageUri = \"\";\n      \n      if (Platform.OS !== \"web\" && cameraRef.current) {\n        const photo = await cameraRef.current.takePictureAsync();\n        imageUri = photo?.uri || \"\";\n      }\n\n      const result = await analyzePillImage(imageUri);\n\n      await saveMedication({\n        id: result.medication.id,\n        name: result.medication.name,\n        genericName: result.medication.genericName,\n        dosage: result.medication.dosage,\n        manufacturer: result.medication.manufacturer,\n        shape: result.medication.shape,\n        color: result.medication.color,\n        imprint: result.medication.imprint,\n        scannedAt: new Date().toISOString(),\n        imageUri,\n        warnings: result.medication.warnings,\n        sideEffects: result.medication.sideEffects,\n      });\n\n      await addScanToHistory({\n        id: generateId(),\n        medicationId: result.medication.id,\n        medicationName: result.medication.name,\n        scannedAt: new Date().toISOString(),\n        imageUri,\n        confidence: result.confidence,\n        analysisMethod: result.analysisMethod,\n        matchDetails: result.matchDetails,\n      });\n\n      await awardPoints(\"scan\", result.medication.name);\n\n      if (Platform.OS !== \"web\") {\n        Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n      }\n\n      navigation.navigate(\"ScanResult\", { imageUri });\n    } catch (error) {\n      console.error(\"Error scanning pill:\", error);\n    } finally {\n      setIsScanning(false);\n    }\n  };\n\n  const handlePickImage = async () => {\n    const result = await ImagePicker.launchImageLibraryAsync({\n      mediaTypes: ImagePicker.MediaTypeOptions.Images,\n      quality: 1,\n    });\n\n    if (!result.canceled && result.assets[0]) {\n      setIsScanning(true);\n      try {\n        const imageUri = result.assets[0].uri;\n        const analysisResult = await analyzePillImage(imageUri);\n\n        await saveMedication({\n          id: analysisResult.medication.id,\n          name: analysisResult.medication.name,\n          genericName: analysisResult.medication.genericName,\n          dosage: analysisResult.medication.dosage,\n          manufacturer: analysisResult.medication.manufacturer,\n          shape: analysisResult.medication.shape,\n          color: analysisResult.medication.color,\n          imprint: analysisResult.medication.imprint,\n          scannedAt: new Date().toISOString(),\n          imageUri,\n          warnings: analysisResult.medication.warnings,\n          sideEffects: analysisResult.medication.sideEffects,\n        });\n\n        await addScanToHistory({\n          id: generateId(),\n          medicationId: analysisResult.medication.id,\n          medicationName: analysisResult.medication.name,\n          scannedAt: new Date().toISOString(),\n          imageUri,\n          confidence: analysisResult.confidence,\n          analysisMethod: analysisResult.analysisMethod,\n          matchDetails: analysisResult.matchDetails,\n        });\n\n        await awardPoints(\"scan\", analysisResult.medication.name);\n\n        navigation.navigate(\"ScanResult\", { imageUri });\n      } catch (error) {\n        console.error(\"Error analyzing image:\", error);\n      } finally {\n        setIsScanning(false);\n      }\n    }\n  };\n\n  if (!permission) {\n    return (\n      <ThemedView style={styles.container}>\n        <ActivityIndicator size=\"large\" color={theme.primary} />\n      </ThemedView>\n    );\n  }\n\n  if (!permission.granted) {\n    return (\n      <ThemedView style={[styles.container, styles.permissionContainer]}>\n        <View style={[styles.permissionIcon, { backgroundColor: theme.backgroundSecondary }]}>\n          <Feather name=\"camera\" size={48} color={theme.primary} />\n        </View>\n        <ThemedText type=\"h2\" style={styles.permissionTitle}>\n          Camera Access Required\n        </ThemedText>\n        <ThemedText\n          type=\"body\"\n          style={[styles.permissionText, { color: theme.textSecondary }]}\n        >\n          MediScan AI needs camera access to scan and identify pills using AI image recognition\n        </ThemedText>\n        <Button onPress={requestPermission} style={styles.permissionButton}>\n          Enable Camera\n        </Button>\n        <Spacer height={Spacing.lg} />\n        <Pressable onPress={handlePickImage}>\n          <ThemedText type=\"link\">Or choose from gallery</ThemedText>\n        </Pressable>\n      </ThemedView>\n    );\n  }\n\n  return (\n    <View style={styles.container}>\n      {Platform.OS === \"web\" ? (\n        <ThemedView style={styles.webFallback}>\n          <View style={[styles.permissionIcon, { backgroundColor: theme.backgroundSecondary }]}>\n            <Feather name=\"camera\" size={48} color={theme.primary} />\n          </View>\n          <ThemedText type=\"h3\" style={styles.webTitle}>\n            Camera Scanner\n          </ThemedText>\n          <ThemedText\n            type=\"body\"\n            style={[styles.webText, { color: theme.textSecondary }]}\n          >\n            For the best scanning experience, use Expo Go on your mobile device\n          </ThemedText>\n          <Spacer height={Spacing.xl} />\n          <Button onPress={handlePickImage} style={styles.galleryButton}>\n            Choose from Gallery\n          </Button>\n          <Spacer height={Spacing.lg} />\n          <Button\n            onPress={handleCapture}\n            style={[styles.galleryButton, { backgroundColor: theme.secondary }]}\n          >\n            Simulate Scan\n          </Button>\n        </ThemedView>\n      ) : (\n        <CameraView\n          ref={cameraRef}\n          style={styles.camera}\n          facing=\"back\"\n          enableTorch={flashOn}\n        >\n          <View style={[styles.overlay, { paddingTop: insets.top + 60 }]}>\n            <View style={styles.scannerFrame}>\n              <View style={[styles.corner, styles.topLeft, { borderColor: theme.primary }]} />\n              <View style={[styles.corner, styles.topRight, { borderColor: theme.primary }]} />\n              <View style={[styles.corner, styles.bottomLeft, { borderColor: theme.primary }]} />\n              <View style={[styles.corner, styles.bottomRight, { borderColor: theme.primary }]} />\n            </View>\n            <ThemedText type=\"body\" style={styles.scanHint}>\n              Position the pill inside the frame\n            </ThemedText>\n          </View>\n\n          <View style={[styles.controls, { paddingBottom: insets.bottom + Spacing[\"3xl\"] }]}>\n            <Pressable\n              onPress={handlePickImage}\n              style={[styles.sideButton, { backgroundColor: \"rgba(255,255,255,0.2)\" }]}\n            >\n              <Feather name=\"image\" size={24} color=\"#FFFFFF\" />\n            </Pressable>\n\n            <Pressable\n              onPress={handleCapture}\n              disabled={isScanning}\n              style={[\n                styles.captureButton,\n                { backgroundColor: theme.primary, opacity: isScanning ? 0.5 : 1 },\n              ]}\n            >\n              {isScanning ? (\n                <ActivityIndicator size=\"small\" color=\"#FFFFFF\" />\n              ) : (\n                <View style={styles.captureInner} />\n              )}\n            </Pressable>\n\n            <Pressable\n              onPress={() => setFlashOn(!flashOn)}\n              style={[\n                styles.sideButton,\n                { backgroundColor: flashOn ? theme.accent : \"rgba(255,255,255,0.2)\" },\n              ]}\n            >\n              <Feather name={flashOn ? \"zap\" : \"zap-off\"} size={24} color=\"#FFFFFF\" />\n            </Pressable>\n          </View>\n        </CameraView>\n      )}\n    </View>\n  );\n}\n\nfunction Spacer({ height }: { height: number }) {\n  return <View style={{ height }} />;\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  permissionContainer: {\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    padding: Spacing[\"2xl\"],\n  },\n  permissionIcon: {\n    width: 96,\n    height: 96,\n    borderRadius: 48,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginBottom: Spacing.xl,\n  },\n  permissionTitle: {\n    textAlign: \"center\",\n    marginBottom: Spacing.md,\n  },\n  permissionText: {\n    textAlign: \"center\",\n    marginBottom: Spacing.xl,\n    maxWidth: 300,\n  },\n  permissionButton: {\n    minWidth: 200,\n  },\n  camera: {\n    flex: 1,\n  },\n  overlay: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  scannerFrame: {\n    width: 250,\n    height: 250,\n    position: \"relative\",\n  },\n  corner: {\n    position: \"absolute\",\n    width: 40,\n    height: 40,\n    borderWidth: 4,\n  },\n  topLeft: {\n    top: 0,\n    left: 0,\n    borderRightWidth: 0,\n    borderBottomWidth: 0,\n    borderTopLeftRadius: BorderRadius.md,\n  },\n  topRight: {\n    top: 0,\n    right: 0,\n    borderLeftWidth: 0,\n    borderBottomWidth: 0,\n    borderTopRightRadius: BorderRadius.md,\n  },\n  bottomLeft: {\n    bottom: 0,\n    left: 0,\n    borderRightWidth: 0,\n    borderTopWidth: 0,\n    borderBottomLeftRadius: BorderRadius.md,\n  },\n  bottomRight: {\n    bottom: 0,\n    right: 0,\n    borderLeftWidth: 0,\n    borderTopWidth: 0,\n    borderBottomRightRadius: BorderRadius.md,\n  },\n  scanHint: {\n    color: \"#FFFFFF\",\n    marginTop: Spacing.xl,\n    textShadowColor: \"rgba(0,0,0,0.5)\",\n    textShadowOffset: { width: 0, height: 1 },\n    textShadowRadius: 4,\n  },\n  controls: {\n    position: \"absolute\",\n    bottom: 0,\n    left: 0,\n    right: 0,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    gap: Spacing[\"3xl\"],\n  },\n  sideButton: {\n    width: 48,\n    height: 48,\n    borderRadius: 24,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  captureButton: {\n    width: 72,\n    height: 72,\n    borderRadius: 36,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    borderWidth: 4,\n    borderColor: \"#FFFFFF\",\n  },\n  captureInner: {\n    width: 56,\n    height: 56,\n    borderRadius: 28,\n    backgroundColor: \"#FFFFFF\",\n  },\n  webFallback: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    padding: Spacing[\"2xl\"],\n  },\n  webTitle: {\n    textAlign: \"center\",\n    marginBottom: Spacing.md,\n  },\n  webText: {\n    textAlign: \"center\",\n    maxWidth: 300,\n  },\n  galleryButton: {\n    minWidth: 220,\n  },\n});\n","path":null,"size_bytes":11885,"size_tokens":null},"screens/PharmacyDetailScreen.tsx":{"content":"import React from \"react\";\nimport { View, StyleSheet, Linking, Platform } from \"react-native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { RouteProp } from \"@react-navigation/native\";\nimport { Feather } from \"@expo/vector-icons\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { Button } from \"@/components/Button\";\nimport Spacer from \"@/components/Spacer\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Shadows, MedicalColors } from \"@/constants/theme\";\nimport { PharmacyStackParamList } from \"@/navigation/PharmacyStackNavigator\";\n\ntype PharmacyDetailScreenProps = {\n  navigation: NativeStackNavigationProp<PharmacyStackParamList, \"PharmacyDetail\">;\n  route: RouteProp<PharmacyStackParamList, \"PharmacyDetail\">;\n};\n\nexport default function PharmacyDetailScreen({ navigation, route }: PharmacyDetailScreenProps) {\n  const { theme } = useTheme();\n  const { pharmacyId } = route.params;\n\n  const pharmacyData = {\n    id: pharmacyId,\n    name: \"HealthPlus Pharmacy\",\n    address: \"123 Main Street, City Center\",\n    phone: \"+1 234 567 8900\",\n    hours: \"Mon-Fri: 8AM-9PM, Sat-Sun: 9AM-6PM\",\n    isVerified: true,\n    is24Hours: false,\n    rating: 4.8,\n    reviewCount: 124,\n    distance: \"0.3 km\",\n    walkingTime: \"4 min\",\n    latitude: 41.3111,\n    longitude: 69.2797,\n  };\n\n  const inventoryItems = [\n    { name: \"Acetaminophen 500mg\", inStock: true, price: 12.99 },\n    { name: \"Ibuprofen 200mg\", inStock: true, price: 9.99 },\n    { name: \"Amoxicillin 500mg\", inStock: false, price: 24.99 },\n    { name: \"Lisinopril 10mg\", inStock: true, price: 18.99 },\n  ];\n\n  const handleCall = () => {\n    Linking.openURL(`tel:${pharmacyData.phone}`);\n  };\n\n  const handleDirections = () => {\n    const url = Platform.select({\n      ios: `maps://app?daddr=${pharmacyData.latitude},${pharmacyData.longitude}`,\n      android: `google.navigation:q=${pharmacyData.latitude},${pharmacyData.longitude}`,\n      default: `https://www.google.com/maps/dir/?api=1&destination=${pharmacyData.latitude},${pharmacyData.longitude}`,\n    });\n\n    Linking.openURL(url).catch(() => {\n      Linking.openURL(\n        `https://www.google.com/maps/dir/?api=1&destination=${pharmacyData.latitude},${pharmacyData.longitude}`\n      );\n    });\n  };\n\n  return (\n    <ScreenScrollView>\n      <View style={[styles.headerCard, { backgroundColor: theme.cardBackground }, Shadows.medium]}>\n        <View style={styles.headerTop}>\n          <View style={[styles.pharmacyIcon, { backgroundColor: theme.primary + \"20\" }]}>\n            <Feather name=\"map-pin\" size={32} color={theme.primary} />\n          </View>\n          {pharmacyData.isVerified ? (\n            <View style={[styles.verifiedBadge, { backgroundColor: MedicalColors.verified }]}>\n              <Feather name=\"check\" size={14} color=\"#FFFFFF\" />\n              <ThemedText type=\"caption\" style={styles.verifiedText}>\n                Verified\n              </ThemedText>\n            </View>\n          ) : null}\n        </View>\n\n        <ThemedText type=\"h2\" style={styles.pharmacyName}>\n          {pharmacyData.name}\n        </ThemedText>\n\n        <View style={styles.ratingRow}>\n          <Feather name=\"star\" size={16} color={theme.accent} />\n          <ThemedText type=\"label\" style={styles.rating}>\n            {pharmacyData.rating}\n          </ThemedText>\n          <ThemedText type=\"small\" style={{ color: theme.textSecondary }}>\n            ({pharmacyData.reviewCount} reviews)\n          </ThemedText>\n        </View>\n\n        <Spacer height={Spacing.lg} />\n\n        <View style={styles.quickStats}>\n          <View style={styles.quickStat}>\n            <Feather name=\"map-pin\" size={20} color={theme.textSecondary} />\n            <ThemedText type=\"body\">{pharmacyData.distance}</ThemedText>\n          </View>\n          <View style={styles.quickStat}>\n            <Feather name=\"clock\" size={20} color={theme.textSecondary} />\n            <ThemedText type=\"body\">{pharmacyData.walkingTime}</ThemedText>\n          </View>\n          {pharmacyData.is24Hours ? (\n            <View style={[styles.badge24, { backgroundColor: theme.secondary }]}>\n              <ThemedText type=\"caption\" style={{ color: \"#FFFFFF\", fontWeight: \"600\" }}>\n                24/7\n              </ThemedText>\n            </View>\n          ) : null}\n        </View>\n      </View>\n\n      <Spacer height={Spacing.lg} />\n\n      <View style={styles.actionButtons}>\n        <Button onPress={handleDirections} style={styles.actionButton}>\n          <Feather name=\"navigation\" size={18} color=\"#FFFFFF\" />\n          <ThemedText type=\"label\" style={styles.actionButtonText}>\n            Directions\n          </ThemedText>\n        </Button>\n        <Button\n          onPress={handleCall}\n          style={[styles.actionButton, { backgroundColor: theme.secondary }]}\n        >\n          <Feather name=\"phone\" size={18} color=\"#FFFFFF\" />\n          <ThemedText type=\"label\" style={styles.actionButtonText}>\n            Call\n          </ThemedText>\n        </Button>\n      </View>\n\n      <Spacer height={Spacing.xl} />\n\n      <ThemedText type=\"h3\">Contact Information</ThemedText>\n      <Spacer height={Spacing.md} />\n\n      <View style={[styles.infoCard, { backgroundColor: theme.cardBackground }, Shadows.small]}>\n        <View style={styles.infoRow}>\n          <Feather name=\"map-pin\" size={20} color={theme.textSecondary} />\n          <ThemedText type=\"body\" style={styles.infoText}>\n            {pharmacyData.address}\n          </ThemedText>\n        </View>\n        <View style={[styles.divider, { backgroundColor: theme.border }]} />\n        <View style={styles.infoRow}>\n          <Feather name=\"phone\" size={20} color={theme.textSecondary} />\n          <ThemedText type=\"body\" style={styles.infoText}>\n            {pharmacyData.phone}\n          </ThemedText>\n        </View>\n        <View style={[styles.divider, { backgroundColor: theme.border }]} />\n        <View style={styles.infoRow}>\n          <Feather name=\"clock\" size={20} color={theme.textSecondary} />\n          <ThemedText type=\"body\" style={styles.infoText}>\n            {pharmacyData.hours}\n          </ThemedText>\n        </View>\n      </View>\n\n      <Spacer height={Spacing.xl} />\n\n      <ThemedText type=\"h3\">Medication Inventory</ThemedText>\n      <Spacer height={Spacing.md} />\n\n      <View style={[styles.inventoryCard, { backgroundColor: theme.cardBackground }, Shadows.small]}>\n        {inventoryItems.map((item, index) => (\n          <React.Fragment key={index}>\n            {index > 0 ? <View style={[styles.divider, { backgroundColor: theme.border }]} /> : null}\n            <View style={styles.inventoryRow}>\n              <View style={styles.inventoryInfo}>\n                <ThemedText type=\"body\">{item.name}</ThemedText>\n                <View\n                  style={[\n                    styles.stockBadge,\n                    {\n                      backgroundColor: item.inStock\n                        ? MedicalColors.safe + \"20\"\n                        : theme.backgroundSecondary,\n                    },\n                  ]}\n                >\n                  <ThemedText\n                    type=\"caption\"\n                    style={{\n                      color: item.inStock ? MedicalColors.safe : theme.textSecondary,\n                    }}\n                  >\n                    {item.inStock ? \"In Stock\" : \"Out of Stock\"}\n                  </ThemedText>\n                </View>\n              </View>\n              <ThemedText type=\"h4\" style={{ color: theme.primary }}>\n                ${item.price.toFixed(2)}\n              </ThemedText>\n            </View>\n          </React.Fragment>\n        ))}\n      </View>\n\n      <Spacer height={Spacing[\"3xl\"]} />\n    </ScreenScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  headerCard: {\n    borderRadius: BorderRadius.xl,\n    padding: Spacing.xl,\n  },\n  headerTop: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"flex-start\",\n    marginBottom: Spacing.lg,\n  },\n  pharmacyIcon: {\n    width: 64,\n    height: 64,\n    borderRadius: 32,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  verifiedBadge: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.sm,\n    borderRadius: BorderRadius.sm,\n    gap: Spacing.xs,\n  },\n  verifiedText: {\n    color: \"#FFFFFF\",\n    fontWeight: \"600\",\n  },\n  pharmacyName: {\n    marginBottom: Spacing.sm,\n  },\n  ratingRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.xs,\n  },\n  rating: {\n    marginLeft: Spacing.xs,\n  },\n  quickStats: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.xl,\n  },\n  quickStat: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: Spacing.sm,\n  },\n  badge24: {\n    paddingHorizontal: Spacing.md,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.sm,\n  },\n  actionButtons: {\n    flexDirection: \"row\",\n    gap: Spacing.md,\n  },\n  actionButton: {\n    flex: 1,\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    gap: Spacing.sm,\n  },\n  actionButtonText: {\n    color: \"#FFFFFF\",\n  },\n  infoCard: {\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.lg,\n  },\n  infoRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingVertical: Spacing.sm,\n  },\n  infoText: {\n    flex: 1,\n    marginLeft: Spacing.md,\n  },\n  divider: {\n    height: 1,\n  },\n  inventoryCard: {\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.lg,\n  },\n  inventoryRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    paddingVertical: Spacing.md,\n  },\n  inventoryInfo: {\n    flex: 1,\n    gap: Spacing.sm,\n  },\n  stockBadge: {\n    alignSelf: \"flex-start\",\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: 2,\n    borderRadius: BorderRadius.xs,\n  },\n});\n","path":null,"size_bytes":9952,"size_tokens":null},"components/MedCard.tsx":{"content":"import React from \"react\";\nimport { StyleSheet, Pressable, View, ViewStyle } from \"react-native\";\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n  WithSpringConfig,\n} from \"react-native-reanimated\";\nimport { Feather } from \"@expo/vector-icons\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Shadows } from \"@/constants/theme\";\n\ninterface MedCardProps {\n  title: string;\n  subtitle?: string;\n  leftIcon?: keyof typeof Feather.glyphMap;\n  rightIcon?: keyof typeof Feather.glyphMap;\n  onPress?: () => void;\n  children?: React.ReactNode;\n  style?: ViewStyle;\n  badge?: string;\n  badgeColor?: string;\n}\n\nconst springConfig: WithSpringConfig = {\n  damping: 15,\n  mass: 0.3,\n  stiffness: 150,\n  overshootClamping: true,\n  energyThreshold: 0.001,\n};\n\nconst AnimatedPressable = Animated.createAnimatedComponent(Pressable);\n\nexport function MedCard({\n  title,\n  subtitle,\n  leftIcon,\n  rightIcon = \"chevron-right\",\n  onPress,\n  children,\n  style,\n  badge,\n  badgeColor,\n}: MedCardProps) {\n  const { theme } = useTheme();\n  const scale = useSharedValue(1);\n\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ scale: scale.value }],\n  }));\n\n  const handlePressIn = () => {\n    if (onPress) {\n      scale.value = withSpring(0.98, springConfig);\n    }\n  };\n\n  const handlePressOut = () => {\n    if (onPress) {\n      scale.value = withSpring(1, springConfig);\n    }\n  };\n\n  return (\n    <AnimatedPressable\n      onPress={onPress}\n      onPressIn={handlePressIn}\n      onPressOut={handlePressOut}\n      disabled={!onPress}\n      style={[\n        styles.card,\n        {\n          backgroundColor: theme.cardBackground,\n        },\n        Shadows.medium,\n        style,\n        animatedStyle,\n      ]}\n    >\n      <View style={styles.header}>\n        {leftIcon ? (\n          <View style={[styles.iconContainer, { backgroundColor: theme.backgroundSecondary }]}>\n            <Feather name={leftIcon} size={20} color={theme.primary} />\n          </View>\n        ) : null}\n        <View style={styles.titleContainer}>\n          <View style={styles.titleRow}>\n            <ThemedText type=\"h4\" style={styles.title} numberOfLines={1}>\n              {title}\n            </ThemedText>\n            {badge ? (\n              <View style={[styles.badge, { backgroundColor: badgeColor || theme.primary }]}>\n                <ThemedText type=\"caption\" style={styles.badgeText}>\n                  {badge}\n                </ThemedText>\n              </View>\n            ) : null}\n          </View>\n          {subtitle ? (\n            <ThemedText\n              type=\"small\"\n              style={[styles.subtitle, { color: theme.textSecondary }]}\n              numberOfLines={1}\n            >\n              {subtitle}\n            </ThemedText>\n          ) : null}\n        </View>\n        {onPress && rightIcon ? (\n          <Feather name={rightIcon} size={20} color={theme.textSecondary} />\n        ) : null}\n      </View>\n      {children ? <View style={styles.content}>{children}</View> : null}\n    </AnimatedPressable>\n  );\n}\n\nconst styles = StyleSheet.create({\n  card: {\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.lg,\n  },\n  header: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  iconContainer: {\n    width: 40,\n    height: 40,\n    borderRadius: BorderRadius.md,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginRight: Spacing.md,\n  },\n  titleContainer: {\n    flex: 1,\n  },\n  titleRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  title: {\n    flex: 1,\n  },\n  subtitle: {\n    marginTop: Spacing.xs,\n  },\n  content: {\n    marginTop: Spacing.md,\n  },\n  badge: {\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.xs,\n    marginLeft: Spacing.sm,\n  },\n  badgeText: {\n    color: \"#FFFFFF\",\n    fontWeight: \"600\",\n  },\n});\n","path":null,"size_bytes":3918,"size_tokens":null},"replit.md":{"content":"# MediScan AI - Medication Scanner & Health Assistant\n\n## Overview\n\nMediScan AI is a cross-platform React Native mobile application that combines computer vision, AI-powered analysis, and health data management to help users identify medications, check drug interactions, and manage their medication schedules. The app is designed with accessibility in mind, requiring no authentication for immediate access while offering comprehensive medication tracking and safety features.\n\n**Core Purpose:** Empower users (especially older adults and patients on multiple medications) to safely identify pills, avoid dangerous drug interactions, and maintain medication adherence through visual scanning, AI assistance, and gamification.\n\n**Key Features:**\n- Visual pill recognition using camera/image analysis\n- Drug interaction checking with severity warnings\n- Medication reminders and adherence tracking\n- Pharmacy locator with price comparison and fraud detection\n- Voice assistant for hands-free queries\n- Gamification system with rewards for consistent adherence\n- Family panel for caregiver monitoring\n- Multi-language support (English, Uzbek, Russian)\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Framework:** React Native 0.81.5 with Expo SDK 54\n- **Rendering:** New Architecture enabled for improved performance\n- **Type Safety:** TypeScript with strict mode enabled\n- **Navigation:** React Navigation v7 with native stack and bottom tab navigators\n- **State Management:** React hooks and local component state (no global state library)\n- **Animations:** React Native Reanimated v4 for 60fps animations with spring physics\n- **Styling:** StyleSheet API with centralized theme system supporting light/dark modes\n\n**Navigation Structure:**\n- 5-tab bottom navigation (Home, Interactions, Scanner, Pharmacy, Profile)\n- Each tab contains a stack navigator for deep navigation\n- Floating voice assistant button accessible from all screens\n- Native iOS blur effects on tab bar and headers (platform-specific)\n\n**UI Components:**\n- Custom themed components (ThemedText, ThemedView) respecting system color scheme\n- Reusable cards with spring animations (MedCard, PharmacyCard, ReminderCard)\n- Screen wrappers handling safe areas and keyboard avoidance\n- Material Design 3 inspired with medical color palette (green primary, severity-based accents)\n\n**Key Design Patterns:**\n- **Component Composition:** Atomic design with small, reusable components\n- **Screen Containers:** Specialized scroll views (ScreenScrollView, ScreenKeyboardAwareScrollView) managing insets\n- **Animation Pattern:** Shared values with spring configs for consistent feel across interactions\n- **Error Handling:** Class-based ErrorBoundary with dev-mode stack traces\n- **Platform Abstraction:** Conditional rendering for iOS/Android/Web differences\n\n### Data Layer\n\n**Local Storage:** AsyncStorage for all persistent data\n- No backend server - fully offline-capable\n- Key-value storage with JSON serialization\n- Separated storage keys for different data domains\n\n**Data Models:**\n- **UserProfile:** Demographics, allergies, chronic conditions, preferences\n- **Medication:** Scanned pill details with visual features and warnings\n- **Reminder:** Medication schedule with frequency and adherence tracking\n- **ScanHistory:** Timestamped pill scans with confidence scores\n- **GamificationData:** Points, streaks, achievements, and level progression\n- **FamilyMember:** Linked caregivers with invite codes\n- **Settings:** App preferences (theme, language, notifications)\n\n**Drug Database:**\n- Comprehensive in-memory database (COMPREHENSIVE_DRUG_DATABASE) with 100+ medications\n- Drug interaction matrix (EXTENDED_INTERACTIONS) with severity levels\n- Search capabilities by name, generic name, or features\n- Safety checking against user profile (pregnancy, allergies, age, conditions)\n\n### AI & Computer Vision\n\n**Pill Recognition Strategy:**\n- Visual feature extraction from camera/uploaded images\n- Shape, color, and imprint matching against drug database\n- Confidence scoring based on feature matches\n- Fallback to text-based search if visual match fails\n- Mock CNN classification (placeholder for future ML model integration)\n\n**Drug Interaction Analysis:**\n- Rule-based interaction checking using interaction matrix\n- AI-enhanced summaries and recommendations\n- Risk level scoring (low/moderate/high/critical)\n- Management advice for identified interactions\n- Support for checking up to 40 drugs simultaneously (DrugBank API ready)\n\n**Voice Assistant:**\n- Text-based query processing (speech recognition placeholder)\n- Intent detection for medication queries, reminders, and interactions\n- Multi-language response generation (English, Uzbek, Russian)\n- Context-aware responses based on user's medication history\n\n**Price Anomaly Detection:**\n- Statistical analysis of pharmacy pricing\n- Fraud detection using price distribution and outlier detection\n- Anomaly scoring with threshold-based flagging\n- Warning system for suspiciously low/high prices\n\n### Platform-Specific Adaptations\n\n**iOS:**\n- Blur effects on headers and tab bar using expo-blur\n- SF Symbols support via expo-symbols (iOS 18+)\n- Haptic feedback for interactions\n- Edge-to-edge safe area handling\n\n**Android:**\n- Edge-to-edge display with Material You adaptive icons\n- Platform-specific permissions (camera, microphone, location)\n- Solid backgrounds instead of blur effects\n\n**Web:**\n- Fallback to standard ScrollView (no KeyboardAwareScrollView)\n- Simplified navigation without native gestures\n- Static rendering support with hydration\n\n### Performance Optimizations\n\n- **Animation:** Reanimated worklets running on UI thread\n- **Navigation:** Native stack navigators for native performance\n- **Images:** expo-image with caching and optimization\n- **List Rendering:** FlatList with proper key extraction\n- **Memo/Callback:** Strategic use of useFocusEffect and useCallback for screen lifecycle\n- **Spring Physics:** Tuned spring configs (damping: 15, stiffness: 150) for snappy feel\n\n### Accessibility & Localization\n\n- Large font sizes following Material Design typography scale\n- High contrast colors meeting WCAG standards\n- Screen reader support through semantic components\n- Multi-language support (English, Uzbek, Russian) at data layer\n- Clear iconography with labels (Feather icons throughout)\n\n### Error Handling & Resilience\n\n- Error boundary catches rendering errors with dev/prod modes\n- Fallback UI with restart capability\n- Detailed error logging in development\n- Graceful degradation for missing data (empty states)\n- Permission request flows with explanatory UI\n\n## External Dependencies\n\n### Core Framework\n- **expo (54.0.23):** Development platform and native module management\n- **react-native (0.81.5):** Mobile framework\n- **react (19.1.0):** UI library with new architecture\n\n### Navigation\n- **@react-navigation/native (7.1.8):** Navigation framework\n- **@react-navigation/native-stack (7.3.16):** Native stack navigator\n- **@react-navigation/bottom-tabs (7.4.0):** Tab navigation\n- **react-native-screens (4.16.0):** Native screen optimization\n\n### UI & Animation\n- **react-native-reanimated (4.1.1):** High-performance animations\n- **react-native-gesture-handler (2.28.0):** Touch handling\n- **expo-blur (15.0.7):** iOS blur effects\n- **expo-linear-gradient (15.0.7):** Gradient backgrounds\n- **expo-haptics (15.0.7):** Tactile feedback\n- **@expo/vector-icons (15.0.2):** Feather icon set\n\n### Device Features\n- **expo-camera (17.0.9):** Camera access for pill scanning\n- **expo-image-picker (17.0.8):** Photo library access\n- **expo-location (19.0.7):** Pharmacy location services\n- **expo-clipboard (8.0.7):** Copy/paste functionality\n\n### Storage & Data\n- **@react-native-async-storage/async-storage (2.2.0):** Persistent key-value storage\n\n### Utilities\n- **react-native-safe-area-context (5.6.0):** Safe area insets\n- **react-native-keyboard-controller (1.18.5):** Keyboard management\n- **expo-constants (18.0.9):** App constants and environment\n\n### Development Tools\n- **TypeScript (~19.1.0):** Type safety\n- **ESLint (9.25.0):** Code linting with Expo config\n- **Prettier:** Code formatting\n- **babel-plugin-module-resolver:** Path aliasing (@/ imports)\n\n### Future Integration Points\n- **DrugBank API:** Professional drug interaction data (currently using local database)\n- **OpenAI API:** Enhanced conversational AI for voice assistant (currently mock)\n- **ML Model:** CNN for visual pill recognition (currently feature-based matching)\n- **Push Notifications:** Medication reminders (expo-notifications ready)\n- **Analytics:** Usage tracking and health insights (placeholder in gamification)","path":null,"size_bytes":8747,"size_tokens":null},"navigation/InteractionsStackNavigator.tsx":{"content":"import React from \"react\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport InteractionsScreen from \"@/screens/InteractionsScreen\";\nimport InteractionResultScreen from \"@/screens/InteractionResultScreen\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { getCommonScreenOptions } from \"@/navigation/screenOptions\";\n\nexport type InteractionsStackParamList = {\n  Interactions: undefined;\n  InteractionResult: { medications: string[] };\n};\n\nconst Stack = createNativeStackNavigator<InteractionsStackParamList>();\n\nexport default function InteractionsStackNavigator() {\n  const { theme, isDark } = useTheme();\n\n  return (\n    <Stack.Navigator screenOptions={getCommonScreenOptions({ theme, isDark })}>\n      <Stack.Screen\n        name=\"Interactions\"\n        component={InteractionsScreen}\n        options={{ headerTitle: \"Drug Interactions\" }}\n      />\n      <Stack.Screen\n        name=\"InteractionResult\"\n        component={InteractionResultScreen}\n        options={{ headerTitle: \"Results\" }}\n      />\n    </Stack.Navigator>\n  );\n}\n","path":null,"size_bytes":1069,"size_tokens":null},"navigation/ProfileStackNavigator.tsx":{"content":"import React from \"react\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport ProfileScreen from \"@/screens/ProfileScreen\";\nimport RewardsScreen from \"@/screens/RewardsScreen\";\nimport SettingsScreen from \"@/screens/SettingsScreen\";\nimport FamilyPanelScreen from \"@/screens/FamilyPanelScreen\";\nimport TravelScreen from \"@/screens/TravelScreen\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { getCommonScreenOptions } from \"@/navigation/screenOptions\";\n\nexport type ProfileStackParamList = {\n  Profile: undefined;\n  Rewards: undefined;\n  Settings: undefined;\n  FamilyPanel: undefined;\n  Travel: undefined;\n};\n\nconst Stack = createNativeStackNavigator<ProfileStackParamList>();\n\nexport default function ProfileStackNavigator() {\n  const { theme, isDark } = useTheme();\n\n  return (\n    <Stack.Navigator screenOptions={getCommonScreenOptions({ theme, isDark })}>\n      <Stack.Screen\n        name=\"Profile\"\n        component={ProfileScreen}\n        options={{ headerTitle: \"Profile\" }}\n      />\n      <Stack.Screen\n        name=\"Rewards\"\n        component={RewardsScreen}\n        options={{ headerTitle: \"Rewards\" }}\n      />\n      <Stack.Screen\n        name=\"Settings\"\n        component={SettingsScreen}\n        options={{ headerTitle: \"Settings\" }}\n      />\n      <Stack.Screen\n        name=\"FamilyPanel\"\n        component={FamilyPanelScreen}\n        options={{ headerTitle: \"Family Panel\" }}\n      />\n      <Stack.Screen\n        name=\"Travel\"\n        component={TravelScreen}\n        options={{ headerTitle: \"Travel Mode\" }}\n      />\n    </Stack.Navigator>\n  );\n}\n","path":null,"size_bytes":1601,"size_tokens":null},"navigation/ScannerStackNavigator.tsx":{"content":"import React from \"react\";\nimport { createNativeStackNavigator } from \"@react-navigation/native-stack\";\nimport ScannerScreen from \"@/screens/ScannerScreen\";\nimport ScanResultScreen from \"@/screens/ScanResultScreen\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { getCommonScreenOptions } from \"@/navigation/screenOptions\";\n\nexport type ScannerStackParamList = {\n  Scanner: undefined;\n  ScanResult: { imageUri: string };\n};\n\nconst Stack = createNativeStackNavigator<ScannerStackParamList>();\n\nexport default function ScannerStackNavigator() {\n  const { theme, isDark } = useTheme();\n\n  return (\n    <Stack.Navigator screenOptions={getCommonScreenOptions({ theme, isDark })}>\n      <Stack.Screen\n        name=\"Scanner\"\n        component={ScannerScreen}\n        options={{\n          headerTitle: \"Scan Pill\",\n          headerTransparent: true,\n        }}\n      />\n      <Stack.Screen\n        name=\"ScanResult\"\n        component={ScanResultScreen}\n        options={{ headerTitle: \"Scan Result\" }}\n      />\n    </Stack.Navigator>\n  );\n}\n","path":null,"size_bytes":1039,"size_tokens":null},"utils/notifications.ts":{"content":"import * as Notifications from \"expo-notifications\";\nimport { Platform } from \"react-native\";\nimport { Reminder, getSettings } from \"./storage\";\n\nNotifications.setNotificationHandler({\n  handleNotification: async () => ({\n    shouldShowAlert: true,\n    shouldPlaySound: true,\n    shouldSetBadge: true,\n    shouldShowBanner: true,\n    shouldShowList: true,\n  }),\n});\n\nexport interface ScheduledNotification {\n  reminderId: string;\n  notificationId: string;\n  scheduledTime: Date;\n}\n\nconst scheduledNotifications: ScheduledNotification[] = [];\n\nexport async function requestNotificationPermissions(): Promise<boolean> {\n  if (Platform.OS === \"web\") {\n    return false;\n  }\n  \n  const { status: existingStatus } = await Notifications.getPermissionsAsync();\n  \n  if (existingStatus === \"granted\") {\n    return true;\n  }\n  \n  const { status } = await Notifications.requestPermissionsAsync();\n  return status === \"granted\";\n}\n\nexport async function checkNotificationPermissions(): Promise<\"granted\" | \"denied\" | \"undetermined\"> {\n  if (Platform.OS === \"web\") {\n    return \"denied\";\n  }\n  \n  const { status } = await Notifications.getPermissionsAsync();\n  return status;\n}\n\nexport async function scheduleReminderNotification(reminder: Reminder): Promise<string | null> {\n  if (Platform.OS === \"web\") {\n    console.log(\"[Notifications] Web platform - notifications simulated\");\n    return `web-sim-${reminder.id}`;\n  }\n  \n  const settings = await getSettings();\n  if (!settings.reminderNotifications) {\n    return null;\n  }\n  \n  const hasPermission = await requestNotificationPermissions();\n  if (!hasPermission) {\n    return null;\n  }\n  \n  await cancelReminderNotification(reminder.id);\n  \n  const [hours, minutes] = reminder.time.split(\":\").map(Number);\n  \n  const trigger: Notifications.DailyTriggerInput = {\n    type: Notifications.SchedulableTriggerInputTypes.DAILY,\n    hour: hours,\n    minute: minutes,\n  };\n  \n  const notificationId = await Notifications.scheduleNotificationAsync({\n    content: {\n      title: \"Time for your medication\",\n      body: `Take ${reminder.medicationName} (${reminder.dosage})`,\n      sound: true,\n      data: {\n        reminderId: reminder.id,\n        medicationName: reminder.medicationName,\n        type: \"medication_reminder\",\n      },\n      badge: 1,\n    },\n    trigger,\n  });\n  \n  scheduledNotifications.push({\n    reminderId: reminder.id,\n    notificationId,\n    scheduledTime: new Date(),\n  });\n  \n  return notificationId;\n}\n\nexport async function cancelReminderNotification(reminderId: string): Promise<void> {\n  if (Platform.OS === \"web\") {\n    return;\n  }\n  \n  const scheduled = scheduledNotifications.filter(n => n.reminderId === reminderId);\n  \n  for (const notification of scheduled) {\n    await Notifications.cancelScheduledNotificationAsync(notification.notificationId);\n  }\n  \n  const remainingNotifications = scheduledNotifications.filter(n => n.reminderId !== reminderId);\n  scheduledNotifications.length = 0;\n  scheduledNotifications.push(...remainingNotifications);\n}\n\nexport async function cancelAllNotifications(): Promise<void> {\n  if (Platform.OS === \"web\") {\n    return;\n  }\n  \n  await Notifications.cancelAllScheduledNotificationsAsync();\n  scheduledNotifications.length = 0;\n}\n\nexport async function getScheduledNotifications(): Promise<Notifications.NotificationRequest[]> {\n  if (Platform.OS === \"web\") {\n    return [];\n  }\n  \n  return await Notifications.getAllScheduledNotificationsAsync();\n}\n\nexport async function scheduleImmediateNotification(title: string, body: string): Promise<void> {\n  if (Platform.OS === \"web\") {\n    console.log(`[Notification] ${title}: ${body}`);\n    return;\n  }\n  \n  const hasPermission = await requestNotificationPermissions();\n  if (!hasPermission) return;\n  \n  await Notifications.scheduleNotificationAsync({\n    content: {\n      title,\n      body,\n      sound: true,\n    },\n    trigger: null,\n  });\n}\n\nexport async function scheduleMissedDoseReminder(reminder: Reminder): Promise<void> {\n  if (Platform.OS === \"web\") return;\n  \n  const [hours, minutes] = reminder.time.split(\":\").map(Number);\n  const scheduledTime = new Date();\n  scheduledTime.setHours(hours, minutes, 0, 0);\n  \n  const followUpTime = new Date(scheduledTime.getTime() + 30 * 60 * 1000);\n  \n  const now = new Date();\n  if (followUpTime > now) {\n    const secondsUntil = Math.floor((followUpTime.getTime() - now.getTime()) / 1000);\n    \n    await Notifications.scheduleNotificationAsync({\n      content: {\n        title: \"Missed Medication Reminder\",\n        body: `Have you taken ${reminder.medicationName}? It was scheduled for ${reminder.time}`,\n        sound: true,\n        data: {\n          reminderId: reminder.id,\n          type: \"missed_dose_followup\",\n        },\n      },\n      trigger: {\n        type: Notifications.SchedulableTriggerInputTypes.TIME_INTERVAL,\n        seconds: secondsUntil,\n      },\n    });\n  }\n}\n\nexport interface AdherenceStats {\n  weeklyAdherence: number;\n  monthlyAdherence: number;\n  currentStreak: number;\n  longestStreak: number;\n  totalDosesTaken: number;\n  totalDosesMissed: number;\n  adherenceByDay: { [day: string]: number };\n}\n\nexport function calculateAdherenceStats(reminders: Reminder[]): AdherenceStats {\n  const today = new Date();\n  const stats: AdherenceStats = {\n    weeklyAdherence: 0,\n    monthlyAdherence: 0,\n    currentStreak: 0,\n    longestStreak: 0,\n    totalDosesTaken: 0,\n    totalDosesMissed: 0,\n    adherenceByDay: {},\n  };\n  \n  if (reminders.length === 0) {\n    return stats;\n  }\n  \n  const enabledReminders = reminders.filter(r => r.isEnabled);\n  if (enabledReminders.length === 0) {\n    return stats;\n  }\n  \n  const last7Days: string[] = [];\n  const last30Days: string[] = [];\n  \n  for (let i = 0; i < 30; i++) {\n    const date = new Date(today);\n    date.setDate(date.getDate() - i);\n    const dateStr = date.toISOString().split(\"T\")[0];\n    last30Days.push(dateStr);\n    if (i < 7) {\n      last7Days.push(dateStr);\n    }\n  }\n  \n  let weeklyTaken = 0;\n  let weeklyTotal = 0;\n  let monthlyTaken = 0;\n  let monthlyTotal = 0;\n  \n  for (const dateStr of last7Days) {\n    let takenCount = 0;\n    for (const reminder of enabledReminders) {\n      if (reminder.takenDates.includes(dateStr)) {\n        takenCount++;\n        stats.totalDosesTaken++;\n      } else {\n        stats.totalDosesMissed++;\n      }\n    }\n    weeklyTaken += takenCount;\n    weeklyTotal += enabledReminders.length;\n    stats.adherenceByDay[dateStr] = enabledReminders.length > 0 \n      ? takenCount / enabledReminders.length \n      : 0;\n  }\n  \n  for (const dateStr of last30Days.slice(7)) {\n    let takenCount = 0;\n    for (const reminder of enabledReminders) {\n      if (reminder.takenDates.includes(dateStr)) {\n        takenCount++;\n      }\n    }\n    monthlyTaken += takenCount;\n    monthlyTotal += enabledReminders.length;\n  }\n  \n  stats.weeklyAdherence = weeklyTotal > 0 ? (weeklyTaken / weeklyTotal) * 100 : 0;\n  stats.monthlyAdherence = (weeklyTotal + monthlyTotal) > 0 \n    ? ((weeklyTaken + monthlyTaken) / (weeklyTotal + monthlyTotal)) * 100 \n    : 0;\n  \n  let currentStreak = 0;\n  let longestStreak = 0;\n  let tempStreak = 0;\n  \n  for (let i = 0; i < 90; i++) {\n    const date = new Date(today);\n    date.setDate(date.getDate() - i);\n    const dateStr = date.toISOString().split(\"T\")[0];\n    \n    let allTaken = true;\n    for (const reminder of enabledReminders) {\n      if (!reminder.takenDates.includes(dateStr)) {\n        allTaken = false;\n        break;\n      }\n    }\n    \n    if (allTaken && enabledReminders.length > 0) {\n      tempStreak++;\n      if (i === 0 || currentStreak > 0) {\n        currentStreak = tempStreak;\n      }\n    } else {\n      if (tempStreak > longestStreak) {\n        longestStreak = tempStreak;\n      }\n      if (i === 0) {\n        currentStreak = 0;\n      }\n      tempStreak = 0;\n    }\n  }\n  \n  if (tempStreak > longestStreak) {\n    longestStreak = tempStreak;\n  }\n  \n  stats.currentStreak = currentStreak;\n  stats.longestStreak = Math.max(longestStreak, currentStreak);\n  \n  return stats;\n}\n\nexport function getAdherenceColor(adherence: number): string {\n  if (adherence >= 90) return \"#10B981\";\n  if (adherence >= 70) return \"#F59E0B\";\n  if (adherence >= 50) return \"#F97316\";\n  return \"#EF4444\";\n}\n\nexport function getAdherenceLabel(adherence: number): string {\n  if (adherence >= 90) return \"Excellent\";\n  if (adherence >= 70) return \"Good\";\n  if (adherence >= 50) return \"Fair\";\n  return \"Needs Improvement\";\n}\n","path":null,"size_bytes":8439,"size_tokens":null},"components/MapViewContainer.native.tsx":{"content":"import React, { useRef } from \"react\";\nimport { View, StyleSheet, Pressable } from \"react-native\";\nimport MapView, { Marker, PROVIDER_GOOGLE, Region } from \"react-native-maps\";\nimport { Feather } from \"@expo/vector-icons\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Shadows, MedicalColors } from \"@/constants/theme\";\n\ninterface PharmacyMarker {\n  id: string;\n  name: string;\n  address: string;\n  distance: string;\n  latitude: number;\n  longitude: number;\n  isVerified: boolean;\n}\n\ninterface MapViewContainerProps {\n  region: Region;\n  onRegionChange: (region: Region) => void;\n  pharmacies: PharmacyMarker[];\n  userLocation: { latitude: number; longitude: number } | null;\n  locationPermission: boolean;\n}\n\nexport function MapViewContainer({\n  region,\n  onRegionChange,\n  pharmacies,\n  userLocation,\n  locationPermission,\n}: MapViewContainerProps) {\n  const { theme } = useTheme();\n  const mapRef = useRef<MapView>(null);\n\n  const centerOnUser = () => {\n    if (userLocation && mapRef.current) {\n      mapRef.current.animateToRegion({\n        ...userLocation,\n        latitudeDelta: 0.02,\n        longitudeDelta: 0.02,\n      }, 500);\n    }\n  };\n\n  return (\n    <View style={styles.mapContainer}>\n      <MapView\n        ref={mapRef}\n        style={styles.map}\n        provider={PROVIDER_GOOGLE}\n        region={region}\n        showsUserLocation={locationPermission}\n        showsMyLocationButton={false}\n        onRegionChangeComplete={onRegionChange}\n      >\n        {pharmacies.filter(p => p.latitude !== 0).map((pharmacy) => (\n          <Marker\n            key={pharmacy.id}\n            coordinate={{\n              latitude: pharmacy.latitude,\n              longitude: pharmacy.longitude,\n            }}\n            title={pharmacy.name}\n            description={`${pharmacy.address} - ${pharmacy.distance}`}\n            pinColor={pharmacy.isVerified ? MedicalColors.verified : MedicalColors.unverified}\n          />\n        ))}\n      </MapView>\n      <View style={styles.mapOverlay}>\n        <Pressable\n          style={[styles.myLocationButton, { backgroundColor: theme.backgroundRoot }]}\n          onPress={centerOnUser}\n        >\n          <Feather name=\"navigation\" size={20} color={theme.primary} />\n        </Pressable>\n      </View>\n      <View style={styles.mapLegend}>\n        <View style={[styles.legendItem, { backgroundColor: theme.backgroundRoot }]}>\n          <View style={[styles.legendDot, { backgroundColor: MedicalColors.verified }]} />\n          <ThemedText type=\"caption\">Verified</ThemedText>\n        </View>\n        <View style={[styles.legendItem, { backgroundColor: theme.backgroundRoot }]}>\n          <View style={[styles.legendDot, { backgroundColor: MedicalColors.unverified }]} />\n          <ThemedText type=\"caption\">Unverified</ThemedText>\n        </View>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  mapContainer: {\n    height: \"35%\",\n    position: \"relative\",\n  },\n  map: {\n    flex: 1,\n  },\n  mapOverlay: {\n    position: \"absolute\",\n    top: Spacing.lg,\n    right: Spacing.lg,\n  },\n  myLocationButton: {\n    width: 44,\n    height: 44,\n    borderRadius: 22,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    ...Shadows.sm,\n  },\n  mapLegend: {\n    position: \"absolute\",\n    bottom: Spacing.xl + 20,\n    left: Spacing.lg,\n    flexDirection: \"row\",\n    gap: Spacing.md,\n  },\n  legendItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.sm,\n    paddingVertical: Spacing.xs,\n    borderRadius: BorderRadius.sm,\n    gap: Spacing.xs,\n    ...Shadows.sm,\n  },\n  legendDot: {\n    width: 10,\n    height: 10,\n    borderRadius: 5,\n  },\n});\n","path":null,"size_bytes":3724,"size_tokens":null},"components/MapViewContainer.web.tsx":{"content":"import React from \"react\";\nimport { View, StyleSheet } from \"react-native\";\nimport { Feather } from \"@expo/vector-icons\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, MedicalColors } from \"@/constants/theme\";\n\ninterface Region {\n  latitude: number;\n  longitude: number;\n  latitudeDelta: number;\n  longitudeDelta: number;\n}\n\ninterface PharmacyMarker {\n  id: string;\n  name: string;\n  address: string;\n  distance: string;\n  latitude: number;\n  longitude: number;\n  isVerified: boolean;\n}\n\ninterface MapViewContainerProps {\n  region: Region;\n  onRegionChange: (region: Region) => void;\n  pharmacies: PharmacyMarker[];\n  userLocation: { latitude: number; longitude: number } | null;\n  locationPermission: boolean;\n}\n\nexport function MapViewContainer({\n  pharmacies,\n}: MapViewContainerProps) {\n  const { theme } = useTheme();\n\n  return (\n    <View style={[styles.mapPlaceholder, { backgroundColor: theme.backgroundSecondary }]}>\n      <View style={styles.mapContent}>\n        <Feather name=\"map\" size={48} color={theme.textSecondary} />\n        <ThemedText type=\"body\" style={[styles.mapText, { color: theme.textSecondary }]}>\n          Map view available in Expo Go\n        </ThemedText>\n        <ThemedText type=\"caption\" style={{ color: theme.textSecondary, textAlign: \"center\" }}>\n          Scan the QR code with your phone to view the interactive map\n        </ThemedText>\n      </View>\n      <View style={styles.pharmacyMarkers}>\n        {pharmacies.slice(0, 4).filter(p => p.latitude !== 0).map((pharmacy, index) => (\n          <View\n            key={pharmacy.id}\n            style={[\n              styles.marker,\n              {\n                backgroundColor: pharmacy.isVerified\n                  ? MedicalColors.verified\n                  : MedicalColors.unverified,\n                left: 40 + index * 60,\n                top: 30 + (index % 2) * 40,\n              },\n            ]}\n          >\n            <Feather name=\"map-pin\" size={16} color=\"#FFFFFF\" />\n          </View>\n        ))}\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  mapPlaceholder: {\n    height: \"35%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    position: \"relative\",\n  },\n  mapContent: {\n    alignItems: \"center\",\n    paddingHorizontal: Spacing.xl,\n  },\n  mapText: {\n    marginTop: Spacing.md,\n    marginBottom: Spacing.sm,\n  },\n  pharmacyMarkers: {\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n  },\n  marker: {\n    position: \"absolute\",\n    width: 32,\n    height: 32,\n    borderRadius: 16,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n});\n","path":null,"size_bytes":2684,"size_tokens":null},"utils/gamification.ts":{"content":"import {\n  getGamificationData,\n  saveGamificationData,\n  GamificationData,\n  getScanHistory,\n  getReminders,\n} from \"./storage\";\n\nexport interface Achievement {\n  id: string;\n  name: string;\n  description: string;\n  icon: string;\n  condition: (data: GamificationData, stats: UserStats) => boolean;\n  points: number;\n}\n\nexport interface ActivityItem {\n  id: string;\n  action: string;\n  points: number;\n  timestamp: string;\n}\n\nexport interface UserStats {\n  totalScans: number;\n  totalInteractionsChecked: number;\n  totalReportsSubmitted: number;\n  remindersTakenToday: number;\n  currentStreak: number;\n}\n\nconst ACTIVITY_STORAGE_KEY = \"@mediscan_recent_activity\";\n\nexport const ACHIEVEMENTS: Achievement[] = [\n  {\n    id: \"first_scan\",\n    name: \"First Scan\",\n    description: \"Scan your first pill\",\n    icon: \"camera\",\n    condition: (_, stats) => stats.totalScans >= 1,\n    points: 10,\n  },\n  {\n    id: \"scanner_5\",\n    name: \"Getting Started\",\n    description: \"Scan 5 different pills\",\n    icon: \"camera\",\n    condition: (_, stats) => stats.totalScans >= 5,\n    points: 25,\n  },\n  {\n    id: \"scanner_25\",\n    name: \"Pill Identifier\",\n    description: \"Scan 25 different pills\",\n    icon: \"camera\",\n    condition: (_, stats) => stats.totalScans >= 25,\n    points: 100,\n  },\n  {\n    id: \"scanner_50\",\n    name: \"Pill Expert\",\n    description: \"Scan 50 different pills\",\n    icon: \"award\",\n    condition: (_, stats) => stats.totalScans >= 50,\n    points: 200,\n  },\n  {\n    id: \"streak_3\",\n    name: \"Consistent\",\n    description: \"3-day medication streak\",\n    icon: \"zap\",\n    condition: (data) => data.streak >= 3,\n    points: 30,\n  },\n  {\n    id: \"streak_7\",\n    name: \"Week Warrior\",\n    description: \"7-day medication streak\",\n    icon: \"zap\",\n    condition: (data) => data.streak >= 7,\n    points: 50,\n  },\n  {\n    id: \"streak_30\",\n    name: \"Monthly Master\",\n    description: \"30-day medication streak\",\n    icon: \"zap\",\n    condition: (data) => data.streak >= 30,\n    points: 200,\n  },\n  {\n    id: \"interaction_1\",\n    name: \"Safety First\",\n    description: \"Check your first drug interaction\",\n    icon: \"alert-triangle\",\n    condition: (_, stats) => stats.totalInteractionsChecked >= 1,\n    points: 15,\n  },\n  {\n    id: \"interaction_10\",\n    name: \"Interaction Detective\",\n    description: \"Check 10 drug interactions\",\n    icon: \"search\",\n    condition: (_, stats) => stats.totalInteractionsChecked >= 10,\n    points: 75,\n  },\n  {\n    id: \"interaction_20\",\n    name: \"Pharmacology Pro\",\n    description: \"Check 20 drug interactions\",\n    icon: \"search\",\n    condition: (_, stats) => stats.totalInteractionsChecked >= 20,\n    points: 150,\n  },\n  {\n    id: \"reporter_1\",\n    name: \"Watchful Citizen\",\n    description: \"Report your first suspicious listing\",\n    icon: \"eye\",\n    condition: (_, stats) => stats.totalReportsSubmitted >= 1,\n    points: 25,\n  },\n  {\n    id: \"reporter_10\",\n    name: \"Watchful Eye\",\n    description: \"Report 10 suspicious listings\",\n    icon: \"eye\",\n    condition: (_, stats) => stats.totalReportsSubmitted >= 10,\n    points: 100,\n  },\n  {\n    id: \"level_5\",\n    name: \"Rising Star\",\n    description: \"Reach Level 5\",\n    icon: \"star\",\n    condition: (data) => data.level >= 5,\n    points: 100,\n  },\n  {\n    id: \"level_10\",\n    name: \"Medication Master\",\n    description: \"Reach Level 10\",\n    icon: \"star\",\n    condition: (data) => data.level >= 10,\n    points: 300,\n  },\n  {\n    id: \"level_20\",\n    name: \"Health Guardian\",\n    description: \"Reach Level 20\",\n    icon: \"shield\",\n    condition: (data) => data.level >= 20,\n    points: 500,\n  },\n];\n\nexport const POINT_VALUES = {\n  scan: 10,\n  interaction_check: 15,\n  reminder_taken: 5,\n  report_submitted: 20,\n  streak_bonus: 5,\n  daily_login: 2,\n};\n\nasync function getRecentActivity(): Promise<ActivityItem[]> {\n  try {\n    const AsyncStorage = require(\"@react-native-async-storage/async-storage\").default;\n    const data = await AsyncStorage.getItem(ACTIVITY_STORAGE_KEY);\n    return data ? JSON.parse(data) : [];\n  } catch {\n    return [];\n  }\n}\n\nasync function saveRecentActivity(activities: ActivityItem[]): Promise<void> {\n  try {\n    const AsyncStorage = require(\"@react-native-async-storage/async-storage\").default;\n    const recentActivities = activities.slice(-50);\n    await AsyncStorage.setItem(ACTIVITY_STORAGE_KEY, JSON.stringify(recentActivities));\n  } catch (error) {\n    console.error(\"Error saving activity:\", error);\n  }\n}\n\nasync function addActivity(action: string, points: number): Promise<void> {\n  const activities = await getRecentActivity();\n  activities.push({\n    id: Date.now().toString(),\n    action,\n    points,\n    timestamp: new Date().toISOString(),\n  });\n  await saveRecentActivity(activities);\n}\n\nexport async function getLatestActivity(count: number = 10): Promise<ActivityItem[]> {\n  const activities = await getRecentActivity();\n  return activities.slice(-count).reverse();\n}\n\nexport async function getUserStats(): Promise<UserStats> {\n  const scanHistory = await getScanHistory();\n  const gamification = await getGamificationData();\n  const reminders = await getReminders();\n  \n  const today = new Date().toISOString().split(\"T\")[0];\n  const remindersTakenToday = reminders.filter(r => \n    r.isEnabled && r.takenDates.includes(today)\n  ).length;\n  \n  return {\n    totalScans: scanHistory.length,\n    totalInteractionsChecked: gamification.totalInteractionsChecked || 0,\n    totalReportsSubmitted: gamification.totalReportsSubmitted || 0,\n    remindersTakenToday,\n    currentStreak: gamification.streak,\n  };\n}\n\nfunction calculateLevel(points: number): number {\n  return Math.floor(points / 100) + 1;\n}\n\nasync function checkAndUnlockAchievements(\n  data: GamificationData,\n  stats: UserStats\n): Promise<string[]> {\n  const newlyUnlocked: string[] = [];\n  \n  for (const achievement of ACHIEVEMENTS) {\n    if (!data.achievements.includes(achievement.id)) {\n      if (achievement.condition(data, stats)) {\n        newlyUnlocked.push(achievement.id);\n      }\n    }\n  }\n  \n  return newlyUnlocked;\n}\n\nexport async function awardPoints(\n  action: \"scan\" | \"interaction_check\" | \"reminder_taken\" | \"report_submitted\" | \"daily_login\",\n  description?: string\n): Promise<{ \n  pointsAwarded: number; \n  newAchievements: string[]; \n  newLevel: boolean;\n  currentData: GamificationData;\n}> {\n  const data = await getGamificationData();\n  const stats = await getUserStats();\n  const today = new Date().toISOString().split(\"T\")[0];\n  \n  let pointsAwarded = POINT_VALUES[action];\n  \n  if (data.lastActiveDate !== today) {\n    pointsAwarded += POINT_VALUES.daily_login;\n  }\n  \n  const streakBonus = Math.min(data.streak, 10) * POINT_VALUES.streak_bonus;\n  if (action === \"reminder_taken\") {\n    pointsAwarded += streakBonus;\n  }\n  \n  if (action === \"scan\") {\n    data.scansThisWeek++;\n  } else if (action === \"interaction_check\") {\n    data.reportsThisMonth++;\n    data.totalInteractionsChecked = (data.totalInteractionsChecked || 0) + 1;\n  } else if (action === \"report_submitted\") {\n    data.totalReportsSubmitted = (data.totalReportsSubmitted || 0) + 1;\n  }\n  \n  const oldLevel = data.level;\n  data.points += pointsAwarded;\n  data.level = calculateLevel(data.points);\n  data.lastActiveDate = today;\n  \n  const updatedStats = { ...stats };\n  if (action === \"scan\") {\n    updatedStats.totalScans++;\n  } else if (action === \"interaction_check\") {\n    updatedStats.totalInteractionsChecked++;\n  } else if (action === \"report_submitted\") {\n    updatedStats.totalReportsSubmitted++;\n  }\n  \n  const newAchievements = await checkAndUnlockAchievements(data, updatedStats);\n  \n  for (const achievementId of newAchievements) {\n    const achievement = ACHIEVEMENTS.find(a => a.id === achievementId);\n    if (achievement) {\n      data.points += achievement.points;\n      data.achievements.push(achievement.id);\n      await addActivity(`Unlocked: ${achievement.name}`, achievement.points);\n    }\n  }\n  \n  data.level = calculateLevel(data.points);\n  \n  await saveGamificationData(data);\n  \n  const actionDescriptions: Record<string, string> = {\n    scan: description || \"Scanned a medication\",\n    interaction_check: \"Checked drug interactions\",\n    reminder_taken: \"Completed medication reminder\",\n    report_submitted: \"Reported suspicious listing\",\n    daily_login: \"Daily login bonus\",\n  };\n  \n  await addActivity(actionDescriptions[action], POINT_VALUES[action]);\n  \n  return {\n    pointsAwarded,\n    newAchievements,\n    newLevel: data.level > oldLevel,\n    currentData: data,\n  };\n}\n\nexport async function updateStreak(): Promise<{\n  streak: number;\n  streakBroken: boolean;\n  streakMaintained: boolean;\n}> {\n  const data = await getGamificationData();\n  const reminders = await getReminders();\n  const today = new Date().toISOString().split(\"T\")[0];\n  \n  const yesterday = new Date();\n  yesterday.setDate(yesterday.getDate() - 1);\n  const yesterdayStr = yesterday.toISOString().split(\"T\")[0];\n  \n  const enabledReminders = reminders.filter(r => r.isEnabled);\n  if (enabledReminders.length === 0) {\n    return { streak: data.streak, streakBroken: false, streakMaintained: true };\n  }\n  \n  const allTakenToday = enabledReminders.every(r => r.takenDates.includes(today));\n  const allTakenYesterday = enabledReminders.every(r => r.takenDates.includes(yesterdayStr));\n  \n  let streakBroken = false;\n  let streakMaintained = false;\n  \n  if (data.lastActiveDate !== today && data.lastActiveDate !== yesterdayStr) {\n    data.streak = 0;\n    streakBroken = true;\n  } else if (!allTakenYesterday && data.lastActiveDate === yesterdayStr) {\n    data.streak = 0;\n    streakBroken = true;\n  }\n  \n  if (allTakenToday) {\n    if (data.lastActiveDate !== today) {\n      data.streak++;\n      streakMaintained = true;\n    }\n  }\n  \n  data.lastActiveDate = today;\n  await saveGamificationData(data);\n  \n  return {\n    streak: data.streak,\n    streakBroken,\n    streakMaintained,\n  };\n}\n\nexport async function resetWeeklyStats(): Promise<void> {\n  const data = await getGamificationData();\n  const today = new Date();\n  \n  if (today.getDay() === 0) {\n    data.scansThisWeek = 0;\n  }\n  \n  if (today.getDate() === 1) {\n    data.reportsThisMonth = 0;\n  }\n  \n  await saveGamificationData(data);\n}\n\nexport function getAchievementProgress(\n  achievementId: string,\n  data: GamificationData,\n  stats: UserStats\n): number {\n  const achievement = ACHIEVEMENTS.find(a => a.id === achievementId);\n  if (!achievement) return 0;\n  \n  if (data.achievements.includes(achievementId)) return 1;\n  \n  switch (achievementId) {\n    case \"first_scan\":\n      return Math.min(stats.totalScans / 1, 1);\n    case \"scanner_5\":\n      return Math.min(stats.totalScans / 5, 1);\n    case \"scanner_25\":\n      return Math.min(stats.totalScans / 25, 1);\n    case \"scanner_50\":\n      return Math.min(stats.totalScans / 50, 1);\n    case \"streak_3\":\n      return Math.min(data.streak / 3, 1);\n    case \"streak_7\":\n      return Math.min(data.streak / 7, 1);\n    case \"streak_30\":\n      return Math.min(data.streak / 30, 1);\n    case \"interaction_1\":\n      return Math.min(stats.totalInteractionsChecked / 1, 1);\n    case \"interaction_10\":\n      return Math.min(stats.totalInteractionsChecked / 10, 1);\n    case \"interaction_20\":\n      return Math.min(stats.totalInteractionsChecked / 20, 1);\n    case \"reporter_1\":\n      return Math.min(stats.totalReportsSubmitted / 1, 1);\n    case \"reporter_10\":\n      return Math.min(stats.totalReportsSubmitted / 10, 1);\n    case \"level_5\":\n      return Math.min(data.level / 5, 1);\n    case \"level_10\":\n      return Math.min(data.level / 10, 1);\n    case \"level_20\":\n      return Math.min(data.level / 20, 1);\n    default:\n      return 0;\n  }\n}\n\nexport async function getUnlockedAchievements(): Promise<Achievement[]> {\n  const data = await getGamificationData();\n  return ACHIEVEMENTS.filter(a => data.achievements.includes(a.id));\n}\n\nexport async function getLockedAchievements(): Promise<Achievement[]> {\n  const data = await getGamificationData();\n  return ACHIEVEMENTS.filter(a => !data.achievements.includes(a.id));\n}\n","path":null,"size_bytes":12010,"size_tokens":null},"screens/TravelScreen.tsx":{"content":"import React, { useState, useCallback } from \"react\";\nimport {\n  View,\n  StyleSheet,\n  Pressable,\n  ActivityIndicator,\n  Platform,\n  Linking,\n} from \"react-native\";\nimport { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport { useFocusEffect } from \"@react-navigation/native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport * as Speech from \"expo-speech\";\nimport * as Clipboard from \"expo-clipboard\";\nimport * as Haptics from \"expo-haptics\";\nimport * as Location from \"expo-location\";\n\nimport { ThemedText } from \"@/components/ThemedText\";\nimport { ScreenScrollView } from \"@/components/ScreenScrollView\";\nimport { Button } from \"@/components/Button\";\nimport Spacer from \"@/components/Spacer\";\nimport { useTheme } from \"@/hooks/useTheme\";\nimport { Spacing, BorderRadius, Shadows } from \"@/constants/theme\";\nimport { ProfileStackParamList } from \"@/navigation/ProfileStackNavigator\";\nimport { getUserProfile, getSettings, saveSettings, UserProfile, Settings } from \"@/utils/storage\";\nimport {\n  CountryInfo,\n  COUNTRIES,\n  PHARMACY_PHRASES,\n  EXCHANGE_RATES,\n  formatCurrency,\n  convertCurrency,\n  detectCurrentCountry,\n  translateMedication,\n  MEDICATION_TRANSLATIONS,\n  TRAVEL_HEALTH_TIPS,\n} from \"@/utils/tourism\";\n\ntype TravelScreenProps = {\n  navigation: NativeStackNavigationProp<ProfileStackParamList, \"Travel\">;\n};\n\nconst SAMPLE_MEDICATIONS = [\n  \"Aspirin\",\n  \"Ibuprofen\",\n  \"Acetaminophen\",\n  \"Omeprazole\",\n  \"Metformin\",\n];\n\nexport default function TravelScreen({ navigation }: TravelScreenProps) {\n  const { theme } = useTheme();\n  const [profile, setProfile] = useState<UserProfile | null>(null);\n  const [settings, setSettings] = useState<Settings | null>(null);\n  const [detectedCountry, setDetectedCountry] = useState<CountryInfo | null>(null);\n  const [isDetecting, setIsDetecting] = useState(false);\n  const [selectedCountry, setSelectedCountry] = useState<CountryInfo | null>(null);\n  const [isSpeaking, setIsSpeaking] = useState(false);\n  const [locationPermission, requestLocationPermission] = Location.useForegroundPermissions();\n\n  useFocusEffect(\n    useCallback(() => {\n      const loadData = async () => {\n        const [profileData, settingsData] = await Promise.all([\n          getUserProfile(),\n          getSettings(),\n        ]);\n        setProfile(profileData);\n        setSettings(settingsData);\n\n        if (settingsData.travelDestination && COUNTRIES[settingsData.travelDestination]) {\n          setSelectedCountry(COUNTRIES[settingsData.travelDestination]);\n        }\n\n        if (settingsData.medicalTourismMode && locationPermission?.granted) {\n          detectLocation();\n        }\n      };\n      loadData();\n    }, [locationPermission?.granted])\n  );\n\n  const detectLocation = async () => {\n    if (Platform.OS === \"web\") {\n      try {\n        const response = await fetch(\"https://ipapi.co/json/\");\n        const data = await response.json();\n        const countryCode = data.country_code;\n        if (COUNTRIES[countryCode]) {\n          setDetectedCountry(COUNTRIES[countryCode]);\n          if (!selectedCountry) {\n            setSelectedCountry(COUNTRIES[countryCode]);\n          }\n        }\n      } catch {\n        console.log(\"Could not detect location via IP\");\n      }\n      return;\n    }\n\n    if (!locationPermission?.granted) {\n      const result = await requestLocationPermission();\n      if (!result.granted) {\n        return;\n      }\n    }\n\n    setIsDetecting(true);\n    try {\n      const country = await detectCurrentCountry();\n      if (country) {\n        setDetectedCountry(country);\n        if (!selectedCountry) {\n          setSelectedCountry(country);\n        }\n      }\n    } catch (error) {\n      console.log(\"Location detection error:\", error);\n    } finally {\n      setIsDetecting(false);\n    }\n  };\n\n  const handleSelectCountry = async (country: CountryInfo) => {\n    setSelectedCountry(country);\n    if (settings) {\n      const updatedSettings = { ...settings, travelDestination: country.code };\n      setSettings(updatedSettings);\n      await saveSettings(updatedSettings);\n    }\n  };\n\n  const openSettings = async () => {\n    if (Platform.OS !== \"web\") {\n      try {\n        await Linking.openSettings();\n      } catch {\n        console.log(\"Could not open settings\");\n      }\n    }\n  };\n\n  const speakPhrase = async (phrase: string) => {\n    if (isSpeaking) {\n      await Speech.stop();\n      setIsSpeaking(false);\n      return;\n    }\n\n    setIsSpeaking(true);\n    const langCode = selectedCountry?.languageCode || \"en\";\n    \n    await Speech.speak(phrase, {\n      language: langCode,\n      rate: 0.8,\n      onDone: () => setIsSpeaking(false),\n      onStopped: () => setIsSpeaking(false),\n      onError: () => setIsSpeaking(false),\n    });\n  };\n\n  const copyToClipboard = async (text: string) => {\n    await Clipboard.setStringAsync(text);\n    if (Platform.OS !== \"web\") {\n      Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n    }\n  };\n\n  const destinationCountry = selectedCountry || COUNTRIES.UZ;\n  const homeCurrency = profile?.currency || \"USD\";\n  const localCurrency = destinationCountry.currency;\n  const localLang = destinationCountry.languageCode;\n  const phrases = PHARMACY_PHRASES[localLang] || PHARMACY_PHRASES.en;\n  const healthTips = TRAVEL_HEALTH_TIPS[destinationCountry.code] || [];\n\n  const countryList = Object.values(COUNTRIES);\n\n  return (\n    <ScreenScrollView>\n      <View style={[styles.headerCard, { backgroundColor: theme.primary }]}>\n        <Feather name=\"globe\" size={32} color=\"#FFFFFF\" />\n        <Spacer height={Spacing.md} />\n        <ThemedText type=\"h2\" style={{ color: \"#FFFFFF\" }}>\n          Medical Tourism Mode\n        </ThemedText>\n        <ThemedText type=\"body\" style={{ color: \"rgba(255,255,255,0.8)\" }}>\n          Travel health assistance at your fingertips\n        </ThemedText>\n      </View>\n\n      <Spacer height={Spacing.xl} />\n\n      <ThemedText type=\"h3\">Current Location</ThemedText>\n      <Spacer height={Spacing.md} />\n\n      <View style={[styles.card, { backgroundColor: theme.cardBackground }, Shadows.small]}>\n        {isDetecting ? (\n          <View style={styles.detectingRow}>\n            <ActivityIndicator color={theme.primary} />\n            <ThemedText type=\"body\" style={{ marginLeft: Spacing.md }}>\n              Detecting your location...\n            </ThemedText>\n          </View>\n        ) : locationPermission?.status === \"denied\" && !locationPermission.canAskAgain ? (\n          <View style={styles.permissionDeniedContainer}>\n            <ThemedText type=\"body\" style={{ color: theme.textSecondary, marginBottom: Spacing.md }}>\n              Location access is required for automatic detection. Please enable it in Settings.\n            </ThemedText>\n            {Platform.OS !== \"web\" && (\n              <Button onPress={openSettings} variant=\"secondary\">\n                Open Settings\n              </Button>\n            )}\n          </View>\n        ) : !locationPermission?.granted && Platform.OS !== \"web\" ? (\n          <View style={styles.permissionDeniedContainer}>\n            <ThemedText type=\"body\" style={{ color: theme.textSecondary, marginBottom: Spacing.md }}>\n              Enable location access to automatically detect your travel destination.\n            </ThemedText>\n            <Button onPress={detectLocation}>\n              Enable Location\n            </Button>\n          </View>\n        ) : detectedCountry ? (\n          <View style={styles.locationRow}>\n            <View style={styles.locationInfo}>\n              <ThemedText type=\"h4\">{detectedCountry.name}</ThemedText>\n              <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                {detectedCountry.currency} - {detectedCountry.language}\n              </ThemedText>\n            </View>\n            <Pressable\n              onPress={detectLocation}\n              style={({ pressed }) => [\n                styles.refreshButton,\n                { backgroundColor: theme.backgroundSecondary, opacity: pressed ? 0.7 : 1 },\n              ]}\n            >\n              <Feather name=\"refresh-cw\" size={18} color={theme.primary} />\n            </Pressable>\n          </View>\n        ) : (\n          <View style={styles.locationRow}>\n            <ThemedText type=\"body\" style={{ color: theme.textSecondary, flex: 1 }}>\n              {Platform.OS === \"web\"\n                ? \"Location detection uses IP geolocation on web. Select a destination below.\"\n                : \"Tap to detect your location, or select a destination below.\"}\n            </ThemedText>\n            <Pressable\n              onPress={detectLocation}\n              style={({ pressed }) => [\n                styles.refreshButton,\n                { backgroundColor: theme.primary, opacity: pressed ? 0.7 : 1 },\n              ]}\n            >\n              <Feather name=\"map-pin\" size={18} color=\"#FFFFFF\" />\n            </Pressable>\n          </View>\n        )}\n      </View>\n\n      <Spacer height={Spacing.xl} />\n\n      <ThemedText type=\"h3\">Select Destination</ThemedText>\n      <Spacer height={Spacing.md} />\n\n      <View style={styles.countryGrid}>\n        {countryList.map((country) => (\n          <Pressable\n            key={country.code}\n            onPress={() => handleSelectCountry(country)}\n            style={({ pressed }) => [\n              styles.countryChip,\n              {\n                backgroundColor:\n                  selectedCountry?.code === country.code\n                    ? theme.primary\n                    : theme.cardBackground,\n                opacity: pressed ? 0.7 : 1,\n              },\n              Shadows.small,\n            ]}\n          >\n            <ThemedText\n              type=\"label\"\n              style={{\n                color:\n                  selectedCountry?.code === country.code ? \"#FFFFFF\" : theme.text,\n              }}\n            >\n              {country.name}\n            </ThemedText>\n            <ThemedText\n              type=\"caption\"\n              style={{\n                color:\n                  selectedCountry?.code === country.code\n                    ? \"rgba(255,255,255,0.8)\"\n                    : theme.textSecondary,\n              }}\n            >\n              {country.currency}\n            </ThemedText>\n          </Pressable>\n        ))}\n      </View>\n\n      <Spacer height={Spacing.xl} />\n\n      <ThemedText type=\"h3\">Currency Conversion</ThemedText>\n      <Spacer height={Spacing.md} />\n\n      <View style={[styles.card, { backgroundColor: theme.cardBackground }, Shadows.small]}>\n        <View style={styles.conversionHeader}>\n          <View style={styles.currencyBox}>\n            <ThemedText type=\"h2\" style={{ color: theme.primary }}>\n              {formatCurrency(100, homeCurrency)}\n            </ThemedText>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              {homeCurrency}\n            </ThemedText>\n          </View>\n          <Feather name=\"arrow-right\" size={24} color={theme.textSecondary} />\n          <View style={styles.currencyBox}>\n            <ThemedText type=\"h2\" style={{ color: theme.accent }}>\n              {formatCurrency(\n                convertCurrency(100, homeCurrency, localCurrency),\n                localCurrency\n              )}\n            </ThemedText>\n            <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n              {localCurrency}\n            </ThemedText>\n          </View>\n        </View>\n        <View style={[styles.divider, { backgroundColor: theme.border }]} />\n        <ThemedText type=\"caption\" style={{ color: theme.textSecondary, textAlign: \"center\" }}>\n          Exchange rate: 1 {homeCurrency} = {formatCurrency(convertCurrency(1, homeCurrency, localCurrency), localCurrency)}\n        </ThemedText>\n      </View>\n\n      <Spacer height={Spacing.xl} />\n\n      <ThemedText type=\"h3\">Medication Translations</ThemedText>\n      <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n        Common medications in {destinationCountry.language}\n      </ThemedText>\n      <Spacer height={Spacing.md} />\n\n      <View style={[styles.card, { backgroundColor: theme.cardBackground }, Shadows.small]}>\n        {SAMPLE_MEDICATIONS.map((med, index) => {\n          const translation = translateMedication(med, localLang);\n          return (\n            <View key={med}>\n              <Pressable\n                onPress={() => speakPhrase(translation.name)}\n                style={({ pressed }) => [\n                  styles.translationRow,\n                  { opacity: pressed ? 0.7 : 1 },\n                ]}\n              >\n                <View style={styles.translationText}>\n                  <ThemedText type=\"body\">{med}</ThemedText>\n                  <ThemedText type=\"h4\" style={{ color: theme.primary }}>\n                    {translation.name}\n                  </ThemedText>\n                  {translation.pronunciation && (\n                    <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                      ({translation.pronunciation})\n                    </ThemedText>\n                  )}\n                </View>\n                <Feather name=\"volume-2\" size={20} color={theme.primary} />\n              </Pressable>\n              {index < SAMPLE_MEDICATIONS.length - 1 && (\n                <View style={[styles.divider, { backgroundColor: theme.border }]} />\n              )}\n            </View>\n          );\n        })}\n      </View>\n\n      <Spacer height={Spacing.xl} />\n\n      <ThemedText type=\"h3\">Pharmacy Phrases</ThemedText>\n      <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n        Essential phrases in {destinationCountry.language}\n      </ThemedText>\n      <Spacer height={Spacing.md} />\n\n      <View style={[styles.card, { backgroundColor: theme.cardBackground }, Shadows.small]}>\n        {phrases.map((item, index) => (\n          <View key={index}>\n            <View style={styles.phraseRow}>\n              <View style={styles.phraseText}>\n                <ThemedText type=\"body\" style={{ color: theme.primary }}>\n                  {item.phrase}\n                </ThemedText>\n                {item.pronunciation && (\n                  <ThemedText type=\"caption\" style={{ color: theme.textSecondary }}>\n                    {item.pronunciation}\n                  </ThemedText>\n                )}\n              </View>\n              <View style={styles.phraseActions}>\n                <Pressable\n                  onPress={() => speakPhrase(item.phrase)}\n                  style={({ pressed }) => [\n                    styles.actionButton,\n                    { backgroundColor: theme.backgroundSecondary, opacity: pressed ? 0.7 : 1 },\n                  ]}\n                >\n                  <Feather\n                    name={isSpeaking ? \"pause\" : \"volume-2\"}\n                    size={16}\n                    color={theme.primary}\n                  />\n                </Pressable>\n                <Pressable\n                  onPress={() => copyToClipboard(item.phrase)}\n                  style={({ pressed }) => [\n                    styles.actionButton,\n                    { backgroundColor: theme.backgroundSecondary, opacity: pressed ? 0.7 : 1 },\n                  ]}\n                >\n                  <Feather name=\"copy\" size={16} color={theme.primary} />\n                </Pressable>\n              </View>\n            </View>\n            {index < phrases.length - 1 && (\n              <View style={[styles.divider, { backgroundColor: theme.border }]} />\n            )}\n          </View>\n        ))}\n      </View>\n\n      <Spacer height={Spacing.xl} />\n\n      <ThemedText type=\"h3\">Local Health Tips</ThemedText>\n      <Spacer height={Spacing.md} />\n\n      <View style={[styles.card, { backgroundColor: theme.cardBackground }, Shadows.small]}>\n        <View style={styles.infoRow}>\n          <Feather name=\"phone\" size={20} color={theme.error} />\n          <View style={styles.infoText}>\n            <ThemedText type=\"label\">Emergency Number</ThemedText>\n            <ThemedText type=\"h3\" style={{ color: theme.error }}>\n              {destinationCountry.emergencyNumber}\n            </ThemedText>\n          </View>\n        </View>\n\n        <View style={[styles.divider, { backgroundColor: theme.border }]} />\n\n        <View style={styles.infoRow}>\n          <Feather name=\"info\" size={20} color={theme.primary} />\n          <View style={styles.infoText}>\n            <ThemedText type=\"label\">Pharmacy Tip</ThemedText>\n            <ThemedText type=\"body\" style={{ color: theme.textSecondary }}>\n              {destinationCountry.pharmacyTip}\n            </ThemedText>\n          </View>\n        </View>\n\n        {healthTips.length > 0 && (\n          <>\n            <View style={[styles.divider, { backgroundColor: theme.border }]} />\n            <View style={styles.tipsContainer}>\n              <ThemedText type=\"label\" style={{ marginBottom: Spacing.sm }}>\n                Travel Health Tips\n              </ThemedText>\n              {healthTips.map((tip, index) => (\n                <View key={index} style={styles.tipRow}>\n                  <View style={[styles.tipBullet, { backgroundColor: theme.primary }]} />\n                  <ThemedText type=\"caption\" style={{ color: theme.textSecondary, flex: 1 }}>\n                    {tip}\n                  </ThemedText>\n                </View>\n              ))}\n            </View>\n          </>\n        )}\n      </View>\n\n      <Spacer height={Spacing[\"3xl\"]} />\n    </ScreenScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  headerCard: {\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.xl,\n    alignItems: \"center\",\n  },\n  card: {\n    borderRadius: BorderRadius.lg,\n    padding: Spacing.lg,\n  },\n  detectingRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingVertical: Spacing.md,\n  },\n  permissionDeniedContainer: {\n    alignItems: \"center\",\n    paddingVertical: Spacing.md,\n  },\n  locationRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n  },\n  locationInfo: {\n    flex: 1,\n  },\n  refreshButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  countryGrid: {\n    flexDirection: \"row\",\n    flexWrap: \"wrap\",\n    gap: Spacing.sm,\n  },\n  countryChip: {\n    paddingHorizontal: Spacing.lg,\n    paddingVertical: Spacing.md,\n    borderRadius: BorderRadius.md,\n    alignItems: \"center\",\n  },\n  conversionHeader: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-around\",\n    paddingVertical: Spacing.md,\n  },\n  currencyBox: {\n    alignItems: \"center\",\n  },\n  divider: {\n    height: 1,\n    marginVertical: Spacing.md,\n  },\n  translationRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    paddingVertical: Spacing.sm,\n  },\n  translationText: {\n    flex: 1,\n  },\n  phraseRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    paddingVertical: Spacing.sm,\n  },\n  phraseText: {\n    flex: 1,\n  },\n  phraseActions: {\n    flexDirection: \"row\",\n    gap: Spacing.sm,\n  },\n  actionButton: {\n    width: 36,\n    height: 36,\n    borderRadius: 18,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  infoRow: {\n    flexDirection: \"row\",\n    alignItems: \"flex-start\",\n    gap: Spacing.md,\n  },\n  infoText: {\n    flex: 1,\n  },\n  tipsContainer: {\n    paddingTop: Spacing.sm,\n  },\n  tipRow: {\n    flexDirection: \"row\",\n    alignItems: \"flex-start\",\n    marginBottom: Spacing.sm,\n    gap: Spacing.sm,\n  },\n  tipBullet: {\n    width: 6,\n    height: 6,\n    borderRadius: 3,\n    marginTop: 6,\n  },\n});\n","path":null,"size_bytes":19670,"size_tokens":null},"utils/tourism.ts":{"content":"import * as Location from \"expo-location\";\nimport { Platform } from \"react-native\";\n\nexport interface CountryInfo {\n  code: string;\n  name: string;\n  currency: string;\n  currencySymbol: string;\n  language: string;\n  languageCode: string;\n  emergencyNumber: string;\n  pharmacyTip: string;\n}\n\nexport const COUNTRIES: Record<string, CountryInfo> = {\n  US: {\n    code: \"US\",\n    name: \"United States\",\n    currency: \"USD\",\n    currencySymbol: \"$\",\n    language: \"English\",\n    languageCode: \"en\",\n    emergencyNumber: \"911\",\n    pharmacyTip: \"CVS and Walgreens are major pharmacy chains\",\n  },\n  UZ: {\n    code: \"UZ\",\n    name: \"Uzbekistan\",\n    currency: \"UZS\",\n    currencySymbol: \"so'm\",\n    language: \"O'zbek\",\n    languageCode: \"uz\",\n    emergencyNumber: \"103\",\n    pharmacyTip: \"Look for 'Dorixona' signs for pharmacies\",\n  },\n  RU: {\n    code: \"RU\",\n    name: \"Russia\",\n    currency: \"RUB\",\n    currencySymbol: \"₽\",\n    language: \"Русский\",\n    languageCode: \"ru\",\n    emergencyNumber: \"112\",\n    pharmacyTip: \"Look for 'Аптека' signs for pharmacies\",\n  },\n  DE: {\n    code: \"DE\",\n    name: \"Germany\",\n    currency: \"EUR\",\n    currencySymbol: \"€\",\n    language: \"Deutsch\",\n    languageCode: \"de\",\n    emergencyNumber: \"112\",\n    pharmacyTip: \"Look for green cross signs, 'Apotheke'\",\n  },\n  FR: {\n    code: \"FR\",\n    name: \"France\",\n    currency: \"EUR\",\n    currencySymbol: \"€\",\n    language: \"Français\",\n    languageCode: \"fr\",\n    emergencyNumber: \"15\",\n    pharmacyTip: \"Look for green cross signs, 'Pharmacie'\",\n  },\n  TR: {\n    code: \"TR\",\n    name: \"Turkey\",\n    currency: \"TRY\",\n    currencySymbol: \"₺\",\n    language: \"Türkçe\",\n    languageCode: \"tr\",\n    emergencyNumber: \"112\",\n    pharmacyTip: \"Look for 'Eczane' signs with red crescent\",\n  },\n  TH: {\n    code: \"TH\",\n    name: \"Thailand\",\n    currency: \"THB\",\n    currencySymbol: \"฿\",\n    language: \"ไทย\",\n    languageCode: \"th\",\n    emergencyNumber: \"1669\",\n    pharmacyTip: \"Boots and Watson's are common pharmacy chains\",\n  },\n  IN: {\n    code: \"IN\",\n    name: \"India\",\n    currency: \"INR\",\n    currencySymbol: \"₹\",\n    language: \"हिन्दी\",\n    languageCode: \"hi\",\n    emergencyNumber: \"108\",\n    pharmacyTip: \"Apollo Pharmacy and MedPlus are major chains\",\n  },\n  MX: {\n    code: \"MX\",\n    name: \"Mexico\",\n    currency: \"MXN\",\n    currencySymbol: \"$\",\n    language: \"Español\",\n    languageCode: \"es\",\n    emergencyNumber: \"065\",\n    pharmacyTip: \"Farmacias Similares offers affordable generics\",\n  },\n  JP: {\n    code: \"JP\",\n    name: \"Japan\",\n    currency: \"JPY\",\n    currencySymbol: \"¥\",\n    language: \"日本語\",\n    languageCode: \"ja\",\n    emergencyNumber: \"119\",\n    pharmacyTip: \"Look for ドラッグストア (drug stores) or 薬局\",\n  },\n  KR: {\n    code: \"KR\",\n    name: \"South Korea\",\n    currency: \"KRW\",\n    currencySymbol: \"₩\",\n    language: \"한국어\",\n    languageCode: \"ko\",\n    emergencyNumber: \"119\",\n    pharmacyTip: \"Look for 약국 (yakguk) signs\",\n  },\n  AE: {\n    code: \"AE\",\n    name: \"UAE\",\n    currency: \"AED\",\n    currencySymbol: \"د.إ\",\n    language: \"العربية\",\n    languageCode: \"ar\",\n    emergencyNumber: \"998\",\n    pharmacyTip: \"Aster and Life Pharmacy are major chains\",\n  },\n};\n\nexport const EXCHANGE_RATES: Record<string, number> = {\n  USD: 1.0,\n  UZS: 12500,\n  RUB: 92.5,\n  EUR: 0.92,\n  TRY: 32.5,\n  THB: 35.8,\n  INR: 83.2,\n  MXN: 17.2,\n  JPY: 149.5,\n  KRW: 1340,\n  AED: 3.67,\n  GBP: 0.79,\n};\n\nexport function convertCurrency(\n  amount: number,\n  fromCurrency: string,\n  toCurrency: string\n): number {\n  const fromRate = EXCHANGE_RATES[fromCurrency] || 1;\n  const toRate = EXCHANGE_RATES[toCurrency] || 1;\n  const usdAmount = amount / fromRate;\n  return usdAmount * toRate;\n}\n\nexport function formatCurrency(amount: number, currency: string): string {\n  const symbols: Record<string, string> = {\n    USD: \"$\",\n    UZS: \"so'm\",\n    RUB: \"₽\",\n    EUR: \"€\",\n    TRY: \"₺\",\n    THB: \"฿\",\n    INR: \"₹\",\n    MXN: \"$\",\n    JPY: \"¥\",\n    KRW: \"₩\",\n    AED: \"د.إ\",\n    GBP: \"£\",\n  };\n\n  const symbol = symbols[currency] || currency;\n  const formatted = amount.toLocaleString(undefined, {\n    minimumFractionDigits: currency === \"JPY\" || currency === \"KRW\" ? 0 : 2,\n    maximumFractionDigits: currency === \"JPY\" || currency === \"KRW\" ? 0 : 2,\n  });\n\n  return `${symbol}${formatted}`;\n}\n\nexport const MEDICATION_TRANSLATIONS: Record<\n  string,\n  Record<string, { name: string; pronunciation?: string }>\n> = {\n  Aspirin: {\n    en: { name: \"Aspirin\" },\n    ru: { name: \"Аспирин\", pronunciation: \"Aspirin\" },\n    uz: { name: \"Aspirin\" },\n    de: { name: \"Aspirin\" },\n    fr: { name: \"Aspirine\" },\n    es: { name: \"Aspirina\" },\n    tr: { name: \"Aspirin\" },\n    ja: { name: \"アスピリン\", pronunciation: \"Asupirin\" },\n    ko: { name: \"아스피린\", pronunciation: \"Aseupirin\" },\n    ar: { name: \"أسبرين\", pronunciation: \"Aspirin\" },\n  },\n  Ibuprofen: {\n    en: { name: \"Ibuprofen\" },\n    ru: { name: \"Ибупрофен\", pronunciation: \"Ibuprofen\" },\n    uz: { name: \"Ibuprofen\" },\n    de: { name: \"Ibuprofen\" },\n    fr: { name: \"Ibuprofène\" },\n    es: { name: \"Ibuprofeno\" },\n    tr: { name: \"İbuprofen\" },\n    ja: { name: \"イブプロフェン\", pronunciation: \"Ibupurofen\" },\n    ko: { name: \"이부프로펜\", pronunciation: \"Ibupeuropen\" },\n    ar: { name: \"إيبوبروفين\", pronunciation: \"Ibuprofen\" },\n  },\n  Acetaminophen: {\n    en: { name: \"Acetaminophen / Tylenol\" },\n    ru: { name: \"Парацетамол\", pronunciation: \"Paracetamol\" },\n    uz: { name: \"Paracetamol\" },\n    de: { name: \"Paracetamol\" },\n    fr: { name: \"Paracétamol\" },\n    es: { name: \"Paracetamol\" },\n    tr: { name: \"Parasetamol\" },\n    ja: { name: \"アセトアミノフェン\", pronunciation: \"Asetaminofen\" },\n    ko: { name: \"아세트아미노펜\", pronunciation: \"Aseteuaminopen\" },\n    ar: { name: \"باراسيتامول\", pronunciation: \"Paracetamol\" },\n  },\n  Amoxicillin: {\n    en: { name: \"Amoxicillin\" },\n    ru: { name: \"Амоксициллин\", pronunciation: \"Amoksitsillin\" },\n    uz: { name: \"Amoksitsillin\" },\n    de: { name: \"Amoxicillin\" },\n    fr: { name: \"Amoxicilline\" },\n    es: { name: \"Amoxicilina\" },\n    tr: { name: \"Amoksisilin\" },\n    ja: { name: \"アモキシシリン\", pronunciation: \"Amokishishirin\" },\n    ko: { name: \"아목시실린\", pronunciation: \"Amoksisilin\" },\n    ar: { name: \"أموكسيسيلين\", pronunciation: \"Amoxicillin\" },\n  },\n  Metformin: {\n    en: { name: \"Metformin\" },\n    ru: { name: \"Метформин\", pronunciation: \"Metformin\" },\n    uz: { name: \"Metformin\" },\n    de: { name: \"Metformin\" },\n    fr: { name: \"Metformine\" },\n    es: { name: \"Metformina\" },\n    tr: { name: \"Metformin\" },\n    ja: { name: \"メトホルミン\", pronunciation: \"Metohorumin\" },\n    ko: { name: \"메트포르민\", pronunciation: \"Meteuporeumin\" },\n    ar: { name: \"ميتفورمين\", pronunciation: \"Metformin\" },\n  },\n  Omeprazole: {\n    en: { name: \"Omeprazole\" },\n    ru: { name: \"Омепразол\", pronunciation: \"Omeprazol\" },\n    uz: { name: \"Omeprazol\" },\n    de: { name: \"Omeprazol\" },\n    fr: { name: \"Oméprazole\" },\n    es: { name: \"Omeprazol\" },\n    tr: { name: \"Omeprazol\" },\n    ja: { name: \"オメプラゾール\", pronunciation: \"Omepurazoru\" },\n    ko: { name: \"오메프라졸\", pronunciation: \"Omepeurajol\" },\n    ar: { name: \"أوميبرازول\", pronunciation: \"Omeprazole\" },\n  },\n  Lisinopril: {\n    en: { name: \"Lisinopril\" },\n    ru: { name: \"Лизиноприл\", pronunciation: \"Lizinopril\" },\n    uz: { name: \"Lizinopril\" },\n    de: { name: \"Lisinopril\" },\n    fr: { name: \"Lisinopril\" },\n    es: { name: \"Lisinopril\" },\n    tr: { name: \"Lizinopril\" },\n    ja: { name: \"リシノプリル\", pronunciation: \"Rishinopuriru\" },\n    ko: { name: \"리시노프릴\", pronunciation: \"Risinopeuril\" },\n    ar: { name: \"ليسينوبريل\", pronunciation: \"Lisinopril\" },\n  },\n  Atorvastatin: {\n    en: { name: \"Atorvastatin / Lipitor\" },\n    ru: { name: \"Аторвастатин\", pronunciation: \"Atorvastatin\" },\n    uz: { name: \"Atorvastatin\" },\n    de: { name: \"Atorvastatin\" },\n    fr: { name: \"Atorvastatine\" },\n    es: { name: \"Atorvastatina\" },\n    tr: { name: \"Atorvastatin\" },\n    ja: { name: \"アトルバスタチン\", pronunciation: \"Atorubasutachin\" },\n    ko: { name: \"아토르바스타틴\", pronunciation: \"Atoreubaseututin\" },\n    ar: { name: \"أتورفاستاتين\", pronunciation: \"Atorvastatin\" },\n  },\n};\n\nexport function translateMedication(\n  medicationName: string,\n  targetLanguage: string\n): { name: string; pronunciation?: string } {\n  const baseWords = medicationName.split(/[\\s\\/]+/);\n  for (const word of baseWords) {\n    const normalizedWord =\n      word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();\n    if (\n      MEDICATION_TRANSLATIONS[normalizedWord] &&\n      MEDICATION_TRANSLATIONS[normalizedWord][targetLanguage]\n    ) {\n      return MEDICATION_TRANSLATIONS[normalizedWord][targetLanguage];\n    }\n  }\n  return { name: medicationName };\n}\n\nexport const PHARMACY_PHRASES: Record<\n  string,\n  { phrase: string; pronunciation: string }[]\n> = {\n  en: [\n    { phrase: \"Where is the nearest pharmacy?\", pronunciation: \"\" },\n    { phrase: \"I need this medication\", pronunciation: \"\" },\n    { phrase: \"Do you have a generic version?\", pronunciation: \"\" },\n    { phrase: \"How much does this cost?\", pronunciation: \"\" },\n  ],\n  ru: [\n    {\n      phrase: \"Где ближайшая аптека?\",\n      pronunciation: \"Gde blizhayshaya apteka?\",\n    },\n    {\n      phrase: \"Мне нужно это лекарство\",\n      pronunciation: \"Mne nuzhno eto lekarstvo\",\n    },\n    {\n      phrase: \"Есть ли дженерик?\",\n      pronunciation: \"Yest' li dzhenerik?\",\n    },\n    { phrase: \"Сколько это стоит?\", pronunciation: \"Skol'ko eto stoit?\" },\n  ],\n  uz: [\n    { phrase: \"Eng yaqin dorixona qayerda?\", pronunciation: \"\" },\n    { phrase: \"Menga bu dori kerak\", pronunciation: \"\" },\n    { phrase: \"Generik versiyasi bormi?\", pronunciation: \"\" },\n    { phrase: \"Bu qancha turadi?\", pronunciation: \"\" },\n  ],\n  de: [\n    {\n      phrase: \"Wo ist die nächste Apotheke?\",\n      pronunciation: \"Vo ist dee nekhste Apoteke?\",\n    },\n    {\n      phrase: \"Ich brauche dieses Medikament\",\n      pronunciation: \"Ikh browkhe deeses Medikament\",\n    },\n    {\n      phrase: \"Haben Sie ein Generikum?\",\n      pronunciation: \"Haben zee ein Generikum?\",\n    },\n    { phrase: \"Wie viel kostet das?\", pronunciation: \"Vee feel kostet das?\" },\n  ],\n  fr: [\n    {\n      phrase: \"Où est la pharmacie la plus proche?\",\n      pronunciation: \"Oo eh la farmasi la plu prosh?\",\n    },\n    {\n      phrase: \"J'ai besoin de ce médicament\",\n      pronunciation: \"Zhay bezwan de se medikamohn\",\n    },\n    {\n      phrase: \"Avez-vous un générique?\",\n      pronunciation: \"Avay voo un zhenereek?\",\n    },\n    { phrase: \"Combien ça coûte?\", pronunciation: \"Kombyen sa koot?\" },\n  ],\n  es: [\n    {\n      phrase: \"¿Dónde está la farmacia más cercana?\",\n      pronunciation: \"Donde esta la farmasia mas serkana?\",\n    },\n    {\n      phrase: \"Necesito este medicamento\",\n      pronunciation: \"Nesesito este medikamento\",\n    },\n    {\n      phrase: \"¿Tiene versión genérica?\",\n      pronunciation: \"Tyene version henerika?\",\n    },\n    { phrase: \"¿Cuánto cuesta?\", pronunciation: \"Kwanto kwesta?\" },\n  ],\n  tr: [\n    {\n      phrase: \"En yakın eczane nerede?\",\n      pronunciation: \"En yakun ejane nerede?\",\n    },\n    { phrase: \"Bu ilaca ihtiyacım var\", pronunciation: \"Bu ilaja ihtiyajum var\" },\n    {\n      phrase: \"Jenerik versiyonu var mı?\",\n      pronunciation: \"Zhenerik versiyonu var mu?\",\n    },\n    { phrase: \"Bu ne kadar?\", pronunciation: \"Bu ne kadar?\" },\n  ],\n  ja: [\n    {\n      phrase: \"一番近い薬局はどこですか？\",\n      pronunciation: \"Ichiban chikai yakkyoku wa doko desu ka?\",\n    },\n    {\n      phrase: \"この薬が必要です\",\n      pronunciation: \"Kono kusuri ga hitsuyou desu\",\n    },\n    {\n      phrase: \"ジェネリックはありますか？\",\n      pronunciation: \"Jenerikku wa arimasu ka?\",\n    },\n    { phrase: \"いくらですか？\", pronunciation: \"Ikura desu ka?\" },\n  ],\n  ko: [\n    {\n      phrase: \"가장 가까운 약국이 어디에요?\",\n      pronunciation: \"Gajang gakkaun yakgugi eodieyo?\",\n    },\n    { phrase: \"이 약이 필요해요\", pronunciation: \"I yagi piryohaeyo\" },\n    {\n      phrase: \"제네릭 있어요?\",\n      pronunciation: \"Jenerik isseoyo?\",\n    },\n    { phrase: \"얼마에요?\", pronunciation: \"Eolmaeyo?\" },\n  ],\n  ar: [\n    {\n      phrase: \"أين أقرب صيدلية؟\",\n      pronunciation: \"Ayna aqrab saydaliyya?\",\n    },\n    {\n      phrase: \"أحتاج هذا الدواء\",\n      pronunciation: \"Ahtaj hadha addawa'\",\n    },\n    {\n      phrase: \"هل يوجد بديل عام؟\",\n      pronunciation: \"Hal yujad badeel aam?\",\n    },\n    { phrase: \"كم الثمن؟\", pronunciation: \"Kam aththaman?\" },\n  ],\n};\n\nexport async function detectCurrentCountry(): Promise<CountryInfo | null> {\n  if (Platform.OS === \"web\") {\n    try {\n      const response = await fetch(\"https://ipapi.co/json/\");\n      const data = await response.json();\n      const countryCode = data.country_code;\n      return COUNTRIES[countryCode] || null;\n    } catch {\n      return null;\n    }\n  }\n\n  try {\n    const { status } = await Location.requestForegroundPermissionsAsync();\n    if (status !== \"granted\") {\n      return null;\n    }\n\n    const location = await Location.getCurrentPositionAsync({\n      accuracy: Location.Accuracy.Balanced,\n    });\n\n    const [address] = await Location.reverseGeocodeAsync({\n      latitude: location.coords.latitude,\n      longitude: location.coords.longitude,\n    });\n\n    if (address?.isoCountryCode) {\n      return COUNTRIES[address.isoCountryCode] || null;\n    }\n    return null;\n  } catch {\n    return null;\n  }\n}\n\nexport interface TravelPriceComparison {\n  medication: string;\n  homePrice: { amount: number; currency: string; formatted: string };\n  localPrice: { amount: number; currency: string; formatted: string };\n  savings: { amount: number; percentage: number };\n}\n\nexport function comparePrices(\n  medicationPriceUSD: number,\n  homeCurrency: string,\n  destinationCurrency: string,\n  localPriceMultiplier: number = 0.4\n): TravelPriceComparison {\n  const homePrice = convertCurrency(medicationPriceUSD, \"USD\", homeCurrency);\n  const localBasePrice = medicationPriceUSD * localPriceMultiplier;\n  const localPrice = convertCurrency(localBasePrice, \"USD\", destinationCurrency);\n  const localPriceInHome = convertCurrency(\n    localBasePrice,\n    \"USD\",\n    homeCurrency\n  );\n  const savings = homePrice - localPriceInHome;\n  const savingsPercentage = (savings / homePrice) * 100;\n\n  return {\n    medication: \"\",\n    homePrice: {\n      amount: homePrice,\n      currency: homeCurrency,\n      formatted: formatCurrency(homePrice, homeCurrency),\n    },\n    localPrice: {\n      amount: localPrice,\n      currency: destinationCurrency,\n      formatted: formatCurrency(localPrice, destinationCurrency),\n    },\n    savings: {\n      amount: savings,\n      percentage: Math.max(0, savingsPercentage),\n    },\n  };\n}\n\nexport const TRAVEL_HEALTH_TIPS: Record<string, string[]> = {\n  US: [\n    \"Healthcare costs are high - consider travel insurance\",\n    \"Prescription medications may require a US doctor's prescription\",\n    \"Emergency rooms are expensive for non-urgent care\",\n  ],\n  UZ: [\n    \"Pharmacies often sell medications without prescription\",\n    \"Many pharmacists speak Russian\",\n    \"Carry your original prescription documentation\",\n  ],\n  RU: [\n    \"Some Western medications may not be available\",\n    \"Pharmacists can recommend alternatives\",\n    \"Carry documentation for prescription medications\",\n  ],\n  TR: [\n    \"Many medications are available without prescription\",\n    \"Pharmacists are generally knowledgeable and helpful\",\n    \"Istanbul has many English-speaking pharmacies\",\n  ],\n  TH: [\n    \"Thailand is popular for medical tourism\",\n    \"Bangkok hospitals have international patient services\",\n    \"Many medications available over-the-counter\",\n  ],\n  IN: [\n    \"Generic medications are very affordable\",\n    \"Carry prescriptions for controlled substances\",\n    \"International hospital chains offer quality care\",\n  ],\n  MX: [\n    \"Border towns have pharmacies catering to tourists\",\n    \"Generic versions widely available\",\n    \"Some medications cheaper than US prices\",\n  ],\n};\n","path":null,"size_bytes":16494,"size_tokens":null}},"version":2}